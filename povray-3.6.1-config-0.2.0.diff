diff -ruN povray-3.6.1/Makefile.am povray-3.6.1-config-0.2.0/Makefile.am
--- povray-3.6.1/Makefile.am	2004-08-03 01:20:02.000000000 +0200
+++ povray-3.6.1-config-0.2.0/Makefile.am	2006-04-12 01:43:08.000000000 +0200
@@ -41,14 +41,13 @@
   povray.ini.in
 
 # Additional files to clean with 'make distclean'.
-# Note the little ';' trick for CONFIG_CLEAN_FILES.
 DISTCLEANFILES = $(top_builddir)/povray.ini
 CONFIG_CLEAN_FILES = $(top_builddir)/source/jversion.h
 
 # Render a test scene for 'make check'.
 # This is meant to run before 'make install'.
 check: all
-	$(top_builddir)/unix/povray +i$(top_srcdir)/scenes/advanced/biscuit.pov -f +d +p +v +w320 +h240 +a0.3 +L$(top_srcdir)/include
+	$(top_builddir)/unix/povray +i$(top_srcdir)/scenes/advanced/biscuit.pov -f +d +p +v +x +w320 +h240 +a0.3 +L$(top_srcdir)/include
 
 # Install scripts in povlibdir.
 nobase_povlib_SCRIPTS = scripts/allanim.sh scripts/allscene.sh scripts/portfolio.sh scripts/render_anim.sh scripts/render_scene.sh scripts/rerunpov.sh scripts/runpov.sh
@@ -70,29 +69,30 @@
 # Remove all unwanted files in unix and libraries for 'make dist'.
 # Make all files user read-writeable.
 dist-hook:
-	rm -f ./@PACKAGE@-@VERSION@/source/jversion.h
-	rm -f `find ./@PACKAGE@-@VERSION@/libraries -name "*.o"`
-	rm -f `find ./@PACKAGE@-@VERSION@/libraries -name "lib*.a"`
-	rm -f `find ./@PACKAGE@-@VERSION@/libraries -name config.log`
-	rm -f `find ./@PACKAGE@-@VERSION@/libraries -name config.status`
-	rm -f `find ./@PACKAGE@-@VERSION@/libraries -name Makefile`
-	rm -f ./@PACKAGE@-@VERSION@/libraries/tiff/libtiff/mkg3states
-	rm -f ./@PACKAGE@-@VERSION@/libraries/tiff/libtiff/mkversion
-	rm -f ./@PACKAGE@-@VERSION@/libraries/tiff/libtiff/port.h
-	rm -f ./@PACKAGE@-@VERSION@/libraries/tiff/libtiff/tif_fax3sm.c
-	rm -f ./@PACKAGE@-@VERSION@/libraries/tiff/libtiff/tiffvers.h
-	rm -f ./@PACKAGE@-@VERSION@/libraries/tiff/port/install.sh
+	rm -f    `find ./@PACKAGE@-@VERSION@ -name "*.h.in~"`
+	rm -f -r `find ./@PACKAGE@-@VERSION@ -name autom4te.cache`
+	rm -f    `find ./@PACKAGE@-@VERSION@/libraries -name "*.o"`
+	rm -f    `find ./@PACKAGE@-@VERSION@/libraries -name "lib*.a"`
+	rm -f    `find ./@PACKAGE@-@VERSION@/libraries -name config.log`
+	rm -f    `find ./@PACKAGE@-@VERSION@/libraries -name config.status`
+	rm -f    `find ./@PACKAGE@-@VERSION@/libraries -name Makefile`
+	rm -f    ./@PACKAGE@-@VERSION@/source/jversion.h
+	rm -f    ./@PACKAGE@-@VERSION@/libraries/tiff/libtiff/mkg3states
+	rm -f    ./@PACKAGE@-@VERSION@/libraries/tiff/libtiff/mkversion
+	rm -f    ./@PACKAGE@-@VERSION@/libraries/tiff/libtiff/port.h
+	rm -f    ./@PACKAGE@-@VERSION@/libraries/tiff/libtiff/tif_fax3sm.c
+	rm -f    ./@PACKAGE@-@VERSION@/libraries/tiff/libtiff/tiffvers.h
 	chmod -R u+rw ./@PACKAGE@-@VERSION@
-	chmod 655 ./@PACKAGE@-@VERSION@/scripts/*
+	chmod 755 ./@PACKAGE@-@VERSION@/scripts/*
 
 # Manage various data files for 'make install'.
 install-data-local:
-	$(mkinstalldirs) $(DESTDIR)$(povlibdir)
+	$(mkdir_p) $(DESTDIR)$(povlibdir)
 	@list='$(top_srcdir)/icons $(top_srcdir)/include $(top_srcdir)/ini $(top_srcdir)/scenes'; \
 	echo "Creating data directories..."; \
 	dirlist=`find $$list -type d | sed s,$(top_srcdir)/,,`; \
 	for p in $$dirlist ; do \
-	  $(mkinstalldirs) $(DESTDIR)$(povlibdir)/$$p ; \
+	  $(mkdir_p) $(DESTDIR)$(povlibdir)/$$p ; \
 	done; \
 	echo "Copying data files..."; \
 	filelist=`find $$list -type f | sed s,$(top_srcdir)/,,`; \
@@ -100,10 +100,10 @@
 	  $(INSTALL_DATA) $(top_srcdir)/$$f $(DESTDIR)$(povlibdir)/$$f ; \
 	done
 	@echo "Creating documentation directories..."; \
-	$(mkinstalldirs) $(DESTDIR)$(povdocdir); \
+	$(mkdir_p) $(DESTDIR)$(povdocdir); \
 	dirlist=`find $(top_srcdir)/doc/ -type d | sed s,$(top_srcdir)/doc/,,`; \
 	for p in $$dirlist ; do \
-	  $(mkinstalldirs) $(DESTDIR)$(povdocdir)/$$p ; \
+	  $(mkdir_p) $(DESTDIR)$(povdocdir)/$$p ; \
 	done
 	@echo "Copying documentation files..."; \
 	filelist=`find $(top_srcdir)/doc/ -type f | sed s,$(top_srcdir)/doc/,,`; \
@@ -111,7 +111,7 @@
 	  $(INSTALL_DATA) $(top_srcdir)/doc/$$f $(DESTDIR)$(povdocdir)/$$f ; \
 	done
 	@echo "Copying user configuration and INI files..."; \
-	$(mkinstalldirs) $(povconfuser); \
+	$(mkdir_p) $(povconfuser); \
 	filelist='povray.conf povray.ini'; \
 	for f in $$filelist ; do \
 	  if test -e $(povconfuser)/$$f; then \
diff -ruN povray-3.6.1/acinclude.m4 povray-3.6.1-config-0.2.0/acinclude.m4
--- povray-3.6.1/acinclude.m4	2004-08-03 01:16:14.000000000 +0200
+++ povray-3.6.1-config-0.2.0/acinclude.m4	2006-04-10 18:50:25.000000000 +0200
@@ -46,7 +46,7 @@
   # AC_ARG_ENABLE does only accept a litteral for feature name / help string
   eval "enable_povvar=\${enable_$pov_arg_enable_feature}"
   AC_ARG_ENABLE([povvar],
-    AC_HELP_STRING([$1], [$2]),
+    AS_HELP_STRING([$1], [$2]),
     [case $enableval in
        yes|no|"") eval "enable_${pov_arg_enable_feature}=$enableval" ;;
        *) AC_MSG_ERROR([bad value '$enableval' for $1]) ;;
@@ -70,7 +70,7 @@
   # AC_ARG_WITH does only accept a litteral for package name / help string
   eval "with_povvar=\${with_$pov_arg_with_package}"
   AC_ARG_WITH([povvar],
-    AC_HELP_STRING([$1], [$2]),
+    AS_HELP_STRING([$1], [$2]),
     [case $withval in
        yes|no|"") eval "with_${pov_arg_with_package}=$withval" ;;
        *) AC_MSG_ERROR([bad value '$withval' for $1]) ;;
@@ -83,33 +83,47 @@
 
 # POV_PROG_CXX_VERSION()
 # --------------------
-# Try to determine the compiler and its version.
+# Try to determine the C++ compiler version.
 #
 AC_DEFUN([POV_PROG_CXX_VERSION],
 [
+  AC_REQUIRE([AC_PROG_CXX])
   AC_REQUIRE([AC_PROG_EGREP])
 
-  AC_PROG_CXX
-  AC_PROG_CXXCPP
+  # check for various version options and remove leading/trailing blanks
   AC_MSG_CHECKING([for $CXX version])
 
-  # check for -dumpversion
+  # -dumpversion
   AC_TRY_COMMAND([$CXX -dumpversion < /dev/null 2> /dev/null > conftest.out])
   pov_prog_cxx_version=`cat conftest.out | $ac_cv_prog_egrep '[[0-9]]'`
+  pov_prog_cxx_version=`echo $pov_prog_cxx_version`
 
-  # check for -v
+  # -v ; convert to lowercase and check for "version"
   if test -z "$pov_prog_cxx_version"; then
     AC_TRY_COMMAND([$CXX -v < /dev/null 2>&1 | tr A-Z a-z > conftest.out])
     pov_prog_cxx_version=`cat conftest.out | $ac_cv_prog_egrep "version" | sed 's,\(.*version[[[:space:]]]*\)\(.*\),\2,'`
+    pov_prog_cxx_version=`echo $pov_prog_cxx_version`
   fi
 
-  # final compiler version string
+  # -V ; convert to lowercase and check for "version"
+  if test -z "$pov_prog_cxx_version"; then
+    AC_TRY_COMMAND([$CXX -V < /dev/null 2>&1 | tr A-Z a-z > conftest.out])
+    pov_prog_cxx_version=`cat conftest.out | $ac_cv_prog_egrep "version" | sed 's,\(.*version[[[:space:]]]*\)\(.*\),\2,'`
+    pov_prog_cxx_version=`echo $pov_prog_cxx_version`
+  fi
+
+  # --version ; get only the last word of the first line
+  if test -z "$pov_prog_cxx_version"; then
+    AC_TRY_COMMAND([$CXX --version < /dev/null 2>&1 | head -n 1 > conftest.out])
+    pov_prog_cxx_version=`cat conftest.out | 's,.*[[[:space:]]],,'`
+    pov_prog_cxx_version=`echo $pov_prog_cxx_version`
+  fi
+
+  # print compiler version string
   if test -z "$pov_prog_cxx_version"; then
     AC_MSG_RESULT([unkown])
-    pov_prog_cxx_version="$CXX"
   else
     AC_MSG_RESULT([$pov_prog_cxx_version])
-    pov_prog_cxx_version="$CXX $pov_prog_cxx_version"
   fi
 
   rm -f conftest.out
@@ -153,21 +167,30 @@
 
       # Compile with $CXX and inspect standard error for given flags.
       AC_TRY_COMMAND([$CXX -c conftest.$ac_ext > /dev/null 2> conftest.err0])
-      AC_TRY_COMMAND([$CXX -c $1 conftest.$ac_ext > /dev/null 2> conftest.err])
+      AC_TRY_COMMAND([$CXX $1 -c conftest.$ac_ext > /dev/null 2> conftest.err])
       AC_TRY_COMMAND([cat conftest.err >&5])
       AC_TRY_COMMAND([$ac_cv_prog_egrep \"$pov_prog_cxx_flags_regexp\" conftest.err 2>&1 > /dev/null])
       # the command above seems to not always return the correct status, so
       # for safety I rerun it here; I keep the other one for logging purpose.
       pov_prog_cxx_flags_err=`$ac_cv_prog_egrep "$pov_prog_cxx_flags_regexp" conftest.err`
-      AC_TRY_COMMAND([diff conftest.err0 conftest.err >&5])
+      AC_TRY_COMMAND([diff conftest.err0 conftest.err >&5 2>&5])
+
+      eval "$pov_prog_cxx_flags_var=no"
       if test -z "$pov_prog_cxx_flags_err" \
       || test -z "`diff conftest.err0 conftest.err`"; then
-        eval "$pov_prog_cxx_flags_var=yes"
-      else
-        eval "$pov_prog_cxx_flags_var=no"
+        # compile, link, and run the test program.
+        AC_TRY_COMMAND([$CXX $1 conftest.$ac_ext -o conftest$ac_exeext 2> conftest.err])
+        AC_TRY_COMMAND([cat conftest.err >&5])
+        AC_TRY_COMMAND([./conftest$ac_exeext 2> conftest.err >&2])
+        pov_prog_cxx_flags_run=$?
+        AC_TRY_COMMAND([cat conftest.err >&5])
+        if test -z "`cat conftest.err`" \
+        && test x"$pov_prog_cxx_flags_run" = x"0"; then
+          eval "$pov_prog_cxx_flags_var=yes"
+        fi
       fi
 
-      rm -f conftest.$ac_ext conftest.$ac_objext conftest.err conftest.err0
+      rm -f conftest.$ac_ext conftest.$ac_objext conftest.err conftest.err0 conftest$ac_exeext
       AC_LANG_POP(C++)
     ]
   )
@@ -199,22 +222,36 @@
   AC_CACHE_VAL(
     [$pov_prog_cc_flags_var],
     [
+      # Create a conftest file for CC.
       AC_LANG_PUSH(C)
       AC_LANG_CONFTEST([AC_LANG_PROGRAM()])
+
+      # Compile with $CC and inspect standard error for given flags.
       AC_TRY_COMMAND([$CC -c conftest.$ac_ext > /dev/null 2> conftest.err0])
-      AC_TRY_COMMAND([$CC -c $1 conftest.$ac_ext > /dev/null 2> conftest.err])
+      AC_TRY_COMMAND([$CC $1 -c conftest.$ac_ext > /dev/null 2> conftest.err])
       AC_TRY_COMMAND([cat conftest.err >&5])
       AC_TRY_COMMAND([$ac_cv_prog_egrep \"$pov_prog_cc_flags_regexp\" conftest.err 2>&1 > /dev/null])
+      # the command above seems to not always return the correct status, so
+      # for safety I rerun it here; I keep the other one for logging purpose.
       pov_prog_cc_flags_err=`$ac_cv_prog_egrep "$pov_prog_cc_flags_regexp" conftest.err`
-      AC_TRY_COMMAND([diff conftest.err0 conftest.err >&5])
+      AC_TRY_COMMAND([diff conftest.err0 conftest.err >&5 2>&5])
+
+      eval "$pov_prog_cc_flags_var=no"
       if test -z "$pov_prog_cc_flags_err" \
       || test -z "`diff conftest.err0 conftest.err`"; then
-        eval "$pov_prog_cc_flags_var=yes"
-      else
-        eval "$pov_prog_cc_flags_var=no"
+        # compile, link, and run the test program.
+        AC_TRY_COMMAND([$CC $1 conftest.$ac_ext -o conftest$ac_exeext 2> conftest.err])
+        AC_TRY_COMMAND([cat conftest.err >&5])
+        AC_TRY_COMMAND([./conftest$ac_exeext 2> conftest.err >&2])
+        pov_prog_cc_flags_run=$?
+        AC_TRY_COMMAND([cat conftest.err >&5])
+        if test -z "`cat conftest.err`" \
+        && test x"$pov_prog_cc_flags_run" = x"0"; then
+          eval "$pov_prog_cc_flags_var=yes"
+        fi
       fi
 
-      rm -f conftest.$ac_ext conftest.$ac_objext conftest.err conftest.err0
+      rm -f conftest.$ac_ext conftest.$ac_objext conftest.err conftest.err0 conftest$ac_exeext
       AC_LANG_POP(C)
     ]
   )
diff -ruN povray-3.6.1/bootstrap povray-3.6.1-config-0.2.0/bootstrap
--- povray-3.6.1/bootstrap	2004-08-03 01:20:02.000000000 +0200
+++ povray-3.6.1-config-0.2.0/bootstrap	2006-04-10 17:51:28.000000000 +0200
@@ -24,7 +24,23 @@
 # Create configure from configure.ac .
 autoconf --warnings=all
 
-# Small post-fix of 'configure': add --srcdir when using --help=recursive
-sed 's,configure.gnu  --help=recursive,& --srcdir=$ac_srcdir,g' ./configure > ./configure.tmp
+# Post-fixes to configure.
+#   add --srcdir when using --help=recursive
+#   protect $ac_(pop)dir with double quotes in cd commands
+#   protect $am_aux_dir with double quotes when looking for 'missing'
+cat ./configure | sed \
+  -e 's,configure.gnu  --help=recursive,& --srcdir=$ac_srcdir,g' \
+  -e 's,\(cd \)\($ac_\)\(pop\)*\(dir\),\1"\2\3\4",g' \
+  -e 's,$am_aux_dir/missing,\\"$am_aux_dir\\"/missing,g' \
+  > ./configure.tmp
 mv ./configure.tmp ./configure
 chmod +x ./configure
+
+# Remove cache directory
+rm -f -r ./autom4te.cache
+
+# libtiff hooks
+for file in bootstrap config.guess config.sub configure.gnu install-sh missing; do
+  chmod +x ./libraries/tiff/libtiff/$file
+done
+(cd ./libraries/tiff/libtiff/ && ./bootstrap)
diff -ruN povray-3.6.1/config-changes.txt povray-3.6.1-config-0.2.0/config-changes.txt
--- povray-3.6.1/config-changes.txt	1970-01-01 01:00:00.000000000 +0100
+++ povray-3.6.1-config-0.2.0/config-changes.txt	2006-04-12 02:00:02.000000000 +0200
@@ -0,0 +1,35 @@
+Unix source configuration patch to POV-Ray 3.6 for Unix
+Written by Nicolas Calimet <pov4grasp@free.fr>
+
+Most important changes:
+
+2006-04-12  version 0.2.0
+  + add the --enable-static configure option (same as --disable-shared)
+  + add the --disable-strip configure option (make --enable-strip the default)
+  + add configure postfixes to some directory paths (useful under cygwin)
+  + add support for -V and --version for checking the CXX compiler version
+  + add support for x86 detection under NetBSD (patch by David Holland)
+  + add support for the AMD Sempron64 in the x86 cpu detection code
+  + add support for CXX/CC compiler options that require run-time checks
+  + add rewritten support for libtiff (changed build location)    [povray only]
+  + add support for GCC -ffast-math compiler option               [povray only]
+  + add support for Intel Pentium 4/-M optimizations with ICPC    [povray only]
+  + add checks for libvga and X11 header files for robustness     [povray only]
+  + add configuration summary for the various installation paths  [povray only]
+  + add CXXFLAGS export in conf.h for future internal use         [povray only]
+  + add partial compatibility with autoconf-2.59 and automake-1.9 [povray only]
+  + add the +x command-line option (early abort) to 'make check' [megapov only]
+  - remove support for GCC -mtune/-mcpu options since -march is enough
+  * fix for better detection of the Intel C++ Compiler (ICPC)     [povray only]
+  * fix missing executable permission for the Unix scripts/ files [povray only]
+  * fix problem in getting the CXX compiler version string       [megapov only]
+  * fix to not perform arch-specific compiler checks when cross-compiling
+  * fix optimization fallback to i586 for the AMD K6 (patch by David Holland)
+  * fix various x86 detection issues under FreeBSD   (patch by David Holland)
+  * fix layout of the x86 cpu detection after David Holland's suggestions
+  * fix detection of Intel Pentium III (M...) wrongly handled as Pentium-M
+
+2005-09-05  version 0.1.0
+  + add the +x command-line option (early render abort) to 'make check'
+  * fix non-working SVGAlib detection in official povray-3.6.x
+  * fix missing -march= for optimization fallback in official povray-3.6.x
diff -ruN povray-3.6.1/configure.ac povray-3.6.1-config-0.2.0/configure.ac
--- povray-3.6.1/configure.ac	2004-08-03 01:16:14.000000000 +0200
+++ povray-3.6.1-config-0.2.0/configure.ac	2006-04-11 12:55:40.000000000 +0200
@@ -36,12 +36,12 @@
 # prepared by Mark Gordon and distributed with the official POV-Ray 3.5
 # for Unix/Linux.  The hope is that the 'configure' script derived from
 # 'configure.ac' will work on most *nix architectures (and not only Linux).
-# 'configure.ac' comes with a set of supporting files that are needed to
+# 'configure.ac' comes with a set of support files that are needed to
 # generate a fresh 'configure'.  In particular, the 'acinclude.m4' file
 # defines all POV_* macros used throughout the present file.
 #
 # New features (among others):
-# * The supporting libraries (Zlib, PNG, JPEG, and TIFF) are included in
+# * The support libraries (Zlib, PNG, JPEG, and TIFF) are included in
 #   the compilation process when they are either not found on the system
 #   or too old.  Otherwise the POV-Ray executable is linked against the
 #   shared libraries available on the system.  Full static linking is also
@@ -56,52 +56,58 @@
 
 
 # Required autoconf version.
-AC_PREREQ(2.57)
+AC_PREREQ(2.59)
 
 # Inits.
-# Cannot use a variable to define the POV-Ray version string.
 AC_INIT([POV-Ray], [3.6.1], [pov4grasp@free.fr], [povray])
 VERSION_BASE=3.6
 AC_SUBST([VERSION_BASE])
 AC_DEFINE_UNQUOTED([VERSION_BASE],
   ["$VERSION_BASE"],
-  [Base version number of package]
+  [Base version number of package.]
 )
 AC_CONFIG_AUX_DIR([config])
 AC_CONFIG_HEADERS([conf.h])
 AC_CONFIG_SRCDIR([unix/unix.cpp])
 
-# Required versions of the supporting libraries.
+# Required versions of the support libraries.
 # Must be declared after AC_INIT.
 required_libz_version="1.2.1"
 required_libpng_version="1.2.5"
 required_libjpeg_version="6b"
 required_libtiff_version="3.6.1"
+POVLIBS=
+POVLIBSCLEAN=
+AC_SUBST([POVLIBS])
+AC_SUBST([POVLIBSCLEAN])
 
 # Supported options.
 POV_ARG_ENABLE([--enable-watch-cursor],
   [enable a watch cursor over the display while rendering (X Window only)]
 )
-POV_ARG_ENABLE([--enable-strip],
-  [enable stripping all symbols from the object files (smaller binary)]
-)
 POV_ARG_ENABLE([--enable-debug],
   [enable compiler debugging mode]
 )
 POV_ARG_ENABLE([--enable-profile],
   [enable program execution profiling]
 )
+POV_ARG_ENABLE([--enable-static],
+  [enable the linker to create static executable (no run-time dependancy to external libraries, larger binary)]
+)
 POV_ARG_ENABLE([--disable-optimiz],
   [disable all compiler optimizations]
 )
 POV_ARG_ENABLE([--disable-pipe],
   [disable usage of pipes during compilation (use temporary files instead)]
 )
+POV_ARG_ENABLE([--disable-strip],
+  [disable stripping all symbols from the object files (larger binary)]
+)
 POV_ARG_ENABLE([--disable-shared],
-  [disable linking with shared libraries (build static binary)]
+  [disable linking with shared libraries (same as --enable-static)]
 )
 POV_ARG_ENABLE([--disable-lib-checks],
-  [disable checking for supporting image libraries (force compiling)]
+  [disable checking for support libraries (force compiling)]
 )
 POV_ARG_ENABLE([--disable-vsnprintf-check],
   [disable checking for the C99 vsnprintf() function (systems without this functions will fail compiling the program)]
@@ -119,7 +125,7 @@
 )
 
 AC_ARG_VAR([COMPILED_BY],
-  [customize the "unofficial version" message which defaults to user@machine]
+  [customize the "unofficial version" message (required argument)]
 )
 AC_ARG_VAR([C99_COMPATIBLE_RADIOSITY],
   [adapt radiosity code to non-IEEE 754 floating point, requires ISO C99 compiler and library (see source/octree.cpp for details)]
@@ -187,7 +193,7 @@
 AC_CANONICAL_BUILD
 AC_CANONICAL_HOST
 
-AM_INIT_AUTOMAKE([1.7 dist-bzip2])
+AM_INIT_AUTOMAKE([1.9 dist-bzip2])
 AM_MAINTAINER_MODE
 
 POV_CHECK_PATH(C_INCLUDE_PATH, ".",
@@ -205,16 +211,24 @@
 --------])
 
 # Check for C++ compiler and version.
-# Inits compiler flags to avoid defaults such as '-g -O2'.
+# Init compiler flags to avoid defaults such as '-g -O2'.
 CXXFLAGS="$CXXFLAGS"
+AC_PROG_CXX
 POV_PROG_CXX_VERSION
+AC_PROG_CXXCPP
+
+pov_prog_cxx=`echo $CXX | sed 's,.*/,,'`  # equivalent to `basename $CXX`
+pov_compiler_ver="$pov_prog_cxx"
+if test "$pov_prog_cxx_version"; then
+  pov_compiler_ver="$pov_prog_cxx $pov_prog_cxx_version"
+fi
 AC_DEFINE_UNQUOTED([COMPILER_VER],
-  [" ($pov_prog_cxx_version @ $host)"],
+  [" ($pov_compiler_ver @ $host)"],
   [Compiler version.]
 )
 
-# Check for C compiler for CFLAGS passed to supporting libraries.
-# Inits compiler flags to avoid defaults such as '-g -O2'.
+# Check for C compiler (used in support libraries).
+# Init compiler flags to avoid defaults such as '-g -O2'.
 CFLAGS="$CFLAGS"
 AC_PROG_CC
 AC_PROG_CPP
@@ -296,7 +310,7 @@
 
 AC_CHECK_SIZEOF([int])
 AC_CHECK_SIZEOF([long int])	# check for 64 bit support
-AC_CHECK_SIZEOF([size_t])       # check for 64 bit support
+AC_CHECK_SIZEOF([size_t])	# check for 64 bit support
 AC_CHECK_SIZEOF([float])
 
 
@@ -384,6 +398,9 @@
 ---------])
 
 # Link with static library, update LDFLAGS.
+if test x"$enable_static" = x"yes" && test x"$enable_shared" != x"yes"; then
+  enable_shared="no"
+fi
 AC_MSG_CHECKING([whether to enable static linking])
 if test x"$enable_shared" = x"no"; then
   AC_MSG_RESULT([yes])
@@ -472,8 +489,27 @@
   # libvga and libvgagl
   pov_svga_msg="disabled"
   if test x"$with_svga" != x"no"; then
-    AC_CHECK_LIB([vga], [vga_init],
-      [AC_CHECK_LIB([vgagl], [gl_setcontextvga], [pov_svga_msg="enabled"], [], [-lvga])]
+    AC_CHECK_HEADER([vga.h],
+      [
+        AC_CHECK_LIB([vga], [vga_init],
+          [
+            AC_DEFINE([HAVE_LIBVGA], [], [Define to 1 if you have the `vga' library (-lvga).])
+            AC_CHECK_HEADER([vgagl.h],
+              [
+                AC_CHECK_LIB([vgagl], [gl_setcontextvga],
+                  [
+                    AC_DEFINE([HAVE_LIBVGAGL], [], [Define to 1 if you have the `vgagl' library (-lvgagl).])
+                    LIBS="-lvgagl -lvga $LIBS"
+                    pov_svga_msg="enabled"
+                  ],
+                  [],
+                  [-lvga]
+                )
+              ]
+            )
+          ]
+        )
+      ]
     )
     if test x"$pov_svga_msg" = x"disabled"; then
       AC_MSG_NOTICE([SVGAlib display will be disabled])
@@ -513,19 +549,23 @@
   pov_xwin_msg="disabled"
   AC_PATH_XTRA
   if test x"$have_x" = x"yes"; then
-    AC_CHECK_LIB([X11], [XFlush],
+    AC_CHECK_HEADER([X11/Xlib.h],
       [
-        # X_CFLAGS should actually be X_CPPFLAGS since it only adds -Idir
-        CPPFLAGS="$X_CFLAGS $CPPFLAGS"
-        LDFLAGS="$X_LIBS $LDFLAGS"
-        LIBS="$X_EXTRA_LIBS $X_PRE_LIBS -lX11 $LIBS"
-        pov_xwin_msg="enabled"
-      ],
-      [
-        AC_MSG_NOTICE([X Window display will be disabled])
-        AC_DEFINE([X_DISPLAY_MISSING],[1])
-      ],
-      [-L$x_libraries -lX11]
+        AC_CHECK_LIB([X11], [XFlush],
+          [
+            # X_CFLAGS should actually be X_CPPFLAGS since it only adds -Idir
+            CPPFLAGS="$X_CFLAGS $CPPFLAGS"
+            LDFLAGS="$X_LIBS $LDFLAGS"
+            LIBS="$X_EXTRA_LIBS $X_PRE_LIBS -lX11 $LIBS"
+            pov_xwin_msg="enabled"
+          ],
+          [
+            AC_MSG_NOTICE([X Window display will be disabled])
+            AC_DEFINE([X_DISPLAY_MISSING],[1])
+          ],
+          [-L$x_libraries -lX11]
+        )
+      ]
     )
   else
     AC_MSG_NOTICE([X Window display will be disabled])
@@ -533,13 +573,19 @@
 
   if test x"$pov_xwin_msg" = x"enabled"; then
     # Color icon and X Window cursor.
-    AC_CHECK_LIB([Xpm], [XpmCreatePixmapFromData])
+    AC_CHECK_HEADER([X11/xpm.h],
+      [AC_CHECK_LIB([Xpm], [XpmCreatePixmapFromData])]
+    )
     AC_MSG_CHECKING([whether to enable the watch cursor])
     if test x"$enable_watch_cursor" = x"yes"; then
       AC_MSG_RESULT([yes])
-      AC_CHECK_FUNC([XCreateFontCursor],
-        [AC_DEFINE([USE_CURSOR], [], [Use a watch cursor while rendering.])],
-        [AC_MSG_NOTICE([watch cursor will be disabled])]
+      AC_CHECK_HEADER([X11/cursorfont.h],
+        [
+          AC_CHECK_FUNC([XCreateFontCursor],
+            [AC_DEFINE([USE_CURSOR], [], [Use a watch cursor while rendering.])],
+            [AC_MSG_NOTICE([watch cursor will be disabled])]
+          )
+        ]
       )
     else
       AC_MSG_RESULT([no])
@@ -563,7 +609,9 @@
 fi  # with_cygwin_dll
 
 
-AC_MSG_CHECKING([for installed supporting libraries])
+
+# Support libraries
+AC_MSG_CHECKING([for installed support libraries])
 if test x"$enable_lib_checks" != x"no"; then
   AC_MSG_RESULT([yes])
 else
@@ -571,7 +619,7 @@
 fi
 
 
-# Force the C compiler for testing the supporting libraries.
+# Force the C compiler for testing the support libraries.
 # This may prevent build failure on some systems.
 AC_LANG_PUSH(C)
 
@@ -591,7 +639,9 @@
     LIBS=`echo $LIBS | sed s,$ac_cv_search_zlibVersion,,g`
   fi
   INCZ="-I\$(top_srcdir)/libraries/zlib"
-  LIBZ="../libraries/zlib/libz.a"
+  LIBZ="\$(top_builddir)/libraries/zlib/libz.a"
+  POVLIBS="$POVLIBS zlib"
+  POVLIBSCLEAN="$POVLIBSCLEAN zlib"
   export INCZ		# tell libpng and libtiff to use the provided zlib.
 fi
 AC_SUBST([INCZ])
@@ -620,7 +670,9 @@
     LIBS=`echo $LIBS | sed s,$ac_cv_search_png_get_libpng_ver,,g`
   fi
   INCPNG="-I\$(top_srcdir)/libraries/png"
-  LIBPNG="../libraries/png/libpng.a"
+  LIBPNG="\$(top_builddir)/libraries/png/libpng.a"
+  POVLIBS="$POVLIBS png"
+  POVLIBSCLEAN="$POVLIBSCLEAN png"
 fi
 AC_SUBST([INCPNG])
 AC_SUBST([LIBPNG])
@@ -649,7 +701,9 @@
     LIBS=`echo $LIBS | sed s,$ac_cv_search_jpeg_std_error,,g`
   fi
   INCJPEG="-I\$(top_srcdir)/libraries/jpeg"
-  LIBJPEG="../libraries/jpeg/libjpeg.a"
+  LIBJPEG="\$(top_builddir)/libraries/jpeg/libjpeg.a"
+  POVLIBS="$POVLIBS jpeg"
+  POVLIBSCLEAN="$POVLIBSCLEAN jpeg"
   export INCJPEG	# tell libtiff to use the provided jpeg library.
 else
   # create jversion.h in builddir
@@ -679,12 +733,14 @@
   if test x"$enable_lib_checks" != x"no"; then
     AC_MSG_NOTICE([libtiff will be built and statically linked to $PACKAGE_NAME])
   fi
-  AC_CONFIG_SUBDIRS([libraries/tiff])
+  AC_CONFIG_SUBDIRS([libraries/tiff/libtiff])
   if test "$ac_cv_search_TIFFGetVersion"; then
     LIBS=`echo $LIBS | sed s,$ac_cv_search_TIFFGetVersion,,g`
   fi
   INCTIFF="-I\$(top_srcdir)/libraries/tiff/libtiff -I\$(top_builddir)/libraries/tiff/libtiff"
-  LIBTIFF="../libraries/tiff/libtiff/libtiff.a"
+  LIBTIFF="\$(top_builddir)/libraries/tiff/libtiff/libtiff.a"
+  POVLIBS="$POVLIBS tiff/libtiff"
+  POVLIBSCLEAN="$POVLIBSCLEAN tiff/libtiff"
 fi
 AC_SUBST([INCTIFF])
 AC_SUBST([LIBTIFF])
@@ -706,8 +762,8 @@
 ---------])
 
 # Start with no flags at all, so back them up first.
-pov_comp_save_cflags="$CFLAGS"
-pov_comp_save_cxxflags="$CXXFLAGS"
+pov_save_cflags="$CFLAGS"
+pov_save_cxxflags="$CXXFLAGS"
 CFLAGS=
 CXXFLAGS=
 
@@ -720,7 +776,7 @@
   AC_MSG_RESULT([yes])
   pov_flags="-pipe"
   POV_PROG_CXX_FLAGS([$pov_flags],
-    [if test "$subdirs"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
+    [if test "$POVLIBS"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
   )
 fi
 
@@ -756,7 +812,7 @@
   AC_MSG_RESULT([yes])
   pov_flags="-g"
   POV_PROG_CXX_FLAGS([$pov_flags],
-    [if test "$subdirs"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi],
+    [if test "$POVLIBS"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi],
     [AC_MSG_WARN([Cannot set debugging mode])]
   )
   AC_DEFINE([MEM_STATS], [2], [Memory statistics.])
@@ -778,13 +834,13 @@
   if test -z "$pov_cv_prog_cxx_flags_g"; then
     pov_flags="-g"
     POV_PROG_CXX_FLAGS([$pov_flags],
-      [if test "$subdirs"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi],
+      [if test "$POVLIBS"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi],
       [AC_MSG_WARN([Cannot set debugging mode])]
     )
   fi
   pov_flags="-pg"
   POV_PROG_CXX_FLAGS([$pov_flags],
-    [if test "$subdirs"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi],
+    [if test "$POVLIBS"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi],
     [AC_MSG_WARN([Cannot set profiling mode])]
   )
 else
@@ -796,19 +852,19 @@
 
 AC_MSG_CHECKING([whether to enable stripping])
 
-if test x"$enable_strip" = x"yes"; then
+if test x"$enable_strip" = x"no"; then
+  AC_MSG_RESULT([no])
+else
   if test x"$enable_debug" = x"yes" || test x"$enable_profile" = x"yes"; then
     AC_MSG_RESULT([no, debugging/profiling mode is on])
   else
     AC_MSG_RESULT([yes])
     pov_flags="-s"
     POV_PROG_CXX_FLAGS([$pov_flags],
-      [if test "$subdirs"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi],
+      [if test "$POVLIBS"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi],
       [AC_MSG_WARN([Cannot set stripping mode])]
     )
   fi
-else
-  AC_MSG_RESULT([no])
 fi
 
 
@@ -823,217 +879,270 @@
   # don't try -fast (makes ICC fail when linking due to implied -ipo flag).
   pov_flags="-O3"
   POV_PROG_CXX_FLAGS([$pov_flags],
-    [if test "$subdirs"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi],
+    [if test "$POVLIBS"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi],
     [
       pov_flags="-O2"
       POV_PROG_CXX_FLAGS([$pov_flags],
-        [if test "$subdirs"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi],
+        [if test "$POVLIBS"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi],
         [
           pov_flags="-O"
           POV_PROG_CXX_FLAGS([$pov_flags],
-            [if test "$subdirs"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
+            [if test "$POVLIBS"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
           )
         ]
       )
     ]
   )
 
-  # gcc-specific flags.
-  if test x"$CXX" = x"g++"; then
-    if test x"$pov_cv_prog_cxx_flags_O" = x"yes"; then  # -O was set
-      for pov_flags in "-fexpensive-optimizations" "-finline-functions" "-foptimize-sibling-calls"; do
+  # compiler-specific flags.
+  case "$pov_prog_cxx" in
+    *g++*)  # GCC
+      pov_cxx="gcc"
+      if test x"$pov_cv_prog_cxx_flags_O" = x"yes"; then  # -O was set
+        for pov_flags in "-fexpensive-optimizations" "-finline-functions" "-foptimize-sibling-calls"; do
+          POV_PROG_CXX_FLAGS([$pov_flags],
+            [if test "$POVLIBS"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
+          )
+        done
+      elif test x"$pov_cv_prog_cxx_flags_O2" = x"yes"; then  # -O2 was set
+        pov_flags="-finline-functions"
+        POV_PROG_CXX_FLAGS([$pov_flags],
+          [if test "$POVLIBS"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
+        )
+      fi
+      for pov_flags in "-ffast-math" "-malign-double" "-minline-all-stringops"; do
         POV_PROG_CXX_FLAGS([$pov_flags],
-          [if test "$subdirs"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
+          [if test "$POVLIBS"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
         )
       done
-    elif test x"$pov_cv_prog_cxx_flags_O2" = x"yes"; then  # -O2 was set
-      pov_flags="-finline-functions"
+      ;;
+
+    *icpc*|*icc*)  # ICC
+      pov_cxx="icc"
+      pov_flags="-ip"
       POV_PROG_CXX_FLAGS([$pov_flags],
-        [if test "$subdirs"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
+        [if test "$POVLIBS"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
       )
-    fi
-  # icc-specific flags.
-  elif test x"$CXX" = x"icc"; then
-    pov_flags="-ip"
-    POV_PROG_CXX_FLAGS([$pov_flags],
-      [if test "$subdirs"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
-    )
-  fi
+      ;;
+  esac
 
   # Arch-specific tuning, alphabetically ordered for conveniency.
+  # Perform checks only when not cross-compiling.
+  if test x"$cross_compiling" != x"yes"; then
   case "$host" in
 
     alphaev*6*)
-      ### Suggested by Christopher Endsley <endsley@yokuts.csustan.edu> .
+      ### Suggested by Christopher Endsley <endsley@yokuts.csustan.edu>
       for pov_flags in "-mcpu=ev56" "-mno-soft-float"; do
         POV_PROG_CXX_FLAGS([$pov_flags],
-          [if test "$subdirs"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
+          [if test "$POVLIBS"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
         )
       done
       ;;
 
     i?86-* | k?-* | *86*64*)
-      if test x"$cross_compiling" != x"yes"; then
-        # head is used to handle SMP/HT systems
-        # check whether 'head -n 1' is supported; otherwise use older 'head -1'
-        if test -z "`head -n 1 /dev/null 2>&1`"; then
-          head_1='head -n 1'
-        else
-          head_1='head -1'
-        fi
+      # head is used to handle SMP/HT systems
+      # check whether 'head -n 1' is supported; otherwise use older 'head -1'
+      if test -z "`head -n 1 /dev/null 2>&1`"; then
+        head_1='head -n 1'
+      else
+        head_1='head -1'
+      fi
 
-        if test -r /proc/cpuinfo ; then  # Linux
-          pov_cpuinfo=/proc/cpuinfo
-        elif test -r /compat/linux/proc/cpuinfo ; then # FreeBSD using linprocfs
-          pov_cpuinfo=/compat/linux/proc/cpuinfo
-        elif test "`dmesg 2> /dev/null`"; then  # FreeBSD 4.9 at least
-          pov_modelname=`dmesg | grep CPU | $head_1 | cut -d: -f2 | tr A-Z a-z`
-          pov_cpuflags=`dmesg | grep Features | $head_1 | cut -d'<' -f2 | sed 's/[,>]/ /g' | tr A-Z a-z`
-          pov_vendorid=`dmesg | grep Origin | $head_1 | cut -d'"' -f2`
-        fi
+      # get machine info
+      if test -r /proc/cpuinfo ; then  # Linux
+        pov_cpuinfo=/proc/cpuinfo
+      elif test -r /compat/linux/proc/cpuinfo ; then  # FreeBSD linprocfs
+        pov_cpuinfo=/compat/linux/proc/cpuinfo
+      ### patch by David Holland <dholland@eecs.harvard.edu> for FreeBSD/NetBSD
+      elif test -r /emul/linux/proc ; then  # NetBSD linprocfs
+        pov_cpuinfo=/emul/linux/proc
+      else
+        case "`uname -s 2>/dev/null || echo nothing`" in
+          NetBSD)
+            pov_modelname=`grep cpu0: /var/run/dmesg.boot | $head_1 | cut -d: -f2 | cut -d, -f1 | tr A-Z a-z`
+            pov_cpuflags=`grep 'cpu0: features' /var/run/dmesg.boot | cut -d'<' -f2 | tr 'A-Z,>\n' 'a-z   '`
+            pov_vendorid="unknown"  # not reported as such
+          ;;
+          FreeBSD)
+            pov_modelname=`grep CPU /var/run/dmesg.boot | $head_1 | cut -d: -f2 | tr A-Z a-z`
+            pov_cpuflags=`grep Features /var/run/dmesg.boot | $head_1 | cut -d'<' -f2 | tr 'A-Z,>' 'a-z  '`
+            pov_vendorid=`grep Origin /var/run/dmesg.boot | $head_1 | cut -d'"' -f2`
+          ;;
+        esac
       fi
+      ### D.H.
 
       if test "$pov_cpuinfo"; then
         pov_modelname=`cat $pov_cpuinfo | grep 'model name' | $head_1 | cut -d: -f2 | tr A-Z a-z`
         pov_cpuflags=`cat $pov_cpuinfo | grep flags | $head_1 | cut -d: -f2`
         pov_cpuflags=`echo $pov_cpuflags`  # remove leading/trailing blanks
         pov_vendorid=`cat $pov_cpuinfo | grep vendor_id | $head_1 | cut -d: -f2`
-        pov_vendorid=`echo $pov_vendorid`
+        pov_vendorid=`echo $pov_vendorid`  # remove leading/trailing blanks
       fi
 
+      # cpu model; remove mobile and clockspeed info
+      pov_cpumodel=${pov_modelname:-`uname -p 2> /dev/null`}
+      pov_cpumodel=`echo $pov_cpumodel | sed -e 's,mobile,,g' -e 's,\([[.[:alnum:]]]*hz\),,g'`
+
       # log values
       AC_TRY_COMMAND([echo pov_cpuinfo   = $pov_cpuinfo   > /dev/null])
       AC_TRY_COMMAND([echo pov_modelname = $pov_modelname > /dev/null])
+      AC_TRY_COMMAND([echo pov_cpumodel  = $pov_cpumodel  > /dev/null])
       AC_TRY_COMMAND([echo pov_vendorid  = $pov_vendorid  > /dev/null])
       AC_TRY_COMMAND([echo pov_cpuflags  = $pov_cpuflags  > /dev/null])
 
+      # SSE instruction set
       for flag in $pov_cpuflags ; do
         case "$flag" in
-          sse)
-            pov_flags="-m$flag"
-            POV_PROG_CXX_FLAGS([$pov_flags],
-              [if test "$subdirs"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
-            )
-            pov_flags="-mfpmath=$flag"
-            POV_PROG_CXX_FLAGS([$pov_flags],
-              [if test "$subdirs"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
-            )
-            ;;
-          sse?)  # sse2, sse3
-            pov_flags="-m$flag"
-            POV_PROG_CXX_FLAGS([$pov_flags],
-              [if test "$subdirs"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
-            )
-            ;;
+          sse)  pov_flags_has_sse="yes";;   # sse
+          sse?) pov_flags_has_sse2="yes";;  # sse2, sse3
         esac
       done
+      if test x"$pov_cxx" = x"gcc"; then  # GCC only
+        if test "$pov_flags_has_sse"; then
+          for pov_flags in "-msse" "-mfpmath=sse"; do
+            POV_PROG_CXX_FLAGS([$pov_flags],
+              [if test "$POVLIBS"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
+            )
+          done
+        fi
+        if test "$pov_flags_has_sse2"; then
+          pov_flags="-msse2"
+          POV_PROG_CXX_FLAGS([$pov_flags],
+            [if test "$POVLIBS"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
+          )
+        fi
+      fi
 
+      #
+      # processor checks reorganized after David Holland's suggestions
+      #
+
+      # processor architecture
       if test -z "$pov_arch"; then
         case "$host" in
-          i486-*)         pov_arch="i486";;
-          i586-*)         pov_arch="pentium";;  # for GCC / ICC
-          i686-*|i386-*)  # FreeBSD seems to only report i386
-            pov_cpu=${pov_modelname:-`uname -p 2> /dev/null`}
-            case "$pov_cpu" in
-              # Intel
-              *pentium*4*|*xeon*)  pov_arch="pentium4";;  # for GCC / ICC
-              *pentium*mmx*)       pov_arch="pentium";;   # catch this first
-              *pentium*m*)
-                if test x"$CXX" = x"icc"; then
-                  pov_arch="pentium4"
-                else
-                  pov_arch="pentium-m"
-                fi
-                ;;
-              *pentium*iii*|*celeron*)  # assume all celerons belong here
-                if test x"$CXX" = x"icc"; then
-                  pov_arch="pentiumiii"
-                else
-                  pov_arch="pentium3"
-                fi
-                ;;
-              *pentium*ii*)
-                if test x"$CXX" = x"icc"; then
-                  pov_arch="pentiumii"
-                else
-                  pov_arch="pentium2"
-                fi
-                ;;
-              *pentium*pro*)       pov_arch="pentiumpro";;  # for GCC / ICC
-              *pentium*)           pov_arch="pentium";;     # for GCC / ICC
-              # AMD
-              *athlon*xp*)         pov_arch="athlon-xp";;
-              *athlon*mp*)         pov_arch="athlon-mp";;
-              *athlon*|*duron*)    pov_arch="athlon";;
-              # others
-              *)                   pov_arch="i686";;  # don't support true i386
-            esac
-            pov_arch_fallback="i686"
-            ;;
-          k6-*)           pov_arch="k6"; pov_arch_fallback="i686";;
-          k7-*)           pov_arch="k7"; pov_arch_fallback="i686";;
-          k8-*|x86_64-*)  pov_arch="k8"; pov_arch_fallback="i686";;
-          *)              pov_arch="unknown";;
+          i386-*)    ;;  # *BSD always says i386; handled below
+          i486-*)    pov_arch="i486";;
+          i586-*)    pov_arch="pentium";;  # for GCC / ICC
+          i686-*)    ;;  # handled below
+          k6-*)      ;;  # handled below
+          k7-*)      ;;  # handled below
+          k8-*)      ;;  # handled below
+          x86_64-*)  ;;  # handled below
+          *)         pov_arch="unknown";;
         esac
       fi
-      if test x"$pov_arch" != x"unknown"; then
-        POV_PROG_CXX_FLAGS([-march=$pov_arch -mtune=$pov_arch],
-          [
-            if test "$subdirs"; then
-              {
-                POV_PROG_CC_FLAGS([-march=$pov_arch -mtune=$pov_arch],
-                  [],
-                  [POV_PROG_CC_FLAGS([-march=$pov_arch -mcpu=$pov_arch])]
-                )
-              }
-            fi
-          ],
-          [
-            POV_PROG_CXX_FLAGS([-march=$pov_arch -mcpu=$pov_arch],
-              [
-                if test "$subdirs"; then
-                  { POV_PROG_CC_FLAGS([-march=$pov_arch -mcpu=$pov_arch]) }
-                fi
-              ],
-              [
-                POV_PROG_CXX_FLAGS([-march=$pov_arch],
-                  [
-                    if test "$subdirs"; then
-                      { POV_PROG_CC_FLAGS([-march=$pov_arch]) }
-                    fi
-                  ],
-                  [
-                    if test "$pov_arch_fallback"; then
-                      {
-                        POV_PROG_CXX_FLAGS([-march=$pov_arch_fallback],
-                          [if test "$subdirs"; then { POV_PROG_CC_FLAGS([$pov_arch_fallback]) }; fi]
-                        )
-                      }
-                    fi
-                  ]
-                )
-              ]
-            )
-          ]
-        )
-      fi
 
-      # gcc says -malign-double makes no sense in the 64bit mode and reject it
-      for pov_flags in "-malign-double" "-minline-all-stringops"; do
-        POV_PROG_CXX_FLAGS([$pov_flags],
-          [if test "$subdirs"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
-        )
-      done
+      # processor model
+      if test -z "$pov_arch"; then
+        case "$pov_cpumodel" in
+          # Intel
+          *pentium*4*|*xeon*)  pov_arch="pentium4";;    # for GCC / ICC
+          *pentium*mmx*)       pov_arch="pentium";;     # catch this first
+          *pentium*iii*)       pov_arch="pentium3";;    # catch pentium III Mxxx before Pentium-M
+          *pentium*ii*)        pov_arch="pentium2";;
+          *pentium*m*)         pov_arch="pentium-m";;   # for ICC see below
+          *pentium*pro*)       pov_arch="pentiumpro";;  # for GCC / ICC
+          *pentium*)           pov_arch="pentium";;     # for GCC / ICC
+          *celeron*)           pov_arch="pentium3";;    # assume all celerons belong here (but see below)
+
+          # AMD; flags are for GCC only
+          *athlon*64*)         pov_arch="k8";;
+          *athlon*xp*)         pov_arch="athlon-xp";;
+          *athlon*mp*)         pov_arch="athlon-mp";;
+          *sempron*64*)        pov_arch="k8";;
+          *sempron*)           pov_arch="athlon-xp";;   # 3100+ is k8-based but w/o AMD64 ISA instructions
+          *athlon*|*duron*)    pov_arch="athlon";;
+          *k6*)                pov_arch="k6";;
+          *k7*)                pov_arch="k7";;
+          *k8*)                pov_arch="k8";;
+          *x86_64*)            pov_arch="k8";;
+
+          # others; don't support true i386
+          *)                   pov_arch="i686";;
+        esac  # pov_cpumodel
+
+        # newer celerons with SSE2
+        if test x"$pov_arch" = x"pentium3" && test x"$pov_flags_has_sse2" = x"yes"; then
+          pov_arch="pentium4"
+        fi
+
+        # ICC tweaks
+        if test x"$CXX" = x"icc"; then
+          case "$pov_arch" in
+            pentium2)             pov_arch="pentiumii";;
+            pentium3)             pov_arch="pentiumiii";;
+          esac
+        fi
+
+        # fallback
+        case "$pov_arch" in
+          k6|pentium)             pov_arch_fallback="i586";;
+          k7|k8|athlon|pentium*)  pov_arch_fallback="i686";;
+        esac
+      fi  # processor model
+
+      # check architecture compiler flag
+      if test x"$pov_arch" != x"unknown"; then
+        # pentium4 with ICC
+        if test x"$pov_arch" = x"pentium4" && test x"$pov_cxx" = x"icc"; then
+          pov_flags="-xP"          # Prescott
+          POV_PROG_CXX_FLAGS([$pov_flags],
+            [if test "$POVLIBS"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi],
+            [
+              pov_flags="-xN"      # Northwood
+              POV_PROG_CXX_FLAGS([$pov_flags],
+                [if test "$POVLIBS"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi],
+                [
+                  pov_flags="-xW"  # Willamette
+                  POV_PROG_CXX_FLAGS([$pov_flags],
+                    [if test "$POVLIBS"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
+                  )
+                ]
+              )
+            ]
+          )
+        # pentium-m with ICC
+        elif test x"$pov_arch" = x"pentium-m" && test x"$pov_cxx" = x"icc"; then
+          pov_flags="-xB"  # Banias
+          POV_PROG_CXX_FLAGS([$pov_flags],
+            [if test "$POVLIBS"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
+          )
+        # everything else
+        else
+          pov_flags="-march=$pov_arch"
+          POV_PROG_CXX_FLAGS([$pov_flags],
+            [if test "$POVLIBS"; then { POV_PROG_CC_FLAGS([-march=$pov_arch]) } fi],
+            [
+              if test "$pov_arch_fallback"; then
+                {
+                  pov_flags="-march=$pov_arch_fallback"
+                  POV_PROG_CXX_FLAGS([$pov_flags],
+                    [
+                      if test "$POVLIBS"; then
+                        { POV_PROG_CC_FLAGS([$pov_flags]) }
+                      fi
+                      pov_arch=$pov_arch_fallback
+                    ],
+                    [pov_arch=]
+                  )
+                }
+              fi
+            ]
+          )
+        fi
+      fi  # check architecture compiler flag
       ;;
 
     *irix*)
       pov_flags="-mips4"
       POV_PROG_CXX_FLAGS([$pov_flags],
-        [if test "$subdirs"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi],
+        [if test "$POVLIBS"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi],
         [
           pov_flags="-mips2"
           POV_PROG_CXX_FLAGS([$pov_flags],
-            [if test "$subdirs"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
+            [if test "$POVLIBS"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
           )
         ]
       )
@@ -1053,7 +1162,7 @@
       # cannot (as of February 2003) use them automatically anyway! [trf]
       for pov_flags in "-mpowerpc" "-mcpu=750 -mtune=7450" "-mmultiple" "-mstring" "-mfused-madd"; do
         POV_PROG_CXX_FLAGS([$pov_flags],
-          [if test "$subdirs"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
+          [if test "$POVLIBS"; then { POV_PROG_CC_FLAGS([$pov_flags]) }; fi]
         )
       done
       ;;
@@ -1065,6 +1174,7 @@
       ;;
 
   esac
+  fi  # not cross-compiling
 
 else
 
@@ -1074,10 +1184,14 @@
 
 
 # Add flags specified at the command line.
-CXXFLAGS="$CXXFLAGS $pov_comp_save_cxxflags"
+CXXFLAGS="$CXXFLAGS $pov_save_cxxflags"
+AC_DEFINE_UNQUOTED([CXXFLAGS],
+  ["$CXXFLAGS"],
+  [Compiler flags.]
+)
 
-# Flags for supporting libraries.
-CFLAGS="$CFLAGS $pov_comp_save_cflags"
+# Flags for support libraries.
+CFLAGS="$CFLAGS $pov_save_cflags"
 export CFLAGS CPPFLAGS LDFLAGS
 
 
@@ -1087,28 +1201,6 @@
 Makefiles
 ---------])
 
-# Supporting libraries to be included in the compilation/linking process.
-AC_SUBST([POVLIBS])
-if test "$LIBZ"; then
-  POVLIBS="zlib"
-fi
-if test "$LIBPNG"; then
-  POVLIBS="$POVLIBS png"
-fi
-if test "$LIBJPEG"; then
-  POVLIBS="$POVLIBS jpeg"
-fi
-# Does not compile all in tiff/ but only the library itself.
-# This is required to avoid errors due to some dependencies in tiff/tools .
-if test "$LIBTIFF"; then
-  POVLIBS="$POVLIBS tiff/port tiff/libtiff"
-fi
-
-# For 'make distclean' to clean also the supporting libraries.
-# It is different from POVLIBS since tiff/libtiff has no distclean target.
-POVLIBSCLEAN=`echo $POVLIBS | sed -e 's,tiff/port,,g' -e 's,/libtiff,,g'`
-AC_SUBST([POVLIBSCLEAN])
-
 AC_CONFIG_FILES([\
   Makefile \
   libraries/Makefile \
@@ -1121,11 +1213,11 @@
 
 ###############################################################################
 
-if test "$subdirs"; then
+if test "$POVLIBS"; then
   AC_CONFIG_COMMANDS([config.log],
     [AC_MSG_RESULT([
-Supporting libraries
---------------------])]
+Support libraries
+-----------------])]
   )
 fi
 AC_OUTPUT
@@ -1138,6 +1230,17 @@
 else
   pov_io_msg="enabled"
 fi
+
+# recursively expand the following variables for displaying
+for i in bindir sysconfdir datadir mandir ; do
+  eval povtemp=\$$i
+  while test "$povtemp" != "$oldpovtemp" ; do
+    oldpovtemp=$povtemp
+    eval povtemp=$povtemp
+  done
+  eval pov$i=$povtemp
+done
+
 AC_MSG_RESULT([
 ===============================================================================
 $PACKAGE_NAME $PACKAGE_VERSION has been configured with the following features:
@@ -1145,8 +1248,18 @@
   X Window display: ${pov_xwin_msg}
   SVGAlib display : ${pov_svga_msg}
 
-Type 'make' to build, and 'make install' to install all files in the hierarchy
-${prefix}])
+Type 'make check' to build the program and run a test render.
+Type 'make install' to install $PACKAGE_NAME on your system.
+
+The $PACKAGE_NAME components will be installed in the following directories:
+  Program executable          ${povbindir}
+  System configuration files  ${povsysconfdir}/$PACKAGE/$VERSION_BASE
+  User configuration files    ${HOME}/.$PACKAGE/$VERSION_BASE
+  Standard include files      ${povdatadir}/$PACKAGE-$VERSION_BASE/include
+  Standard INI files          ${povdatadir}/$PACKAGE-$VERSION_BASE/ini
+  Standard demo scene files   ${povdatadir}/$PACKAGE-$VERSION_BASE/scenes
+  Documentation               ${povdatadir}/doc/$PACKAGE-$VERSION_BASE
+  Unix man page               ${povmandir}])
 
 if test "$pov_warn_path"; then
   echo "
diff -ruN povray-3.6.1/libraries/tiff/libtiff/Makefile.am povray-3.6.1-config-0.2.0/libraries/tiff/libtiff/Makefile.am
--- povray-3.6.1/libraries/tiff/libtiff/Makefile.am	1970-01-01 01:00:00.000000000 +0100
+++ povray-3.6.1-config-0.2.0/libraries/tiff/libtiff/Makefile.am	2005-08-04 00:39:35.000000000 +0200
@@ -0,0 +1,95 @@
+##############################################################################
+#               Makefile.am
+#
+# Process this file with automake to produce Makefile.in
+#
+# from Persistence of Vision(tm) Ray Tracer version 3.6.
+# Copyright 1991-2003 Persistence of Vision Team
+# Copyright 2003-2004 Persistence of Vision Raytracer Pty. Ltd.
+#---------------------------------------------------------------------------
+# NOTICE: This source code file is provided so that users may experiment
+# with enhancements to POV-Ray and to port the software to platforms other
+# than those supported by the POV-Ray developers. There are strict rules
+# regarding how you are permitted to use this file. These rules are contained
+# in the distribution and derivative versions licenses which should have been
+# provided with this file.
+#
+# These licences may be found online, linked from the end-user license
+# agreement that is located at http://www.povray.org/povlegal.html
+#---------------------------------------------------------------------------
+# This program is based on the popular DKB raytracer version 2.12.
+# DKBTrace was originally written by David K. Buck.
+# DKBTrace Ver 2.0-2.12 were written by David K. Buck & Aaron A. Collins.
+##############################################################################
+
+# Makefile.am for the source distribution of POV-Ray 3.6 for UNIX
+# Written by Nicolas Calimet <pov4grasp@free.fr>
+
+# Programs and libraries to build.
+noinst_PROGRAMS = mkg3states mkversion
+noinst_LIBRARIES = libtiff.a
+
+# Source files.
+mkg3states_SOURCES = mkg3states.c $(top_builddir)/port.h tif_fax3.h
+if NEEDGETOPT
+mkg3states_SOURCES += $(top_srcdir)/../port/getopt.c
+endif
+
+mkversion_SOURCES = mkversion.c
+
+libtiff_a_SOURCES = \
+  tif_aux.c \
+  tif_close.c \
+  tif_codec.c \
+  tif_compress.c \
+  tif_color.c \
+  tif_dir.c tif_dir.h \
+  tif_dirinfo.c \
+  tif_dirread.c \
+  tif_dirwrite.c \
+  tif_dumpmode.c \
+  tif_error.c \
+  tif_extension.c \
+  tif_fax3.c t4.h tif_fax3.h \
+  $(top_builddir)/tif_fax3sm.c \
+  tif_getimage.c \
+  tif_jpeg.c \
+  tif_flush.c \
+  tif_luv.c \
+  tif_lzw.c \
+  tif_next.c \
+  tif_ojpeg.c \
+  tif_open.c \
+  tif_packbits.c \
+  tif_pixarlog.c \
+  tif_predict.c tif_predict.h \
+  tif_print.c \
+  tif_read.c \
+  tif_swab.c \
+  tif_strip.c \
+  tif_thunder.c \
+  tif_tile.c \
+  tif_unix.c \
+  tif_version.c \
+  tif_warning.c \
+  tif_write.c \
+  tif_zip.c \
+  tiff.h \
+  tiffio.h \
+  tiffconf.h \
+  $(top_builddir)/tiffvers.h \
+  $(top_builddir)/port.h
+
+$(top_builddir)/tif_fax3sm.c: $(top_builddir)/mkg3states$(EXEEXT)
+	$(top_builddir)/mkg3states$(EXEEXT) -c const $(top_builddir)/tif_fax3sm.c
+
+$(top_builddir)/tiffvers.h: $(top_builddir)/mkversion$(EXEEXT)
+	$(top_builddir)/mkversion$(EXEEXT) -v $(top_srcdir)/../VERSION -r $(top_srcdir)/../RELEASE-DATE $(top_builddir)/tiffvers.h
+
+# Additional files to clean with 'make clean'.
+CLEANFILES = $(top_builddir)/tif_fax3sm.c $(top_builddir)/tiffvers.h
+
+# Additional files to clean with 'make distclean'.
+DISTCLEANFILES = $(top_builddir)/port.h
+
+all: tiffvers.h
diff -ruN povray-3.6.1/libraries/tiff/libtiff/Makefile.in.orig povray-3.6.1-config-0.2.0/libraries/tiff/libtiff/Makefile.in.orig
--- povray-3.6.1/libraries/tiff/libtiff/Makefile.in.orig	1970-01-01 01:00:00.000000000 +0100
+++ povray-3.6.1-config-0.2.0/libraries/tiff/libtiff/Makefile.in.orig	2005-08-03 20:25:48.000000000 +0200
@@ -0,0 +1,414 @@
+#	$Header: /cvsroot/osrs/libtiff/libtiff/Makefile.in,v 1.25 2003/11/13 19:46:39 dron Exp $
+#
+# Tag Image File Format Library
+#
+# Copyright (c) 1988-1997 Sam Leffler
+# Copyright (c) 1991-1997 Silicon Graphics, Inc.
+# 
+# Permission to use, copy, modify, distribute, and sell this software and 
+# its documentation for any purpose is hereby granted without fee, provided
+# that (i) the above copyright notices and this permission notice appear in
+# all copies of the software and related documentation, and (ii) the names of
+# Sam Leffler and Silicon Graphics may not be used in any advertising or
+# publicity relating to the software without the specific, prior written
+# permission of Sam Leffler and Silicon Graphics.
+# 
+# THE SOFTWARE IS PROVIDED "AS-IS" AND WITHOUT WARRANTY OF ANY KIND, 
+# EXPRESS, IMPLIED OR OTHERWISE, INCLUDING WITHOUT LIMITATION, ANY 
+# WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  
+# 
+# IN NO EVENT SHALL SAM LEFFLER OR SILICON GRAPHICS BE LIABLE FOR
+# ANY SPECIAL, INCIDENTAL, INDIRECT OR CONSEQUENTIAL DAMAGES OF ANY KIND,
+# OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,
+# WHETHER OR NOT ADVISED OF THE POSSIBILITY OF DAMAGE, AND ON ANY THEORY OF 
+# LIABILITY, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE 
+# OF THIS SOFTWARE.
+#
+
+SRCDIR	= @LIBSRCDIR@
+
+#
+# VERSION:	@VERSION@
+# DATE:		@DATE@
+# TARGET:	@TARGET@
+# CCOMPILER:	@CCOMPILER@
+#
+SHELL	= @SCRIPT_SH@
+SCRIPT_SH = @SCRIPT_SH@
+NULL	=
+CC	= @CCOMPILER@
+AR	= @AR@
+AROPTS	= @AROPTS@
+RANLIB	= @RANLIB@
+INSTALL	= @INSTALL@
+
+#
+# If JPEG support is to be included and the Independent JPEG
+# Software distribution is not installed then DIR_JPEG must
+# refer to the directory where the include files reside.
+#
+# Similarly, if the libgz distribution is not installed, then
+# DIR_LIBGZ must refer to the directory where the include files
+# are located.  Note that recent versions 
+#
+IPATH	= -I. -I${SRCDIR} @COPT_LIBINC@
+#
+# To enable JPEG support include -DJPEG_SUPPORT here.
+# To enable Deflate support add a -DZIP_SUPPORT here.
+# Note that where the configure script is used these defines
+# are automatically setup when JPEG/ZIP is set to "yes".
+#
+# Otherwise, consult tiffconf.h for information on controlling
+# the configuration of optional library support.
+#
+CONF_LIBRARY=@CONF_JPEG@ @CONF_ZIP@
+COPTS	= @GCOPTS@
+OPTIMIZER=@OPTIMIZER@
+LFSOPTS=@LFSOPTS@
+CFLAGS	= @ENVOPTS@ @LIBCOPTS@ ${COPTS} ${OPTIMIZER} ${LFSOPTS} ${IPATH} ${CONF_LIBRARY}
+#
+SRCS	= \
+	tif_aux.c \
+	tif_close.c \
+	tif_codec.c \
+	tif_compress.c \
+	tif_color.c \
+	tif_dir.c \
+	tif_dirinfo.c \
+	tif_dirread.c \
+	tif_dirwrite.c \
+	tif_dumpmode.c \
+	tif_error.c \
+	tif_extension.c \
+	tif_fax3.c \
+	tif_fax3sm.c \
+	tif_getimage.c \
+	tif_jpeg.c \
+	tif_flush.c \
+	tif_luv.c \
+	tif_lzw.c \
+	tif_next.c \
+	nnnntif_ojpeg.c \
+	tif_open.c \
+	tif_packbits.c \
+	tif_pixarlog.c \
+	tif_predict.c \
+	tif_print.c \
+	tif_read.c \
+	tif_swab.c \
+	tif_strip.c \
+	tif_thunder.c \
+	tif_tile.c \
+	tif_unix.c \
+	tif_version.c \
+	tif_warning.c \
+	tif_write.c \
+	tif_zip.c \
+	${NULL}
+OBJS	= \
+	tif_aux.o \
+	tif_close.o \
+	tif_codec.o \
+	tif_compress.o \
+	tif_color.o\
+	tif_dir.o \
+	tif_dirinfo.o \
+	tif_dirread.o \
+	tif_dirwrite.o \
+	tif_dumpmode.o \
+	tif_error.o \
+	tif_extension.o \
+	tif_fax3.o \
+	tif_fax3sm.o \
+	tif_getimage.o \
+	tif_jpeg.o \
+	tif_flush.o \
+	tif_luv.o \
+	tif_lzw.o \
+	tif_next.o \
+	tif_ojpeg.o \
+	tif_open.o \
+	tif_packbits.o \
+	tif_pixarlog.o \
+	tif_predict.o \
+	tif_print.o \
+	tif_read.o \
+	tif_swab.o \
+	tif_strip.o \
+	tif_thunder.o \
+	tif_tile.o \
+	tif_unix.o \
+	tif_version.o \
+	tif_warning.o \
+	tif_write.o \
+	tif_zip.o \
+	${NULL}
+TARGETS	= libtiff.a
+
+all:	${TARGETS}
+	if [ @DSO@dso != nodso ]; then \
+	    ${MAKE} -${MAKEFLAGS} @DSO@dso; \
+	else \
+	    true; \
+	fi
+
+libtiff.a: ${OBJS}
+	${AR} ${AROPTS} libtiff.a $?
+	${RANLIB} libtiff.a
+
+#
+# NB: The configure script verifies that the configured
+# tools are capable of producing a DSO before enabling
+# their creation/use.  The following rules are effectively
+# duplicated in the configure script to do this verification.
+# This means that if you want to add support for building a
+# DSO on another system you'll need to modify this file *and*
+# configure if you want the right thing to happen automatically
+# (should probably be fixed up).
+#
+
+# default IRIX DSO building rule
+IRIXdso: ${OBJS}
+	@if [ "`basename ${CC}`" = "gcc" ]; then \
+	   ${LD} -n32 @ENVOPTS@ -o libtiff.@DSOSUF@ -shared -rdata_shared \
+	   ${OBJS}; \
+	else \
+	    ${CC} @ENVOPTS@ -o libtiff.@DSOSUF@ -shared -rdata_shared \
+	        -check_registry ${SRCDIR}/../port/irix/so_locations \
+	        -quickstart_info \
+	        ${OBJS} @LIBJPEG@ @LIBGZ@; \
+	fi
+	touch $@
+# special rule for IRIX 5.2
+IRIX52dso: ${OBJS}
+	${LD} -elf -o libtiff.@DSOSUF@ -shared -no_unresolved -all ${OBJS} \
+	    @LIBJPEG@ @LIBGZ@ -lc -lm
+	touch $@
+# Solaris 2.x
+SOLARISdso: ${OBJS}
+	${LD} -L@DIR_LIB@ -G -h libtiff.@DSOSUF@ -o libtiff.@DSOSUF@ ${OBJS}
+	touch $@
+# HP-UX 10.x+
+HPUXdso: ${OBJS}
+	${LD} -b -o libtiff.@DSOSUF_VERSION@ +h libtiff.@DSOSUF_VERSION@ ${OBJS}
+	touch $@
+# AIX 2.3.5 and 4.1.1
+AIXdso: ${OBJS}
+	rm -f libtiff.syms shr.o
+	echo "#!" > libtiff.syms
+	/bin/dump -g libtiff.a | sed -n -e \
+	      's/^[ 	]*[0-9][0-9]*[	 ]*\([^	 .][^ 	]*\)$$/\1/p' \
+	      >> libtiff.syms
+	${LD} -o shr.o libtiff.a -H512 -T512 -bM\:SRE \
+	    -bE\:libtiff.syms @LIBJPEG@ @LIBGZ@ -lc -lm -L@DIR_LIB@
+	rm -f libtiff.syms libtiff.@DSOSUF@
+	${AR} ${AROPTS} libtiff.@DSOSUF@ shr.o
+	rm -f shr.o
+	touch $@
+# GNU linker shared libraries
+GNULDdso: ${OBJS}
+	${CC} -shared -Wl,-soname,libtiff.@DSOSUF@ \
+	    -o libtiff.@DSOSUF_VERSION@  ${OBJS} \
+		@LIBJPEG@ @LIBGZ@ @MACHDEPLIBS@
+	rm -f libtiff.@DSOSUF@
+	if [ @DSOSUF_VERSION@ != @DSOSUF@ ] ; then \
+	  @LN@ @LN_S@ libtiff.@DSOSUF_VERSION@ libtiff.@DSOSUF@; \
+	fi
+	touch $@
+DARWINdso: ${OBJS}
+	${CC} -dynamiclib -undefined error \
+	  -install_name libtiff.@DSOSUF@ \
+	  -o libtiff.@DSOSUF_VERSION@  ${OBJS} \
+	  @LIBJPEG@ @LIBGZ@ @MACHDEPLIBS@
+	rm -f libtiff.@DSOSUF@
+	if [ @DSOSUF_VERSION@ != @DSOSUF@ ] ; then \
+	  @LN@ @LN_S@ libtiff.@DSOSUF_VERSION@ libtiff.@DSOSUF@; \
+	fi
+	touch $@
+# NetBSD 1.1 or FreeBSD (old style)
+NETBSDdso FREEBSDdso oldOPENBSDdso: ${OBJS}
+	@rm -f libtiff_pic.a
+	@${AR} cq libtiff_pic.a `lorder ${OBJS} | tsort -q`
+	${RANLIB} libtiff_pic.a
+	${LD} -x -Bshareable -Bforcearchive -o libtiff.@DSOSUF@ libtiff_pic.a
+	rm -f libtiff_pic.a
+	touch $@
+# linux ELF shared lib rule
+LINUXdso:  ${OBJS}
+	${CC} -shared -Wl,-soname,libtiff.@DSOSUF@ \
+	    -o libtiff.@DSOSUF_VERSION@  ${OBJS} \
+		@LIBJPEG@ @LIBGZ@ @MACHLIBDEPS@
+	rm -f libtiff.@DSOSUF@
+	@LN@ @LN_S@ libtiff.@DSOSUF_VERSION@ libtiff.@DSOSUF@
+	touch $@
+# OSF/1 3.2 shared lib rule
+OSFdso: ${OBJS}
+	${LD} -o libtiff.@DSOSUF@ -shared -error_unresolved ${OBJS} @LIBJPEG@ @LIBGZ@ -lc -lm
+
+OPENBSDdso: ${OBJS}
+	${CC} -shared @LIBCOPTS@ -o libtiff.@DSOSUF_VERSION@ ${OBJS} @LIBJPEG@ @LIBGZ@ -lm
+	touch $@
+
+OPENSERVERdso:  ${OBJS}
+	${CC} -shared -fPIC \
+	  -o libtiff.@DSOSUF_VERSION@  ${OBJS} \
+		@LIBJPEG@ @LIBGZ@
+	rm -f libtiff.@DSOSUF@
+	@LN@ @LN_S@ libtiff.@DSOSUF_VERSION@ libtiff.@DSOSUF@
+	touch $@
+
+${OBJS}: ${SRCDIR}/tiffio.h ${SRCDIR}/tiff.h ${SRCDIR}/tif_dir.h
+${OBJS}: ${SRCDIR}/tiffcomp.h ${SRCDIR}/tiffiop.h ${SRCDIR}/tiffconf.h
+${OBJS}: ${SRCDIR}/tiffvers.h
+
+VERSION	= @VERSIONFILE@
+RELEASE_DATE = @RELEASE_DATE_FILE@
+
+${SRCDIR}/tiffvers.h: ${VERSION} ${SRCDIR}/mkversion.c
+	${CC} -o mkversion ${CFLAGS} ${SRCDIR}/mkversion.c
+	rm -f ${SRCDIR}/tiffvers.h
+	./mkversion -v ${VERSION} -r ${RELEASE_DATE} ${SRCDIR}/tiffvers.h
+
+tiffvers.h:	${SRCDIR}/tiffvers.h
+
+#
+# The finite state machine tables used by the G3/G4 decoders
+# are generated by the mkg3states program.  On systems without
+# make these rules have to be manually carried out.
+#
+tif_fax3sm.c: ${SRCDIR}/mkg3states.c ${SRCDIR}/tif_fax3.h
+	${CC} -o mkg3states ${CFLAGS} ${SRCDIR}/mkg3states.c
+	rm -f tif_fax3sm.c; ./mkg3states -c const tif_fax3sm.c
+
+tif_aux.o: ${SRCDIR}/tif_aux.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_aux.c
+tif_close.o: ${SRCDIR}/tif_close.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_close.c
+tif_codec.o: ${SRCDIR}/tif_codec.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_codec.c
+tif_compress.o: ${SRCDIR}/tif_compress.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_compress.c
+tif_color.o: ${SRCDIR}/tif_color.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_color.c
+tif_dir.o: ${SRCDIR}/tif_dir.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_dir.c
+tif_dirinfo.o: ${SRCDIR}/tif_dirinfo.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_dirinfo.c
+tif_dirread.o: ${SRCDIR}/tif_dirread.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_dirread.c
+tif_dirwrite.o: ${SRCDIR}/tif_dirwrite.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_dirwrite.c
+tif_dumpmode.o: ${SRCDIR}/tif_dumpmode.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_dumpmode.c
+tif_error.o: ${SRCDIR}/tif_error.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_error.c
+tif_extension.o: ${SRCDIR}/tif_extension.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_extension.c
+tif_fax3.o: ${SRCDIR}/tif_fax3.c ${SRCDIR}/t4.h ${SRCDIR}/tif_fax3.h
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_fax3.c
+tif_getimage.o: ${SRCDIR}/tif_getimage.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_getimage.c
+tif_jpeg.o: ${SRCDIR}/tif_jpeg.c @DEPEND_JPEGLIB@
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_jpeg.c
+tif_flush.o: ${SRCDIR}/tif_flush.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_flush.c
+tif_luv.o: ${SRCDIR}/tif_luv.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_luv.c
+tif_lzw.o: ${SRCDIR}/tif_lzw.c ${SRCDIR}/tif_predict.h
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_lzw.c
+tif_next.o: ${SRCDIR}/tif_next.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_next.c
+tif_ojpeg.o: ${SRCDIR}/tif_ojpeg.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_ojpeg.c
+tif_open.o: ${SRCDIR}/tif_open.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_open.c
+tif_packbits.o: ${SRCDIR}/tif_packbits.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_packbits.c
+tif_pixarlog.o: ${SRCDIR}/tif_pixarlog.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_pixarlog.c
+tif_predict.o: ${SRCDIR}/tif_predict.c ${SRCDIR}/tif_predict.h
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_predict.c
+tif_print.o: ${SRCDIR}/tif_print.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_print.c
+tif_read.o: ${SRCDIR}/tif_read.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_read.c
+tif_swab.o: ${SRCDIR}/tif_swab.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_swab.c
+tif_strip.o: ${SRCDIR}/tif_strip.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_strip.c
+tif_thunder.o: ${SRCDIR}/tif_thunder.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_thunder.c
+tif_tile.o: ${SRCDIR}/tif_tile.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_tile.c
+tif_unix.o: ${SRCDIR}/tif_unix.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_unix.c
+tif_version.o: ${SRCDIR}/tif_version.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_version.c
+tif_warning.o: ${SRCDIR}/tif_warning.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_warning.c
+tif_write.o: ${SRCDIR}/tif_write.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_write.c
+tif_zip.o: ${SRCDIR}/tif_zip.c ${SRCDIR}/tif_predict.h @DEPEND_ZLIB@
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_zip.c
+
+tif_apple.o: ${SRCDIR}/tif_apple.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_apple.c
+tif_atari.o: ${SRCDIR}/tif_atari.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_atari.c
+tif_msdos.o: ${SRCDIR}/tif_msdos.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_msdos.c
+tif_vms.o: ${SRCDIR}/tif_vms.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_vms.c
+tif_win3.o: ${SRCDIR}/tif_win3.c
+	${CC} -c ${CFLAGS} ${SRCDIR}/tif_win3.c
+
+INCS	= ${SRCDIR}/tiff.h ${SRCDIR}/tiffio.h ${SRCDIR}/tiffconf.h \
+	${SRCDIR}/tiffvers.h
+
+INCS_PRIVATE = ${SRCDIR}/tiffiop.h ${SRCDIR}/tif_dir.h ${SRCDIR}/port.h
+
+installHdrs: ${INCS}
+	${INSTALL} -idb tiff.sw.dev -m 755 -dir ${DESTDIR}@DIR_INC@
+	for i in ${INCS}; do						\
+	    f=`basename $$i`;						\
+	    ${INSTALL} -idb tiff.sw.dev -m 444 -F ${DESTDIR}@DIR_INC@	\
+		-src $$i -O $$f;					\
+	done
+
+installPrivateHdrs: ${INCS_PRIVATE}
+	${INSTALL} -idb tiff.sw.dev -m 755 -dir ${DESTDIR}@DIR_INC@
+	for i in ${INCS_PRIVATE}; do					\
+	    f=`basename $$i`;						\
+	    ${INSTALL} -idb tiff.sw.dev -m 444 -F ${DESTDIR}@DIR_INC@	\
+		-src $$i -O $$f;					\
+	done
+
+installDSO: @DSO@dso
+	if [ @DSOSUF_VERSION@ != @DSOSUF@ ]; then			\
+	    ${INSTALL} -idb tiff.sw.tools.nostrip -m 555		\
+		-F ${DESTDIR}@DIR_LIB@ -O libtiff.@DSOSUF_VERSION@;	\
+	    ${INSTALL} -idb tiff.sw.tools -F ${DESTDIR}@DIR_LIB@	\
+		-lns libtiff.@DSOSUF_VERSION@ -O libtiff.@DSOSUF@;	\
+	    ${INSTALL} -idb tiff.sw.tools -F ${DESTDIR}@DIR_LIB@	\
+		-lns libtiff.@DSOSUF@ -O libtiff.so;			\
+	else								\
+	    ${INSTALL} -idb tiff.sw.tools.nostrip -m 555		\
+		-F ${DESTDIR}@DIR_LIB@ -O libtiff.@DSOSUF@;		\
+	fi
+
+install: all installHdrs
+	${INSTALL} -idb tiff.sw.dev -m 755 -dir ${DESTDIR}@DIR_LIB@
+	${INSTALL} -idb tiff.sw.dev -m 444 -F ${DESTDIR}@DIR_LIB@ -O libtiff.a
+	if [ @DSO@dso != nodso ]; then					\
+	    ${MAKE} -${MAKEFLAGS} installDSO;				\
+	else								\
+	    true;							\
+	fi
+
+install-private: install installPrivateHdrs
+
+clean:
+	rm -f ${TARGETS} ${OBJS} core a.out \
+	    mkg3states tif_fax3sm.c \
+	    mkversion ${SRCDIR}/tiffvers.h \
+	    libtiff.a libtiff.@DSOSUF@ libtiff.@DSOSUF_VERSION@ *dso
diff -ruN povray-3.6.1/libraries/tiff/libtiff/bootstrap povray-3.6.1-config-0.2.0/libraries/tiff/libtiff/bootstrap
--- povray-3.6.1/libraries/tiff/libtiff/bootstrap	1970-01-01 01:00:00.000000000 +0100
+++ povray-3.6.1-config-0.2.0/libraries/tiff/libtiff/bootstrap	2005-08-04 00:39:35.000000000 +0200
@@ -0,0 +1,14 @@
+#!/bin/sh -x
+
+# bootstrap for the source distribution of POV-Ray 3.6 for UNIX
+# Written by Nicolas Calimet <pov4grasp@free.fr>
+# Run this script if configure.ac or any Makefile.am has changed
+
+rm -f config.log config.status
+
+aclocal
+autoheader --warnings=all
+automake --warnings=all --foreign
+autoconf --warnings=all
+
+rm -f -r autom4te.cache
diff -ruN povray-3.6.1/libraries/tiff/libtiff/config.guess povray-3.6.1-config-0.2.0/libraries/tiff/libtiff/config.guess
--- povray-3.6.1/libraries/tiff/libtiff/config.guess	1970-01-01 01:00:00.000000000 +0100
+++ povray-3.6.1-config-0.2.0/libraries/tiff/libtiff/config.guess	2005-08-03 20:25:48.000000000 +0200
@@ -0,0 +1,1459 @@
+#! /bin/sh
+# Attempt to guess a canonical system name.
+#   Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999,
+#   2000, 2001, 2002, 2003 Free Software Foundation, Inc.
+
+timestamp='2004-06-11'
+
+# This file is free software; you can redistribute it and/or modify it
+# under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful, but
+# WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+# General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+#
+# As a special exception to the GNU General Public License, if you
+# distribute this file as part of a program that contains a
+# configuration script generated by Autoconf, you may include it under
+# the same distribution terms that you use for the rest of that program.
+
+# Originally written by Per Bothner <per@bothner.com>.
+# Please send patches to <config-patches@gnu.org>.  Submit a context
+# diff and a properly formatted ChangeLog entry.
+#
+# This script attempts to guess a canonical system name similar to
+# config.sub.  If it succeeds, it prints the system name on stdout, and
+# exits with 0.  Otherwise, it exits with 1.
+#
+# The plan is that this can be called by configure scripts if you
+# don't specify an explicit build system type.
+
+me=`echo "$0" | sed -e 's,.*/,,'`
+
+usage="\
+Usage: $0 [OPTION]
+
+Output the configuration name of the system \`$me' is run on.
+
+Operation modes:
+  -h, --help         print this help, then exit
+  -t, --time-stamp   print date of last modification, then exit
+  -v, --version      print version number, then exit
+
+Report bugs and patches to <config-patches@gnu.org>."
+
+version="\
+GNU config.guess ($timestamp)
+
+Originally written by Per Bothner.
+Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001
+Free Software Foundation, Inc.
+
+This is free software; see the source for copying conditions.  There is NO
+warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE."
+
+help="
+Try \`$me --help' for more information."
+
+# Parse command line
+while test $# -gt 0 ; do
+  case $1 in
+    --time-stamp | --time* | -t )
+       echo "$timestamp" ; exit 0 ;;
+    --version | -v )
+       echo "$version" ; exit 0 ;;
+    --help | --h* | -h )
+       echo "$usage"; exit 0 ;;
+    -- )     # Stop option processing
+       shift; break ;;
+    - )	# Use stdin as input.
+       break ;;
+    -* )
+       echo "$me: invalid option $1$help" >&2
+       exit 1 ;;
+    * )
+       break ;;
+  esac
+done
+
+if test $# != 0; then
+  echo "$me: too many arguments$help" >&2
+  exit 1
+fi
+
+trap 'exit 1' 1 2 15
+
+# CC_FOR_BUILD -- compiler used by this script. Note that the use of a
+# compiler to aid in system detection is discouraged as it requires
+# temporary files to be created and, as you can see below, it is a
+# headache to deal with in a portable fashion.
+
+# Historically, `CC_FOR_BUILD' used to be named `HOST_CC'. We still
+# use `HOST_CC' if defined, but it is deprecated.
+
+# Portable tmp directory creation inspired by the Autoconf team.
+
+set_cc_for_build='
+trap "exitcode=\$?; (rm -f \$tmpfiles 2>/dev/null; rmdir \$tmp 2>/dev/null) && exit \$exitcode" 0 ;
+trap "rm -f \$tmpfiles 2>/dev/null; rmdir \$tmp 2>/dev/null; exit 1" 1 2 13 15 ;
+: ${TMPDIR=/tmp} ;
+ { tmp=`(umask 077 && mktemp -d -q "$TMPDIR/cgXXXXXX") 2>/dev/null` && test -n "$tmp" && test -d "$tmp" ; } ||
+ { test -n "$RANDOM" && tmp=$TMPDIR/cg$$-$RANDOM && (umask 077 && mkdir $tmp) ; } ||
+ { tmp=$TMPDIR/cg-$$ && (umask 077 && mkdir $tmp) && echo "Warning: creating insecure temp directory" >&2 ; } ||
+ { echo "$me: cannot create a temporary directory in $TMPDIR" >&2 ; exit 1 ; } ;
+dummy=$tmp/dummy ;
+tmpfiles="$dummy.c $dummy.o $dummy.rel $dummy" ;
+case $CC_FOR_BUILD,$HOST_CC,$CC in
+ ,,)    echo "int x;" > $dummy.c ;
+	for c in cc gcc c89 c99 ; do
+	  if ($c -c -o $dummy.o $dummy.c) >/dev/null 2>&1 ; then
+	     CC_FOR_BUILD="$c"; break ;
+	  fi ;
+	done ;
+	if test x"$CC_FOR_BUILD" = x ; then
+	  CC_FOR_BUILD=no_compiler_found ;
+	fi
+	;;
+ ,,*)   CC_FOR_BUILD=$CC ;;
+ ,*,*)  CC_FOR_BUILD=$HOST_CC ;;
+esac ;'
+
+# This is needed to find uname on a Pyramid OSx when run in the BSD universe.
+# (ghazi@noc.rutgers.edu 1994-08-24)
+if (test -f /.attbin/uname) >/dev/null 2>&1 ; then
+	PATH=$PATH:/.attbin ; export PATH
+fi
+
+UNAME_MACHINE=`(uname -m) 2>/dev/null` || UNAME_MACHINE=unknown
+UNAME_RELEASE=`(uname -r) 2>/dev/null` || UNAME_RELEASE=unknown
+UNAME_SYSTEM=`(uname -s) 2>/dev/null`  || UNAME_SYSTEM=unknown
+UNAME_VERSION=`(uname -v) 2>/dev/null` || UNAME_VERSION=unknown
+
+# Note: order is significant - the case branches are not exclusive.
+
+case "${UNAME_MACHINE}:${UNAME_SYSTEM}:${UNAME_RELEASE}:${UNAME_VERSION}" in
+    *:NetBSD:*:*)
+	# NetBSD (nbsd) targets should (where applicable) match one or
+	# more of the tupples: *-*-netbsdelf*, *-*-netbsdaout*,
+	# *-*-netbsdecoff* and *-*-netbsd*.  For targets that recently
+	# switched to ELF, *-*-netbsd* would select the old
+	# object file format.  This provides both forward
+	# compatibility and a consistent mechanism for selecting the
+	# object file format.
+	#
+	# Note: NetBSD doesn't particularly care about the vendor
+	# portion of the name.  We always set it to "unknown".
+	sysctl="sysctl -n hw.machine_arch"
+	UNAME_MACHINE_ARCH=`(/sbin/$sysctl 2>/dev/null || \
+	    /usr/sbin/$sysctl 2>/dev/null || echo unknown)`
+	case "${UNAME_MACHINE_ARCH}" in
+	    armeb) machine=armeb-unknown ;;
+	    arm*) machine=arm-unknown ;;
+	    sh3el) machine=shl-unknown ;;
+	    sh3eb) machine=sh-unknown ;;
+	    *) machine=${UNAME_MACHINE_ARCH}-unknown ;;
+	esac
+	# The Operating System including object format, if it has switched
+	# to ELF recently, or will in the future.
+	case "${UNAME_MACHINE_ARCH}" in
+	    arm*|i386|m68k|ns32k|sh3*|sparc|vax)
+		eval $set_cc_for_build
+		if echo __ELF__ | $CC_FOR_BUILD -E - 2>/dev/null \
+			| grep __ELF__ >/dev/null
+		then
+		    # Once all utilities can be ECOFF (netbsdecoff) or a.out (netbsdaout).
+		    # Return netbsd for either.  FIX?
+		    os=netbsd
+		else
+		    os=netbsdelf
+		fi
+		;;
+	    *)
+	        os=netbsd
+		;;
+	esac
+	# The OS release
+	# Debian GNU/NetBSD machines have a different userland, and
+	# thus, need a distinct triplet. However, they do not need
+	# kernel version information, so it can be replaced with a
+	# suitable tag, in the style of linux-gnu.
+	case "${UNAME_VERSION}" in
+	    Debian*)
+		release='-gnu'
+		;;
+	    *)
+		release=`echo ${UNAME_RELEASE}|sed -e 's/[-_].*/\./'`
+		;;
+	esac
+	# Since CPU_TYPE-MANUFACTURER-KERNEL-OPERATING_SYSTEM:
+	# contains redundant information, the shorter form:
+	# CPU_TYPE-MANUFACTURER-OPERATING_SYSTEM is used.
+	echo "${machine}-${os}${release}"
+	exit 0 ;;
+    amd64:OpenBSD:*:*)
+	echo x86_64-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    amiga:OpenBSD:*:*)
+	echo m68k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    arc:OpenBSD:*:*)
+	echo mipsel-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    cats:OpenBSD:*:*)
+	echo arm-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    hp300:OpenBSD:*:*)
+	echo m68k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    luna88k:OpenBSD:*:*)
+    	echo m88k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    mac68k:OpenBSD:*:*)
+	echo m68k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    macppc:OpenBSD:*:*)
+	echo powerpc-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    mvme68k:OpenBSD:*:*)
+	echo m68k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    mvme88k:OpenBSD:*:*)
+	echo m88k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    mvmeppc:OpenBSD:*:*)
+	echo powerpc-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    pmax:OpenBSD:*:*)
+	echo mipsel-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    sgi:OpenBSD:*:*)
+	echo mipseb-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    sun3:OpenBSD:*:*)
+	echo m68k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    wgrisc:OpenBSD:*:*)
+	echo mipsel-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    *:OpenBSD:*:*)
+	echo ${UNAME_MACHINE}-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    *:ekkoBSD:*:*)
+	echo ${UNAME_MACHINE}-unknown-ekkobsd${UNAME_RELEASE}
+	exit 0 ;;
+    macppc:MirBSD:*:*)
+	echo powerppc-unknown-mirbsd${UNAME_RELEASE}
+	exit 0 ;;
+    *:MirBSD:*:*)
+	echo ${UNAME_MACHINE}-unknown-mirbsd${UNAME_RELEASE}
+	exit 0 ;;
+    alpha:OSF1:*:*)
+	case $UNAME_RELEASE in
+	*4.0)
+		UNAME_RELEASE=`/usr/sbin/sizer -v | awk '{print $3}'`
+		;;
+	*5.*)
+	        UNAME_RELEASE=`/usr/sbin/sizer -v | awk '{print $4}'`
+		;;
+	esac
+	# According to Compaq, /usr/sbin/psrinfo has been available on
+	# OSF/1 and Tru64 systems produced since 1995.  I hope that
+	# covers most systems running today.  This code pipes the CPU
+	# types through head -n 1, so we only detect the type of CPU 0.
+	ALPHA_CPU_TYPE=`/usr/sbin/psrinfo -v | sed -n -e 's/^  The alpha \(.*\) processor.*$/\1/p' | head -n 1`
+	case "$ALPHA_CPU_TYPE" in
+	    "EV4 (21064)")
+		UNAME_MACHINE="alpha" ;;
+	    "EV4.5 (21064)")
+		UNAME_MACHINE="alpha" ;;
+	    "LCA4 (21066/21068)")
+		UNAME_MACHINE="alpha" ;;
+	    "EV5 (21164)")
+		UNAME_MACHINE="alphaev5" ;;
+	    "EV5.6 (21164A)")
+		UNAME_MACHINE="alphaev56" ;;
+	    "EV5.6 (21164PC)")
+		UNAME_MACHINE="alphapca56" ;;
+	    "EV5.7 (21164PC)")
+		UNAME_MACHINE="alphapca57" ;;
+	    "EV6 (21264)")
+		UNAME_MACHINE="alphaev6" ;;
+	    "EV6.7 (21264A)")
+		UNAME_MACHINE="alphaev67" ;;
+	    "EV6.8CB (21264C)")
+		UNAME_MACHINE="alphaev68" ;;
+	    "EV6.8AL (21264B)")
+		UNAME_MACHINE="alphaev68" ;;
+	    "EV6.8CX (21264D)")
+		UNAME_MACHINE="alphaev68" ;;
+	    "EV6.9A (21264/EV69A)")
+		UNAME_MACHINE="alphaev69" ;;
+	    "EV7 (21364)")
+		UNAME_MACHINE="alphaev7" ;;
+	    "EV7.9 (21364A)")
+		UNAME_MACHINE="alphaev79" ;;
+	esac
+	# A Pn.n version is a patched version.
+	# A Vn.n version is a released version.
+	# A Tn.n version is a released field test version.
+	# A Xn.n version is an unreleased experimental baselevel.
+	# 1.2 uses "1.2" for uname -r.
+	echo ${UNAME_MACHINE}-dec-osf`echo ${UNAME_RELEASE} | sed -e 's/^[PVTX]//' | tr 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' 'abcdefghijklmnopqrstuvwxyz'`
+	exit 0 ;;
+    Alpha*:OpenVMS:*:*)
+	echo alpha-hp-vms
+	exit 0 ;;
+    Alpha\ *:Windows_NT*:*)
+	# How do we know it's Interix rather than the generic POSIX subsystem?
+	# Should we change UNAME_MACHINE based on the output of uname instead
+	# of the specific Alpha model?
+	echo alpha-pc-interix
+	exit 0 ;;
+    21064:Windows_NT:50:3)
+	echo alpha-dec-winnt3.5
+	exit 0 ;;
+    Amiga*:UNIX_System_V:4.0:*)
+	echo m68k-unknown-sysv4
+	exit 0;;
+    *:[Aa]miga[Oo][Ss]:*:*)
+	echo ${UNAME_MACHINE}-unknown-amigaos
+	exit 0 ;;
+    *:[Mm]orph[Oo][Ss]:*:*)
+	echo ${UNAME_MACHINE}-unknown-morphos
+	exit 0 ;;
+    *:OS/390:*:*)
+	echo i370-ibm-openedition
+	exit 0 ;;
+    *:OS400:*:*)
+        echo powerpc-ibm-os400
+	exit 0 ;;
+    arm:RISC*:1.[012]*:*|arm:riscix:1.[012]*:*)
+	echo arm-acorn-riscix${UNAME_RELEASE}
+	exit 0;;
+    SR2?01:HI-UX/MPP:*:* | SR8000:HI-UX/MPP:*:*)
+	echo hppa1.1-hitachi-hiuxmpp
+	exit 0;;
+    Pyramid*:OSx*:*:* | MIS*:OSx*:*:* | MIS*:SMP_DC-OSx*:*:*)
+	# akee@wpdis03.wpafb.af.mil (Earle F. Ake) contributed MIS and NILE.
+	if test "`(/bin/universe) 2>/dev/null`" = att ; then
+		echo pyramid-pyramid-sysv3
+	else
+		echo pyramid-pyramid-bsd
+	fi
+	exit 0 ;;
+    NILE*:*:*:dcosx)
+	echo pyramid-pyramid-svr4
+	exit 0 ;;
+    DRS?6000:unix:4.0:6*)
+	echo sparc-icl-nx6
+	exit 0 ;;
+    DRS?6000:UNIX_SV:4.2*:7*)
+	case `/usr/bin/uname -p` in
+	    sparc) echo sparc-icl-nx7 && exit 0 ;;
+	esac ;;
+    sun4H:SunOS:5.*:*)
+	echo sparc-hal-solaris2`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
+	exit 0 ;;
+    sun4*:SunOS:5.*:* | tadpole*:SunOS:5.*:*)
+	echo sparc-sun-solaris2`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
+	exit 0 ;;
+    i86pc:SunOS:5.*:*)
+	echo i386-pc-solaris2`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
+	exit 0 ;;
+    sun4*:SunOS:6*:*)
+	# According to config.sub, this is the proper way to canonicalize
+	# SunOS6.  Hard to guess exactly what SunOS6 will be like, but
+	# it's likely to be more like Solaris than SunOS4.
+	echo sparc-sun-solaris3`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
+	exit 0 ;;
+    sun4*:SunOS:*:*)
+	case "`/usr/bin/arch -k`" in
+	    Series*|S4*)
+		UNAME_RELEASE=`uname -v`
+		;;
+	esac
+	# Japanese Language versions have a version number like `4.1.3-JL'.
+	echo sparc-sun-sunos`echo ${UNAME_RELEASE}|sed -e 's/-/_/'`
+	exit 0 ;;
+    sun3*:SunOS:*:*)
+	echo m68k-sun-sunos${UNAME_RELEASE}
+	exit 0 ;;
+    sun*:*:4.2BSD:*)
+	UNAME_RELEASE=`(sed 1q /etc/motd | awk '{print substr($5,1,3)}') 2>/dev/null`
+	test "x${UNAME_RELEASE}" = "x" && UNAME_RELEASE=3
+	case "`/bin/arch`" in
+	    sun3)
+		echo m68k-sun-sunos${UNAME_RELEASE}
+		;;
+	    sun4)
+		echo sparc-sun-sunos${UNAME_RELEASE}
+		;;
+	esac
+	exit 0 ;;
+    aushp:SunOS:*:*)
+	echo sparc-auspex-sunos${UNAME_RELEASE}
+	exit 0 ;;
+    # The situation for MiNT is a little confusing.  The machine name
+    # can be virtually everything (everything which is not
+    # "atarist" or "atariste" at least should have a processor
+    # > m68000).  The system name ranges from "MiNT" over "FreeMiNT"
+    # to the lowercase version "mint" (or "freemint").  Finally
+    # the system name "TOS" denotes a system which is actually not
+    # MiNT.  But MiNT is downward compatible to TOS, so this should
+    # be no problem.
+    atarist[e]:*MiNT:*:* | atarist[e]:*mint:*:* | atarist[e]:*TOS:*:*)
+        echo m68k-atari-mint${UNAME_RELEASE}
+	exit 0 ;;
+    atari*:*MiNT:*:* | atari*:*mint:*:* | atarist[e]:*TOS:*:*)
+	echo m68k-atari-mint${UNAME_RELEASE}
+        exit 0 ;;
+    *falcon*:*MiNT:*:* | *falcon*:*mint:*:* | *falcon*:*TOS:*:*)
+        echo m68k-atari-mint${UNAME_RELEASE}
+	exit 0 ;;
+    milan*:*MiNT:*:* | milan*:*mint:*:* | *milan*:*TOS:*:*)
+        echo m68k-milan-mint${UNAME_RELEASE}
+        exit 0 ;;
+    hades*:*MiNT:*:* | hades*:*mint:*:* | *hades*:*TOS:*:*)
+        echo m68k-hades-mint${UNAME_RELEASE}
+        exit 0 ;;
+    *:*MiNT:*:* | *:*mint:*:* | *:*TOS:*:*)
+        echo m68k-unknown-mint${UNAME_RELEASE}
+        exit 0 ;;
+    m68k:machten:*:*)
+	echo m68k-apple-machten${UNAME_RELEASE}
+	exit 0 ;;
+    powerpc:machten:*:*)
+	echo powerpc-apple-machten${UNAME_RELEASE}
+	exit 0 ;;
+    RISC*:Mach:*:*)
+	echo mips-dec-mach_bsd4.3
+	exit 0 ;;
+    RISC*:ULTRIX:*:*)
+	echo mips-dec-ultrix${UNAME_RELEASE}
+	exit 0 ;;
+    VAX*:ULTRIX*:*:*)
+	echo vax-dec-ultrix${UNAME_RELEASE}
+	exit 0 ;;
+    2020:CLIX:*:* | 2430:CLIX:*:*)
+	echo clipper-intergraph-clix${UNAME_RELEASE}
+	exit 0 ;;
+    mips:*:*:UMIPS | mips:*:*:RISCos)
+	eval $set_cc_for_build
+	sed 's/^	//' << EOF >$dummy.c
+#ifdef __cplusplus
+#include <stdio.h>  /* for printf() prototype */
+	int main (int argc, char *argv[]) {
+#else
+	int main (argc, argv) int argc; char *argv[]; {
+#endif
+	#if defined (host_mips) && defined (MIPSEB)
+	#if defined (SYSTYPE_SYSV)
+	  printf ("mips-mips-riscos%ssysv\n", argv[1]); exit (0);
+	#endif
+	#if defined (SYSTYPE_SVR4)
+	  printf ("mips-mips-riscos%ssvr4\n", argv[1]); exit (0);
+	#endif
+	#if defined (SYSTYPE_BSD43) || defined(SYSTYPE_BSD)
+	  printf ("mips-mips-riscos%sbsd\n", argv[1]); exit (0);
+	#endif
+	#endif
+	  exit (-1);
+	}
+EOF
+	$CC_FOR_BUILD -o $dummy $dummy.c \
+	  && $dummy `echo "${UNAME_RELEASE}" | sed -n 's/\([0-9]*\).*/\1/p'` \
+	  && exit 0
+	echo mips-mips-riscos${UNAME_RELEASE}
+	exit 0 ;;
+    Motorola:PowerMAX_OS:*:*)
+	echo powerpc-motorola-powermax
+	exit 0 ;;
+    Motorola:*:4.3:PL8-*)
+	echo powerpc-harris-powermax
+	exit 0 ;;
+    Night_Hawk:*:*:PowerMAX_OS | Synergy:PowerMAX_OS:*:*)
+	echo powerpc-harris-powermax
+	exit 0 ;;
+    Night_Hawk:Power_UNIX:*:*)
+	echo powerpc-harris-powerunix
+	exit 0 ;;
+    m88k:CX/UX:7*:*)
+	echo m88k-harris-cxux7
+	exit 0 ;;
+    m88k:*:4*:R4*)
+	echo m88k-motorola-sysv4
+	exit 0 ;;
+    m88k:*:3*:R3*)
+	echo m88k-motorola-sysv3
+	exit 0 ;;
+    AViiON:dgux:*:*)
+        # DG/UX returns AViiON for all architectures
+        UNAME_PROCESSOR=`/usr/bin/uname -p`
+	if [ $UNAME_PROCESSOR = mc88100 ] || [ $UNAME_PROCESSOR = mc88110 ]
+	then
+	    if [ ${TARGET_BINARY_INTERFACE}x = m88kdguxelfx ] || \
+	       [ ${TARGET_BINARY_INTERFACE}x = x ]
+	    then
+		echo m88k-dg-dgux${UNAME_RELEASE}
+	    else
+		echo m88k-dg-dguxbcs${UNAME_RELEASE}
+	    fi
+	else
+	    echo i586-dg-dgux${UNAME_RELEASE}
+	fi
+ 	exit 0 ;;
+    M88*:DolphinOS:*:*)	# DolphinOS (SVR3)
+	echo m88k-dolphin-sysv3
+	exit 0 ;;
+    M88*:*:R3*:*)
+	# Delta 88k system running SVR3
+	echo m88k-motorola-sysv3
+	exit 0 ;;
+    XD88*:*:*:*) # Tektronix XD88 system running UTekV (SVR3)
+	echo m88k-tektronix-sysv3
+	exit 0 ;;
+    Tek43[0-9][0-9]:UTek:*:*) # Tektronix 4300 system running UTek (BSD)
+	echo m68k-tektronix-bsd
+	exit 0 ;;
+    *:IRIX*:*:*)
+	echo mips-sgi-irix`echo ${UNAME_RELEASE}|sed -e 's/-/_/g'`
+	exit 0 ;;
+    ????????:AIX?:[12].1:2)   # AIX 2.2.1 or AIX 2.1.1 is RT/PC AIX.
+	echo romp-ibm-aix      # uname -m gives an 8 hex-code CPU id
+	exit 0 ;;              # Note that: echo "'`uname -s`'" gives 'AIX '
+    i*86:AIX:*:*)
+	echo i386-ibm-aix
+	exit 0 ;;
+    ia64:AIX:*:*)
+	if [ -x /usr/bin/oslevel ] ; then
+		IBM_REV=`/usr/bin/oslevel`
+	else
+		IBM_REV=${UNAME_VERSION}.${UNAME_RELEASE}
+	fi
+	echo ${UNAME_MACHINE}-ibm-aix${IBM_REV}
+	exit 0 ;;
+    *:AIX:2:3)
+	if grep bos325 /usr/include/stdio.h >/dev/null 2>&1; then
+		eval $set_cc_for_build
+		sed 's/^		//' << EOF >$dummy.c
+		#include <sys/systemcfg.h>
+
+		main()
+			{
+			if (!__power_pc())
+				exit(1);
+			puts("powerpc-ibm-aix3.2.5");
+			exit(0);
+			}
+EOF
+		$CC_FOR_BUILD -o $dummy $dummy.c && $dummy && exit 0
+		echo rs6000-ibm-aix3.2.5
+	elif grep bos324 /usr/include/stdio.h >/dev/null 2>&1; then
+		echo rs6000-ibm-aix3.2.4
+	else
+		echo rs6000-ibm-aix3.2
+	fi
+	exit 0 ;;
+    *:AIX:*:[45])
+	IBM_CPU_ID=`/usr/sbin/lsdev -C -c processor -S available | sed 1q | awk '{ print $1 }'`
+	if /usr/sbin/lsattr -El ${IBM_CPU_ID} | grep ' POWER' >/dev/null 2>&1; then
+		IBM_ARCH=rs6000
+	else
+		IBM_ARCH=powerpc
+	fi
+	if [ -x /usr/bin/oslevel ] ; then
+		IBM_REV=`/usr/bin/oslevel`
+	else
+		IBM_REV=${UNAME_VERSION}.${UNAME_RELEASE}
+	fi
+	echo ${IBM_ARCH}-ibm-aix${IBM_REV}
+	exit 0 ;;
+    *:AIX:*:*)
+	echo rs6000-ibm-aix
+	exit 0 ;;
+    ibmrt:4.4BSD:*|romp-ibm:BSD:*)
+	echo romp-ibm-bsd4.4
+	exit 0 ;;
+    ibmrt:*BSD:*|romp-ibm:BSD:*)            # covers RT/PC BSD and
+	echo romp-ibm-bsd${UNAME_RELEASE}   # 4.3 with uname added to
+	exit 0 ;;                           # report: romp-ibm BSD 4.3
+    *:BOSX:*:*)
+	echo rs6000-bull-bosx
+	exit 0 ;;
+    DPX/2?00:B.O.S.:*:*)
+	echo m68k-bull-sysv3
+	exit 0 ;;
+    9000/[34]??:4.3bsd:1.*:*)
+	echo m68k-hp-bsd
+	exit 0 ;;
+    hp300:4.4BSD:*:* | 9000/[34]??:4.3bsd:2.*:*)
+	echo m68k-hp-bsd4.4
+	exit 0 ;;
+    9000/[34678]??:HP-UX:*:*)
+	HPUX_REV=`echo ${UNAME_RELEASE}|sed -e 's/[^.]*.[0B]*//'`
+	case "${UNAME_MACHINE}" in
+	    9000/31? )            HP_ARCH=m68000 ;;
+	    9000/[34]?? )         HP_ARCH=m68k ;;
+	    9000/[678][0-9][0-9])
+		if [ -x /usr/bin/getconf ]; then
+		    sc_cpu_version=`/usr/bin/getconf SC_CPU_VERSION 2>/dev/null`
+                    sc_kernel_bits=`/usr/bin/getconf SC_KERNEL_BITS 2>/dev/null`
+                    case "${sc_cpu_version}" in
+                      523) HP_ARCH="hppa1.0" ;; # CPU_PA_RISC1_0
+                      528) HP_ARCH="hppa1.1" ;; # CPU_PA_RISC1_1
+                      532)                      # CPU_PA_RISC2_0
+                        case "${sc_kernel_bits}" in
+                          32) HP_ARCH="hppa2.0n" ;;
+                          64) HP_ARCH="hppa2.0w" ;;
+			  '') HP_ARCH="hppa2.0" ;;   # HP-UX 10.20
+                        esac ;;
+                    esac
+		fi
+		if [ "${HP_ARCH}" = "" ]; then
+		    eval $set_cc_for_build
+		    sed 's/^              //' << EOF >$dummy.c
+
+              #define _HPUX_SOURCE
+              #include <stdlib.h>
+              #include <unistd.h>
+
+              int main ()
+              {
+              #if defined(_SC_KERNEL_BITS)
+                  long bits = sysconf(_SC_KERNEL_BITS);
+              #endif
+                  long cpu  = sysconf (_SC_CPU_VERSION);
+
+                  switch (cpu)
+              	{
+              	case CPU_PA_RISC1_0: puts ("hppa1.0"); break;
+              	case CPU_PA_RISC1_1: puts ("hppa1.1"); break;
+              	case CPU_PA_RISC2_0:
+              #if defined(_SC_KERNEL_BITS)
+              	    switch (bits)
+              		{
+              		case 64: puts ("hppa2.0w"); break;
+              		case 32: puts ("hppa2.0n"); break;
+              		default: puts ("hppa2.0"); break;
+              		} break;
+              #else  /* !defined(_SC_KERNEL_BITS) */
+              	    puts ("hppa2.0"); break;
+              #endif
+              	default: puts ("hppa1.0"); break;
+              	}
+                  exit (0);
+              }
+EOF
+		    (CCOPTS= $CC_FOR_BUILD -o $dummy $dummy.c 2>/dev/null) && HP_ARCH=`$dummy`
+		    test -z "$HP_ARCH" && HP_ARCH=hppa
+		fi ;;
+	esac
+	if [ ${HP_ARCH} = "hppa2.0w" ]
+	then
+	    # avoid double evaluation of $set_cc_for_build
+	    test -n "$CC_FOR_BUILD" || eval $set_cc_for_build
+	    if echo __LP64__ | (CCOPTS= $CC_FOR_BUILD -E -) | grep __LP64__ >/dev/null
+	    then
+		HP_ARCH="hppa2.0w"
+	    else
+		HP_ARCH="hppa64"
+	    fi
+	fi
+	echo ${HP_ARCH}-hp-hpux${HPUX_REV}
+	exit 0 ;;
+    ia64:HP-UX:*:*)
+	HPUX_REV=`echo ${UNAME_RELEASE}|sed -e 's/[^.]*.[0B]*//'`
+	echo ia64-hp-hpux${HPUX_REV}
+	exit 0 ;;
+    3050*:HI-UX:*:*)
+	eval $set_cc_for_build
+	sed 's/^	//' << EOF >$dummy.c
+	#include <unistd.h>
+	int
+	main ()
+	{
+	  long cpu = sysconf (_SC_CPU_VERSION);
+	  /* The order matters, because CPU_IS_HP_MC68K erroneously returns
+	     true for CPU_PA_RISC1_0.  CPU_IS_PA_RISC returns correct
+	     results, however.  */
+	  if (CPU_IS_PA_RISC (cpu))
+	    {
+	      switch (cpu)
+		{
+		  case CPU_PA_RISC1_0: puts ("hppa1.0-hitachi-hiuxwe2"); break;
+		  case CPU_PA_RISC1_1: puts ("hppa1.1-hitachi-hiuxwe2"); break;
+		  case CPU_PA_RISC2_0: puts ("hppa2.0-hitachi-hiuxwe2"); break;
+		  default: puts ("hppa-hitachi-hiuxwe2"); break;
+		}
+	    }
+	  else if (CPU_IS_HP_MC68K (cpu))
+	    puts ("m68k-hitachi-hiuxwe2");
+	  else puts ("unknown-hitachi-hiuxwe2");
+	  exit (0);
+	}
+EOF
+	$CC_FOR_BUILD -o $dummy $dummy.c && $dummy && exit 0
+	echo unknown-hitachi-hiuxwe2
+	exit 0 ;;
+    9000/7??:4.3bsd:*:* | 9000/8?[79]:4.3bsd:*:* )
+	echo hppa1.1-hp-bsd
+	exit 0 ;;
+    9000/8??:4.3bsd:*:*)
+	echo hppa1.0-hp-bsd
+	exit 0 ;;
+    *9??*:MPE/iX:*:* | *3000*:MPE/iX:*:*)
+	echo hppa1.0-hp-mpeix
+	exit 0 ;;
+    hp7??:OSF1:*:* | hp8?[79]:OSF1:*:* )
+	echo hppa1.1-hp-osf
+	exit 0 ;;
+    hp8??:OSF1:*:*)
+	echo hppa1.0-hp-osf
+	exit 0 ;;
+    i*86:OSF1:*:*)
+	if [ -x /usr/sbin/sysversion ] ; then
+	    echo ${UNAME_MACHINE}-unknown-osf1mk
+	else
+	    echo ${UNAME_MACHINE}-unknown-osf1
+	fi
+	exit 0 ;;
+    parisc*:Lites*:*:*)
+	echo hppa1.1-hp-lites
+	exit 0 ;;
+    C1*:ConvexOS:*:* | convex:ConvexOS:C1*:*)
+	echo c1-convex-bsd
+        exit 0 ;;
+    C2*:ConvexOS:*:* | convex:ConvexOS:C2*:*)
+	if getsysinfo -f scalar_acc
+	then echo c32-convex-bsd
+	else echo c2-convex-bsd
+	fi
+        exit 0 ;;
+    C34*:ConvexOS:*:* | convex:ConvexOS:C34*:*)
+	echo c34-convex-bsd
+        exit 0 ;;
+    C38*:ConvexOS:*:* | convex:ConvexOS:C38*:*)
+	echo c38-convex-bsd
+        exit 0 ;;
+    C4*:ConvexOS:*:* | convex:ConvexOS:C4*:*)
+	echo c4-convex-bsd
+        exit 0 ;;
+    CRAY*Y-MP:*:*:*)
+	echo ymp-cray-unicos${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
+	exit 0 ;;
+    CRAY*[A-Z]90:*:*:*)
+	echo ${UNAME_MACHINE}-cray-unicos${UNAME_RELEASE} \
+	| sed -e 's/CRAY.*\([A-Z]90\)/\1/' \
+	      -e y/ABCDEFGHIJKLMNOPQRSTUVWXYZ/abcdefghijklmnopqrstuvwxyz/ \
+	      -e 's/\.[^.]*$/.X/'
+	exit 0 ;;
+    CRAY*TS:*:*:*)
+	echo t90-cray-unicos${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
+	exit 0 ;;
+    CRAY*T3E:*:*:*)
+	echo alphaev5-cray-unicosmk${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
+	exit 0 ;;
+    CRAY*SV1:*:*:*)
+	echo sv1-cray-unicos${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
+	exit 0 ;;
+    *:UNICOS/mp:*:*)
+	echo nv1-cray-unicosmp${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
+	exit 0 ;;
+    F30[01]:UNIX_System_V:*:* | F700:UNIX_System_V:*:*)
+	FUJITSU_PROC=`uname -m | tr 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' 'abcdefghijklmnopqrstuvwxyz'`
+        FUJITSU_SYS=`uname -p | tr 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' 'abcdefghijklmnopqrstuvwxyz' | sed -e 's/\///'`
+        FUJITSU_REL=`echo ${UNAME_RELEASE} | sed -e 's/ /_/'`
+        echo "${FUJITSU_PROC}-fujitsu-${FUJITSU_SYS}${FUJITSU_REL}"
+        exit 0 ;;
+    5000:UNIX_System_V:4.*:*)
+        FUJITSU_SYS=`uname -p | tr 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' 'abcdefghijklmnopqrstuvwxyz' | sed -e 's/\///'`
+        FUJITSU_REL=`echo ${UNAME_RELEASE} | tr 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' 'abcdefghijklmnopqrstuvwxyz' | sed -e 's/ /_/'`
+        echo "sparc-fujitsu-${FUJITSU_SYS}${FUJITSU_REL}"
+	exit 0 ;;
+    i*86:BSD/386:*:* | i*86:BSD/OS:*:* | *:Ascend\ Embedded/OS:*:*)
+	echo ${UNAME_MACHINE}-pc-bsdi${UNAME_RELEASE}
+	exit 0 ;;
+    sparc*:BSD/OS:*:*)
+	echo sparc-unknown-bsdi${UNAME_RELEASE}
+	exit 0 ;;
+    *:BSD/OS:*:*)
+	echo ${UNAME_MACHINE}-unknown-bsdi${UNAME_RELEASE}
+	exit 0 ;;
+    *:FreeBSD:*:*)
+	# Determine whether the default compiler uses glibc.
+	eval $set_cc_for_build
+	sed 's/^	//' << EOF >$dummy.c
+	#include <features.h>
+	#if __GLIBC__ >= 2
+	LIBC=gnu
+	#else
+	LIBC=
+	#endif
+EOF
+	eval `$CC_FOR_BUILD -E $dummy.c 2>/dev/null | grep ^LIBC=`
+	# GNU/KFreeBSD systems have a "k" prefix to indicate we are using
+	# FreeBSD's kernel, but not the complete OS.
+	case ${LIBC} in gnu) kernel_only='k' ;; esac
+	echo ${UNAME_MACHINE}-unknown-${kernel_only}freebsd`echo ${UNAME_RELEASE}|sed -e 's/[-(].*//'`${LIBC:+-$LIBC}
+	exit 0 ;;
+    i*:CYGWIN*:*)
+	echo ${UNAME_MACHINE}-pc-cygwin
+	exit 0 ;;
+    i*:MINGW*:*)
+	echo ${UNAME_MACHINE}-pc-mingw32
+	exit 0 ;;
+    i*:PW*:*)
+	echo ${UNAME_MACHINE}-pc-pw32
+	exit 0 ;;
+    x86:Interix*:[34]*)
+	echo i586-pc-interix${UNAME_RELEASE}|sed -e 's/\..*//'
+	exit 0 ;;
+    [345]86:Windows_95:* | [345]86:Windows_98:* | [345]86:Windows_NT:*)
+	echo i${UNAME_MACHINE}-pc-mks
+	exit 0 ;;
+    i*:Windows_NT*:* | Pentium*:Windows_NT*:*)
+	# How do we know it's Interix rather than the generic POSIX subsystem?
+	# It also conflicts with pre-2.0 versions of AT&T UWIN. Should we
+	# UNAME_MACHINE based on the output of uname instead of i386?
+	echo i586-pc-interix
+	exit 0 ;;
+    i*:UWIN*:*)
+	echo ${UNAME_MACHINE}-pc-uwin
+	exit 0 ;;
+    p*:CYGWIN*:*)
+	echo powerpcle-unknown-cygwin
+	exit 0 ;;
+    prep*:SunOS:5.*:*)
+	echo powerpcle-unknown-solaris2`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
+	exit 0 ;;
+    *:GNU:*:*)
+	# the GNU system
+	echo `echo ${UNAME_MACHINE}|sed -e 's,[-/].*$,,'`-unknown-gnu`echo ${UNAME_RELEASE}|sed -e 's,/.*$,,'`
+	exit 0 ;;
+    *:GNU/*:*:*)
+	# other systems with GNU libc and userland
+	echo ${UNAME_MACHINE}-unknown-`echo ${UNAME_SYSTEM} | sed 's,^[^/]*/,,' | tr '[A-Z]' '[a-z]'``echo ${UNAME_RELEASE}|sed -e 's/[-(].*//'`-gnu
+	exit 0 ;;
+    i*86:Minix:*:*)
+	echo ${UNAME_MACHINE}-pc-minix
+	exit 0 ;;
+    arm*:Linux:*:*)
+	echo ${UNAME_MACHINE}-unknown-linux-gnu
+	exit 0 ;;
+    cris:Linux:*:*)
+	echo cris-axis-linux-gnu
+	exit 0 ;;
+    ia64:Linux:*:*)
+	echo ${UNAME_MACHINE}-unknown-linux-gnu
+	exit 0 ;;
+    m32r*:Linux:*:*)
+	echo ${UNAME_MACHINE}-unknown-linux-gnu
+	exit 0 ;;
+    m68*:Linux:*:*)
+	echo ${UNAME_MACHINE}-unknown-linux-gnu
+	exit 0 ;;
+    mips:Linux:*:*)
+	eval $set_cc_for_build
+	sed 's/^	//' << EOF >$dummy.c
+	#undef CPU
+	#undef mips
+	#undef mipsel
+	#if defined(__MIPSEL__) || defined(__MIPSEL) || defined(_MIPSEL) || defined(MIPSEL)
+	CPU=mipsel
+	#else
+	#if defined(__MIPSEB__) || defined(__MIPSEB) || defined(_MIPSEB) || defined(MIPSEB)
+	CPU=mips
+	#else
+	CPU=
+	#endif
+	#endif
+EOF
+	eval `$CC_FOR_BUILD -E $dummy.c 2>/dev/null | grep ^CPU=`
+	test x"${CPU}" != x && echo "${CPU}-unknown-linux-gnu" && exit 0
+	;;
+    mips64:Linux:*:*)
+	eval $set_cc_for_build
+	sed 's/^	//' << EOF >$dummy.c
+	#undef CPU
+	#undef mips64
+	#undef mips64el
+	#if defined(__MIPSEL__) || defined(__MIPSEL) || defined(_MIPSEL) || defined(MIPSEL)
+	CPU=mips64el
+	#else
+	#if defined(__MIPSEB__) || defined(__MIPSEB) || defined(_MIPSEB) || defined(MIPSEB)
+	CPU=mips64
+	#else
+	CPU=
+	#endif
+	#endif
+EOF
+	eval `$CC_FOR_BUILD -E $dummy.c 2>/dev/null | grep ^CPU=`
+	test x"${CPU}" != x && echo "${CPU}-unknown-linux-gnu" && exit 0
+	;;
+    ppc:Linux:*:*)
+	echo powerpc-unknown-linux-gnu
+	exit 0 ;;
+    ppc64:Linux:*:*)
+	echo powerpc64-unknown-linux-gnu
+	exit 0 ;;
+    alpha:Linux:*:*)
+	case `sed -n '/^cpu model/s/^.*: \(.*\)/\1/p' < /proc/cpuinfo` in
+	  EV5)   UNAME_MACHINE=alphaev5 ;;
+	  EV56)  UNAME_MACHINE=alphaev56 ;;
+	  PCA56) UNAME_MACHINE=alphapca56 ;;
+	  PCA57) UNAME_MACHINE=alphapca56 ;;
+	  EV6)   UNAME_MACHINE=alphaev6 ;;
+	  EV67)  UNAME_MACHINE=alphaev67 ;;
+	  EV68*) UNAME_MACHINE=alphaev68 ;;
+        esac
+	objdump --private-headers /bin/sh | grep ld.so.1 >/dev/null
+	if test "$?" = 0 ; then LIBC="libc1" ; else LIBC="" ; fi
+	echo ${UNAME_MACHINE}-unknown-linux-gnu${LIBC}
+	exit 0 ;;
+    parisc:Linux:*:* | hppa:Linux:*:*)
+	# Look for CPU level
+	case `grep '^cpu[^a-z]*:' /proc/cpuinfo 2>/dev/null | cut -d' ' -f2` in
+	  PA7*) echo hppa1.1-unknown-linux-gnu ;;
+	  PA8*) echo hppa2.0-unknown-linux-gnu ;;
+	  *)    echo hppa-unknown-linux-gnu ;;
+	esac
+	exit 0 ;;
+    parisc64:Linux:*:* | hppa64:Linux:*:*)
+	echo hppa64-unknown-linux-gnu
+	exit 0 ;;
+    s390:Linux:*:* | s390x:Linux:*:*)
+	echo ${UNAME_MACHINE}-ibm-linux
+	exit 0 ;;
+    sh64*:Linux:*:*)
+    	echo ${UNAME_MACHINE}-unknown-linux-gnu
+	exit 0 ;;
+    sh*:Linux:*:*)
+	echo ${UNAME_MACHINE}-unknown-linux-gnu
+	exit 0 ;;
+    sparc:Linux:*:* | sparc64:Linux:*:*)
+	echo ${UNAME_MACHINE}-unknown-linux-gnu
+	exit 0 ;;
+    x86_64:Linux:*:*)
+	echo x86_64-unknown-linux-gnu
+	exit 0 ;;
+    i*86:Linux:*:*)
+	# The BFD linker knows what the default object file format is, so
+	# first see if it will tell us. cd to the root directory to prevent
+	# problems with other programs or directories called `ld' in the path.
+	# Set LC_ALL=C to ensure ld outputs messages in English.
+	ld_supported_targets=`cd /; LC_ALL=C ld --help 2>&1 \
+			 | sed -ne '/supported targets:/!d
+				    s/[ 	][ 	]*/ /g
+				    s/.*supported targets: *//
+				    s/ .*//
+				    p'`
+        case "$ld_supported_targets" in
+	  elf32-i386)
+		TENTATIVE="${UNAME_MACHINE}-pc-linux-gnu"
+		;;
+	  a.out-i386-linux)
+		echo "${UNAME_MACHINE}-pc-linux-gnuaout"
+		exit 0 ;;
+	  coff-i386)
+		echo "${UNAME_MACHINE}-pc-linux-gnucoff"
+		exit 0 ;;
+	  "")
+		# Either a pre-BFD a.out linker (linux-gnuoldld) or
+		# one that does not give us useful --help.
+		echo "${UNAME_MACHINE}-pc-linux-gnuoldld"
+		exit 0 ;;
+	esac
+	# Determine whether the default compiler is a.out or elf
+	eval $set_cc_for_build
+	sed 's/^	//' << EOF >$dummy.c
+	#include <features.h>
+	#ifdef __ELF__
+	# ifdef __GLIBC__
+	#  if __GLIBC__ >= 2
+	LIBC=gnu
+	#  else
+	LIBC=gnulibc1
+	#  endif
+	# else
+	LIBC=gnulibc1
+	# endif
+	#else
+	#ifdef __INTEL_COMPILER
+	LIBC=gnu
+	#else
+	LIBC=gnuaout
+	#endif
+	#endif
+	#ifdef __dietlibc__
+	LIBC=dietlibc
+	#endif
+EOF
+	eval `$CC_FOR_BUILD -E $dummy.c 2>/dev/null | grep ^LIBC=`
+	test x"${LIBC}" != x && echo "${UNAME_MACHINE}-pc-linux-${LIBC}" && exit 0
+	test x"${TENTATIVE}" != x && echo "${TENTATIVE}" && exit 0
+	;;
+    i*86:DYNIX/ptx:4*:*)
+	# ptx 4.0 does uname -s correctly, with DYNIX/ptx in there.
+	# earlier versions are messed up and put the nodename in both
+	# sysname and nodename.
+	echo i386-sequent-sysv4
+	exit 0 ;;
+    i*86:UNIX_SV:4.2MP:2.*)
+        # Unixware is an offshoot of SVR4, but it has its own version
+        # number series starting with 2...
+        # I am not positive that other SVR4 systems won't match this,
+	# I just have to hope.  -- rms.
+        # Use sysv4.2uw... so that sysv4* matches it.
+	echo ${UNAME_MACHINE}-pc-sysv4.2uw${UNAME_VERSION}
+	exit 0 ;;
+    i*86:OS/2:*:*)
+	# If we were able to find `uname', then EMX Unix compatibility
+	# is probably installed.
+	echo ${UNAME_MACHINE}-pc-os2-emx
+	exit 0 ;;
+    i*86:XTS-300:*:STOP)
+	echo ${UNAME_MACHINE}-unknown-stop
+	exit 0 ;;
+    i*86:atheos:*:*)
+	echo ${UNAME_MACHINE}-unknown-atheos
+	exit 0 ;;
+	i*86:syllable:*:*)
+	echo ${UNAME_MACHINE}-pc-syllable
+	exit 0 ;;
+    i*86:LynxOS:2.*:* | i*86:LynxOS:3.[01]*:* | i*86:LynxOS:4.0*:*)
+	echo i386-unknown-lynxos${UNAME_RELEASE}
+	exit 0 ;;
+    i*86:*DOS:*:*)
+	echo ${UNAME_MACHINE}-pc-msdosdjgpp
+	exit 0 ;;
+    i*86:*:4.*:* | i*86:SYSTEM_V:4.*:*)
+	UNAME_REL=`echo ${UNAME_RELEASE} | sed 's/\/MP$//'`
+	if grep Novell /usr/include/link.h >/dev/null 2>/dev/null; then
+		echo ${UNAME_MACHINE}-univel-sysv${UNAME_REL}
+	else
+		echo ${UNAME_MACHINE}-pc-sysv${UNAME_REL}
+	fi
+	exit 0 ;;
+    i*86:*:5:[78]*)
+	case `/bin/uname -X | grep "^Machine"` in
+	    *486*)	     UNAME_MACHINE=i486 ;;
+	    *Pentium)	     UNAME_MACHINE=i586 ;;
+	    *Pent*|*Celeron) UNAME_MACHINE=i686 ;;
+	esac
+	echo ${UNAME_MACHINE}-unknown-sysv${UNAME_RELEASE}${UNAME_SYSTEM}${UNAME_VERSION}
+	exit 0 ;;
+    i*86:*:3.2:*)
+	if test -f /usr/options/cb.name; then
+		UNAME_REL=`sed -n 's/.*Version //p' </usr/options/cb.name`
+		echo ${UNAME_MACHINE}-pc-isc$UNAME_REL
+	elif /bin/uname -X 2>/dev/null >/dev/null ; then
+		UNAME_REL=`(/bin/uname -X|grep Release|sed -e 's/.*= //')`
+		(/bin/uname -X|grep i80486 >/dev/null) && UNAME_MACHINE=i486
+		(/bin/uname -X|grep '^Machine.*Pentium' >/dev/null) \
+			&& UNAME_MACHINE=i586
+		(/bin/uname -X|grep '^Machine.*Pent *II' >/dev/null) \
+			&& UNAME_MACHINE=i686
+		(/bin/uname -X|grep '^Machine.*Pentium Pro' >/dev/null) \
+			&& UNAME_MACHINE=i686
+		echo ${UNAME_MACHINE}-pc-sco$UNAME_REL
+	else
+		echo ${UNAME_MACHINE}-pc-sysv32
+	fi
+	exit 0 ;;
+    pc:*:*:*)
+	# Left here for compatibility:
+        # uname -m prints for DJGPP always 'pc', but it prints nothing about
+        # the processor, so we play safe by assuming i386.
+	echo i386-pc-msdosdjgpp
+        exit 0 ;;
+    Intel:Mach:3*:*)
+	echo i386-pc-mach3
+	exit 0 ;;
+    paragon:*:*:*)
+	echo i860-intel-osf1
+	exit 0 ;;
+    i860:*:4.*:*) # i860-SVR4
+	if grep Stardent /usr/include/sys/uadmin.h >/dev/null 2>&1 ; then
+	  echo i860-stardent-sysv${UNAME_RELEASE} # Stardent Vistra i860-SVR4
+	else # Add other i860-SVR4 vendors below as they are discovered.
+	  echo i860-unknown-sysv${UNAME_RELEASE}  # Unknown i860-SVR4
+	fi
+	exit 0 ;;
+    mini*:CTIX:SYS*5:*)
+	# "miniframe"
+	echo m68010-convergent-sysv
+	exit 0 ;;
+    mc68k:UNIX:SYSTEM5:3.51m)
+	echo m68k-convergent-sysv
+	exit 0 ;;
+    M680?0:D-NIX:5.3:*)
+	echo m68k-diab-dnix
+	exit 0 ;;
+    M68*:*:R3V[5678]*:*)
+	test -r /sysV68 && echo 'm68k-motorola-sysv' && exit 0 ;;
+    3[345]??:*:4.0:3.0 | 3[34]??A:*:4.0:3.0 | 3[34]??,*:*:4.0:3.0 | 3[34]??/*:*:4.0:3.0 | 4400:*:4.0:3.0 | 4850:*:4.0:3.0 | SKA40:*:4.0:3.0 | SDS2:*:4.0:3.0 | SHG2:*:4.0:3.0)
+	OS_REL=''
+	test -r /etc/.relid \
+	&& OS_REL=.`sed -n 's/[^ ]* [^ ]* \([0-9][0-9]\).*/\1/p' < /etc/.relid`
+	/bin/uname -p 2>/dev/null | grep 86 >/dev/null \
+	  && echo i486-ncr-sysv4.3${OS_REL} && exit 0
+	/bin/uname -p 2>/dev/null | /bin/grep entium >/dev/null \
+	  && echo i586-ncr-sysv4.3${OS_REL} && exit 0 ;;
+    3[34]??:*:4.0:* | 3[34]??,*:*:4.0:*)
+        /bin/uname -p 2>/dev/null | grep 86 >/dev/null \
+          && echo i486-ncr-sysv4 && exit 0 ;;
+    m68*:LynxOS:2.*:* | m68*:LynxOS:3.0*:*)
+	echo m68k-unknown-lynxos${UNAME_RELEASE}
+	exit 0 ;;
+    mc68030:UNIX_System_V:4.*:*)
+	echo m68k-atari-sysv4
+	exit 0 ;;
+    TSUNAMI:LynxOS:2.*:*)
+	echo sparc-unknown-lynxos${UNAME_RELEASE}
+	exit 0 ;;
+    rs6000:LynxOS:2.*:*)
+	echo rs6000-unknown-lynxos${UNAME_RELEASE}
+	exit 0 ;;
+    PowerPC:LynxOS:2.*:* | PowerPC:LynxOS:3.[01]*:* | PowerPC:LynxOS:4.0*:*)
+	echo powerpc-unknown-lynxos${UNAME_RELEASE}
+	exit 0 ;;
+    SM[BE]S:UNIX_SV:*:*)
+	echo mips-dde-sysv${UNAME_RELEASE}
+	exit 0 ;;
+    RM*:ReliantUNIX-*:*:*)
+	echo mips-sni-sysv4
+	exit 0 ;;
+    RM*:SINIX-*:*:*)
+	echo mips-sni-sysv4
+	exit 0 ;;
+    *:SINIX-*:*:*)
+	if uname -p 2>/dev/null >/dev/null ; then
+		UNAME_MACHINE=`(uname -p) 2>/dev/null`
+		echo ${UNAME_MACHINE}-sni-sysv4
+	else
+		echo ns32k-sni-sysv
+	fi
+	exit 0 ;;
+    PENTIUM:*:4.0*:*) # Unisys `ClearPath HMP IX 4000' SVR4/MP effort
+                      # says <Richard.M.Bartel@ccMail.Census.GOV>
+        echo i586-unisys-sysv4
+        exit 0 ;;
+    *:UNIX_System_V:4*:FTX*)
+	# From Gerald Hewes <hewes@openmarket.com>.
+	# How about differentiating between stratus architectures? -djm
+	echo hppa1.1-stratus-sysv4
+	exit 0 ;;
+    *:*:*:FTX*)
+	# From seanf@swdc.stratus.com.
+	echo i860-stratus-sysv4
+	exit 0 ;;
+    *:VOS:*:*)
+	# From Paul.Green@stratus.com.
+	echo hppa1.1-stratus-vos
+	exit 0 ;;
+    mc68*:A/UX:*:*)
+	echo m68k-apple-aux${UNAME_RELEASE}
+	exit 0 ;;
+    news*:NEWS-OS:6*:*)
+	echo mips-sony-newsos6
+	exit 0 ;;
+    R[34]000:*System_V*:*:* | R4000:UNIX_SYSV:*:* | R*000:UNIX_SV:*:*)
+	if [ -d /usr/nec ]; then
+	        echo mips-nec-sysv${UNAME_RELEASE}
+	else
+	        echo mips-unknown-sysv${UNAME_RELEASE}
+	fi
+        exit 0 ;;
+    BeBox:BeOS:*:*)	# BeOS running on hardware made by Be, PPC only.
+	echo powerpc-be-beos
+	exit 0 ;;
+    BeMac:BeOS:*:*)	# BeOS running on Mac or Mac clone, PPC only.
+	echo powerpc-apple-beos
+	exit 0 ;;
+    BePC:BeOS:*:*)	# BeOS running on Intel PC compatible.
+	echo i586-pc-beos
+	exit 0 ;;
+    SX-4:SUPER-UX:*:*)
+	echo sx4-nec-superux${UNAME_RELEASE}
+	exit 0 ;;
+    SX-5:SUPER-UX:*:*)
+	echo sx5-nec-superux${UNAME_RELEASE}
+	exit 0 ;;
+    SX-6:SUPER-UX:*:*)
+	echo sx6-nec-superux${UNAME_RELEASE}
+	exit 0 ;;
+    Power*:Rhapsody:*:*)
+	echo powerpc-apple-rhapsody${UNAME_RELEASE}
+	exit 0 ;;
+    *:Rhapsody:*:*)
+	echo ${UNAME_MACHINE}-apple-rhapsody${UNAME_RELEASE}
+	exit 0 ;;
+    *:Darwin:*:*)
+	case `uname -p` in
+	    *86) UNAME_PROCESSOR=i686 ;;
+	    powerpc) UNAME_PROCESSOR=powerpc ;;
+	esac
+	echo ${UNAME_PROCESSOR}-apple-darwin${UNAME_RELEASE}
+	exit 0 ;;
+    *:procnto*:*:* | *:QNX:[0123456789]*:*)
+	UNAME_PROCESSOR=`uname -p`
+	if test "$UNAME_PROCESSOR" = "x86"; then
+		UNAME_PROCESSOR=i386
+		UNAME_MACHINE=pc
+	fi
+	echo ${UNAME_PROCESSOR}-${UNAME_MACHINE}-nto-qnx${UNAME_RELEASE}
+	exit 0 ;;
+    *:QNX:*:4*)
+	echo i386-pc-qnx
+	exit 0 ;;
+    NSR-?:NONSTOP_KERNEL:*:*)
+	echo nsr-tandem-nsk${UNAME_RELEASE}
+	exit 0 ;;
+    *:NonStop-UX:*:*)
+	echo mips-compaq-nonstopux
+	exit 0 ;;
+    BS2000:POSIX*:*:*)
+	echo bs2000-siemens-sysv
+	exit 0 ;;
+    DS/*:UNIX_System_V:*:*)
+	echo ${UNAME_MACHINE}-${UNAME_SYSTEM}-${UNAME_RELEASE}
+	exit 0 ;;
+    *:Plan9:*:*)
+	# "uname -m" is not consistent, so use $cputype instead. 386
+	# is converted to i386 for consistency with other x86
+	# operating systems.
+	if test "$cputype" = "386"; then
+	    UNAME_MACHINE=i386
+	else
+	    UNAME_MACHINE="$cputype"
+	fi
+	echo ${UNAME_MACHINE}-unknown-plan9
+	exit 0 ;;
+    *:TOPS-10:*:*)
+	echo pdp10-unknown-tops10
+	exit 0 ;;
+    *:TENEX:*:*)
+	echo pdp10-unknown-tenex
+	exit 0 ;;
+    KS10:TOPS-20:*:* | KL10:TOPS-20:*:* | TYPE4:TOPS-20:*:*)
+	echo pdp10-dec-tops20
+	exit 0 ;;
+    XKL-1:TOPS-20:*:* | TYPE5:TOPS-20:*:*)
+	echo pdp10-xkl-tops20
+	exit 0 ;;
+    *:TOPS-20:*:*)
+	echo pdp10-unknown-tops20
+	exit 0 ;;
+    *:ITS:*:*)
+	echo pdp10-unknown-its
+	exit 0 ;;
+    SEI:*:*:SEIUX)
+        echo mips-sei-seiux${UNAME_RELEASE}
+	exit 0 ;;
+    *:DragonFly:*:*)
+	echo ${UNAME_MACHINE}-unknown-dragonfly`echo ${UNAME_RELEASE}|sed -e 's/[-(].*//'`
+	exit 0 ;;
+esac
+
+#echo '(No uname command or uname output not recognized.)' 1>&2
+#echo "${UNAME_MACHINE}:${UNAME_SYSTEM}:${UNAME_RELEASE}:${UNAME_VERSION}" 1>&2
+
+eval $set_cc_for_build
+cat >$dummy.c <<EOF
+#ifdef _SEQUENT_
+# include <sys/types.h>
+# include <sys/utsname.h>
+#endif
+main ()
+{
+#if defined (sony)
+#if defined (MIPSEB)
+  /* BFD wants "bsd" instead of "newsos".  Perhaps BFD should be changed,
+     I don't know....  */
+  printf ("mips-sony-bsd\n"); exit (0);
+#else
+#include <sys/param.h>
+  printf ("m68k-sony-newsos%s\n",
+#ifdef NEWSOS4
+          "4"
+#else
+	  ""
+#endif
+         ); exit (0);
+#endif
+#endif
+
+#if defined (__arm) && defined (__acorn) && defined (__unix)
+  printf ("arm-acorn-riscix"); exit (0);
+#endif
+
+#if defined (hp300) && !defined (hpux)
+  printf ("m68k-hp-bsd\n"); exit (0);
+#endif
+
+#if defined (NeXT)
+#if !defined (__ARCHITECTURE__)
+#define __ARCHITECTURE__ "m68k"
+#endif
+  int version;
+  version=`(hostinfo | sed -n 's/.*NeXT Mach \([0-9]*\).*/\1/p') 2>/dev/null`;
+  if (version < 4)
+    printf ("%s-next-nextstep%d\n", __ARCHITECTURE__, version);
+  else
+    printf ("%s-next-openstep%d\n", __ARCHITECTURE__, version);
+  exit (0);
+#endif
+
+#if defined (MULTIMAX) || defined (n16)
+#if defined (UMAXV)
+  printf ("ns32k-encore-sysv\n"); exit (0);
+#else
+#if defined (CMU)
+  printf ("ns32k-encore-mach\n"); exit (0);
+#else
+  printf ("ns32k-encore-bsd\n"); exit (0);
+#endif
+#endif
+#endif
+
+#if defined (__386BSD__)
+  printf ("i386-pc-bsd\n"); exit (0);
+#endif
+
+#if defined (sequent)
+#if defined (i386)
+  printf ("i386-sequent-dynix\n"); exit (0);
+#endif
+#if defined (ns32000)
+  printf ("ns32k-sequent-dynix\n"); exit (0);
+#endif
+#endif
+
+#if defined (_SEQUENT_)
+    struct utsname un;
+
+    uname(&un);
+
+    if (strncmp(un.version, "V2", 2) == 0) {
+	printf ("i386-sequent-ptx2\n"); exit (0);
+    }
+    if (strncmp(un.version, "V1", 2) == 0) { /* XXX is V1 correct? */
+	printf ("i386-sequent-ptx1\n"); exit (0);
+    }
+    printf ("i386-sequent-ptx\n"); exit (0);
+
+#endif
+
+#if defined (vax)
+# if !defined (ultrix)
+#  include <sys/param.h>
+#  if defined (BSD)
+#   if BSD == 43
+      printf ("vax-dec-bsd4.3\n"); exit (0);
+#   else
+#    if BSD == 199006
+      printf ("vax-dec-bsd4.3reno\n"); exit (0);
+#    else
+      printf ("vax-dec-bsd\n"); exit (0);
+#    endif
+#   endif
+#  else
+    printf ("vax-dec-bsd\n"); exit (0);
+#  endif
+# else
+    printf ("vax-dec-ultrix\n"); exit (0);
+# endif
+#endif
+
+#if defined (alliant) && defined (i860)
+  printf ("i860-alliant-bsd\n"); exit (0);
+#endif
+
+  exit (1);
+}
+EOF
+
+$CC_FOR_BUILD -o $dummy $dummy.c 2>/dev/null && $dummy && exit 0
+
+# Apollos put the system type in the environment.
+
+test -d /usr/apollo && { echo ${ISP}-apollo-${SYSTYPE}; exit 0; }
+
+# Convex versions that predate uname can use getsysinfo(1)
+
+if [ -x /usr/convex/getsysinfo ]
+then
+    case `getsysinfo -f cpu_type` in
+    c1*)
+	echo c1-convex-bsd
+	exit 0 ;;
+    c2*)
+	if getsysinfo -f scalar_acc
+	then echo c32-convex-bsd
+	else echo c2-convex-bsd
+	fi
+	exit 0 ;;
+    c34*)
+	echo c34-convex-bsd
+	exit 0 ;;
+    c38*)
+	echo c38-convex-bsd
+	exit 0 ;;
+    c4*)
+	echo c4-convex-bsd
+	exit 0 ;;
+    esac
+fi
+
+cat >&2 <<EOF
+$0: unable to guess system type
+
+This script, last modified $timestamp, has failed to recognize
+the operating system you are using. It is advised that you
+download the most up to date version of the config scripts from
+
+    ftp://ftp.gnu.org/pub/gnu/config/
+
+If the version you run ($0) is already up to date, please
+send the following data and any information you think might be
+pertinent to <config-patches@gnu.org> in order to provide the needed
+information to handle your system.
+
+config.guess timestamp = $timestamp
+
+uname -m = `(uname -m) 2>/dev/null || echo unknown`
+uname -r = `(uname -r) 2>/dev/null || echo unknown`
+uname -s = `(uname -s) 2>/dev/null || echo unknown`
+uname -v = `(uname -v) 2>/dev/null || echo unknown`
+
+/usr/bin/uname -p = `(/usr/bin/uname -p) 2>/dev/null`
+/bin/uname -X     = `(/bin/uname -X) 2>/dev/null`
+
+hostinfo               = `(hostinfo) 2>/dev/null`
+/bin/universe          = `(/bin/universe) 2>/dev/null`
+/usr/bin/arch -k       = `(/usr/bin/arch -k) 2>/dev/null`
+/bin/arch              = `(/bin/arch) 2>/dev/null`
+/usr/bin/oslevel       = `(/usr/bin/oslevel) 2>/dev/null`
+/usr/convex/getsysinfo = `(/usr/convex/getsysinfo) 2>/dev/null`
+
+UNAME_MACHINE = ${UNAME_MACHINE}
+UNAME_RELEASE = ${UNAME_RELEASE}
+UNAME_SYSTEM  = ${UNAME_SYSTEM}
+UNAME_VERSION = ${UNAME_VERSION}
+EOF
+
+exit 1
+
+# Local variables:
+# eval: (add-hook 'write-file-hooks 'time-stamp)
+# time-stamp-start: "timestamp='"
+# time-stamp-format: "%:y-%02m-%02d"
+# time-stamp-end: "'"
+# End:
diff -ruN povray-3.6.1/libraries/tiff/libtiff/config.h.in povray-3.6.1-config-0.2.0/libraries/tiff/libtiff/config.h.in
--- povray-3.6.1/libraries/tiff/libtiff/config.h.in	1970-01-01 01:00:00.000000000 +0100
+++ povray-3.6.1-config-0.2.0/libraries/tiff/libtiff/config.h.in	2005-08-03 20:26:36.000000000 +0200
@@ -0,0 +1,136 @@
+/* config.h.in.  Generated from configure.ac by autoheader.  */
+
+/* Define to 1 if you don't have `vprintf' but do have `_doprnt.' */
+#undef HAVE_DOPRNT
+
+/* Define to 1 if you have the <fcntl.h> header file. */
+#undef HAVE_FCNTL_H
+
+/* Define to 1 if you have the `floor' function. */
+#undef HAVE_FLOOR
+
+/* Define to 1 if you have the `getopt' function. */
+#undef HAVE_GETOPT
+
+/* Define to 1 if you have the `getpagesize' function. */
+#undef HAVE_GETPAGESIZE
+
+/* Define to 1 if you have the <inttypes.h> header file. */
+#undef HAVE_INTTYPES_H
+
+/* Define to 1 if you have the `m' library (-lm). */
+#undef HAVE_LIBM
+
+/* Define to 1 if your system has a GNU libc compatible `malloc' function, and
+   to 0 otherwise. */
+#undef HAVE_MALLOC
+
+/* Define to 1 if you have the <malloc.h> header file. */
+#undef HAVE_MALLOC_H
+
+/* Define to 1 if you have the `memmove' function. */
+#undef HAVE_MEMMOVE
+
+/* Define to 1 if you have the <memory.h> header file. */
+#undef HAVE_MEMORY_H
+
+/* Define to 1 if you have the `memset' function. */
+#undef HAVE_MEMSET
+
+/* Define to 1 if you have a working `mmap' system call. */
+#undef HAVE_MMAP
+
+/* Define to 1 if you have the `munmap' function. */
+#undef HAVE_MUNMAP
+
+/* Define to 1 if you have the `pow' function. */
+#undef HAVE_POW
+
+/* Define to 1 if your system has a GNU libc compatible `realloc' function,
+   and to 0 otherwise. */
+#undef HAVE_REALLOC
+
+/* Define to 1 if you have the `sqrt' function. */
+#undef HAVE_SQRT
+
+/* Define to 1 if you have the <stdint.h> header file. */
+#undef HAVE_STDINT_H
+
+/* Define to 1 if you have the <stdlib.h> header file. */
+#undef HAVE_STDLIB_H
+
+/* Define to 1 if you have the `strchr' function. */
+#undef HAVE_STRCHR
+
+/* Define to 1 if you have the <strings.h> header file. */
+#undef HAVE_STRINGS_H
+
+/* Define to 1 if you have the <string.h> header file. */
+#undef HAVE_STRING_H
+
+/* Define to 1 if you have the `strstr' function. */
+#undef HAVE_STRSTR
+
+/* Define to 1 if you have the <sys/stat.h> header file. */
+#undef HAVE_SYS_STAT_H
+
+/* Define to 1 if you have the <sys/types.h> header file. */
+#undef HAVE_SYS_TYPES_H
+
+/* Define to 1 if you have the <unistd.h> header file. */
+#undef HAVE_UNISTD_H
+
+/* Define to 1 if you have the `vprintf' function. */
+#undef HAVE_VPRINTF
+
+/* What keyword the C compiler supports for inlining. */
+#undef INLINE
+
+/* Name of package */
+#undef PACKAGE
+
+/* Define to the address where bug reports for this package should be sent. */
+#undef PACKAGE_BUGREPORT
+
+/* Define to the full name of this package. */
+#undef PACKAGE_NAME
+
+/* Define to the full name and version of this package. */
+#undef PACKAGE_STRING
+
+/* Define to the one symbol short name of this package. */
+#undef PACKAGE_TARNAME
+
+/* Define to the version of this package. */
+#undef PACKAGE_VERSION
+
+/* Define to 1 if you have the ANSI C header files. */
+#undef STDC_HEADERS
+
+/* Version number of package */
+#undef VERSION
+
+/* Define to 1 if your processor stores words with the most significant byte
+   first (like Motorola and SPARC, unlike Intel and VAX). */
+#undef WORDS_BIGENDIAN
+
+/* Define to empty if `const' does not conform to ANSI C. */
+#undef const
+
+/* Define to `__inline__' or `__inline' if that's what the C compiler
+   calls it, or to nothing if 'inline' is not supported under any name.  */
+#ifndef __cplusplus
+#undef inline
+#endif
+
+/* Define to rpl_malloc if the replacement function should be used. */
+#undef malloc
+
+/* Define to `long' if <sys/types.h> does not define. */
+#undef off_t
+
+/* Define to rpl_realloc if the replacement function should be used. */
+#undef realloc
+
+/* Define to `unsigned' if <sys/types.h> does not define. */
+#undef size_t
diff -ruN povray-3.6.1/libraries/tiff/libtiff/config.sub povray-3.6.1-config-0.2.0/libraries/tiff/libtiff/config.sub
--- povray-3.6.1/libraries/tiff/libtiff/config.sub	1970-01-01 01:00:00.000000000 +0100
+++ povray-3.6.1-config-0.2.0/libraries/tiff/libtiff/config.sub	2005-08-03 20:25:48.000000000 +0200
@@ -0,0 +1,1549 @@
+#! /bin/sh
+# Configuration validation subroutine script.
+#   Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999,
+#   2000, 2001, 2002, 2003 Free Software Foundation, Inc.
+
+timestamp='2004-03-12'
+
+# This file is (in principle) common to ALL GNU software.
+# The presence of a machine in this file suggests that SOME GNU software
+# can handle that machine.  It does not imply ALL GNU software can.
+#
+# This file is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330,
+# Boston, MA 02111-1307, USA.
+
+# As a special exception to the GNU General Public License, if you
+# distribute this file as part of a program that contains a
+# configuration script generated by Autoconf, you may include it under
+# the same distribution terms that you use for the rest of that program.
+
+# Please send patches to <config-patches@gnu.org>.  Submit a context
+# diff and a properly formatted ChangeLog entry.
+#
+# Configuration subroutine to validate and canonicalize a configuration type.
+# Supply the specified configuration type as an argument.
+# If it is invalid, we print an error message on stderr and exit with code 1.
+# Otherwise, we print the canonical config type on stdout and succeed.
+
+# This file is supposed to be the same for all GNU packages
+# and recognize all the CPU types, system types and aliases
+# that are meaningful with *any* GNU software.
+# Each package is responsible for reporting which valid configurations
+# it does not support.  The user should be able to distinguish
+# a failure to support a valid configuration from a meaningless
+# configuration.
+
+# The goal of this file is to map all the various variations of a given
+# machine specification into a single specification in the form:
+#	CPU_TYPE-MANUFACTURER-OPERATING_SYSTEM
+# or in some cases, the newer four-part form:
+#	CPU_TYPE-MANUFACTURER-KERNEL-OPERATING_SYSTEM
+# It is wrong to echo any other type of specification.
+
+me=`echo "$0" | sed -e 's,.*/,,'`
+
+usage="\
+Usage: $0 [OPTION] CPU-MFR-OPSYS
+       $0 [OPTION] ALIAS
+
+Canonicalize a configuration name.
+
+Operation modes:
+  -h, --help         print this help, then exit
+  -t, --time-stamp   print date of last modification, then exit
+  -v, --version      print version number, then exit
+
+Report bugs and patches to <config-patches@gnu.org>."
+
+version="\
+GNU config.sub ($timestamp)
+
+Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001
+Free Software Foundation, Inc.
+
+This is free software; see the source for copying conditions.  There is NO
+warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE."
+
+help="
+Try \`$me --help' for more information."
+
+# Parse command line
+while test $# -gt 0 ; do
+  case $1 in
+    --time-stamp | --time* | -t )
+       echo "$timestamp" ; exit 0 ;;
+    --version | -v )
+       echo "$version" ; exit 0 ;;
+    --help | --h* | -h )
+       echo "$usage"; exit 0 ;;
+    -- )     # Stop option processing
+       shift; break ;;
+    - )	# Use stdin as input.
+       break ;;
+    -* )
+       echo "$me: invalid option $1$help"
+       exit 1 ;;
+
+    *local*)
+       # First pass through any local machine types.
+       echo $1
+       exit 0;;
+
+    * )
+       break ;;
+  esac
+done
+
+case $# in
+ 0) echo "$me: missing argument$help" >&2
+    exit 1;;
+ 1) ;;
+ *) echo "$me: too many arguments$help" >&2
+    exit 1;;
+esac
+
+# Separate what the user gave into CPU-COMPANY and OS or KERNEL-OS (if any).
+# Here we must recognize all the valid KERNEL-OS combinations.
+maybe_os=`echo $1 | sed 's/^\(.*\)-\([^-]*-[^-]*\)$/\2/'`
+case $maybe_os in
+  nto-qnx* | linux-gnu* | linux-dietlibc | linux-uclibc* | uclinux-uclibc* | uclinux-gnu* | \
+  kfreebsd*-gnu* | knetbsd*-gnu* | netbsd*-gnu* | storm-chaos* | os2-emx* | rtmk-nova*)
+    os=-$maybe_os
+    basic_machine=`echo $1 | sed 's/^\(.*\)-\([^-]*-[^-]*\)$/\1/'`
+    ;;
+  *)
+    basic_machine=`echo $1 | sed 's/-[^-]*$//'`
+    if [ $basic_machine != $1 ]
+    then os=`echo $1 | sed 's/.*-/-/'`
+    else os=; fi
+    ;;
+esac
+
+### Let's recognize common machines as not being operating systems so
+### that things like config.sub decstation-3100 work.  We also
+### recognize some manufacturers as not being operating systems, so we
+### can provide default operating systems below.
+case $os in
+	-sun*os*)
+		# Prevent following clause from handling this invalid input.
+		;;
+	-dec* | -mips* | -sequent* | -encore* | -pc532* | -sgi* | -sony* | \
+	-att* | -7300* | -3300* | -delta* | -motorola* | -sun[234]* | \
+	-unicom* | -ibm* | -next | -hp | -isi* | -apollo | -altos* | \
+	-convergent* | -ncr* | -news | -32* | -3600* | -3100* | -hitachi* |\
+	-c[123]* | -convex* | -sun | -crds | -omron* | -dg | -ultra | -tti* | \
+	-harris | -dolphin | -highlevel | -gould | -cbm | -ns | -masscomp | \
+	-apple | -axis)
+		os=
+		basic_machine=$1
+		;;
+	-sim | -cisco | -oki | -wec | -winbond)
+		os=
+		basic_machine=$1
+		;;
+	-scout)
+		;;
+	-wrs)
+		os=-vxworks
+		basic_machine=$1
+		;;
+	-chorusos*)
+		os=-chorusos
+		basic_machine=$1
+		;;
+ 	-chorusrdb)
+ 		os=-chorusrdb
+		basic_machine=$1
+ 		;;
+	-hiux*)
+		os=-hiuxwe2
+		;;
+	-sco5)
+		os=-sco3.2v5
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
+	-sco4)
+		os=-sco3.2v4
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
+	-sco3.2.[4-9]*)
+		os=`echo $os | sed -e 's/sco3.2./sco3.2v/'`
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
+	-sco3.2v[4-9]*)
+		# Don't forget version if it is 3.2v4 or newer.
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
+	-sco*)
+		os=-sco3.2v2
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
+	-udk*)
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
+	-isc)
+		os=-isc2.2
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
+	-clix*)
+		basic_machine=clipper-intergraph
+		;;
+	-isc*)
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
+	-lynx*)
+		os=-lynxos
+		;;
+	-ptx*)
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-sequent/'`
+		;;
+	-windowsnt*)
+		os=`echo $os | sed -e 's/windowsnt/winnt/'`
+		;;
+	-psos*)
+		os=-psos
+		;;
+	-mint | -mint[0-9]*)
+		basic_machine=m68k-atari
+		os=-mint
+		;;
+esac
+
+# Decode aliases for certain CPU-COMPANY combinations.
+case $basic_machine in
+	# Recognize the basic CPU types without company name.
+	# Some are omitted here because they have special meanings below.
+	1750a | 580 \
+	| a29k \
+	| alpha | alphaev[4-8] | alphaev56 | alphaev6[78] | alphapca5[67] \
+	| alpha64 | alpha64ev[4-8] | alpha64ev56 | alpha64ev6[78] | alpha64pca5[67] \
+	| am33_2.0 \
+	| arc | arm | arm[bl]e | arme[lb] | armv[2345] | armv[345][lb] | avr \
+	| c4x | clipper \
+	| d10v | d30v | dlx | dsp16xx \
+	| fr30 | frv \
+	| h8300 | h8500 | hppa | hppa1.[01] | hppa2.0 | hppa2.0[nw] | hppa64 \
+	| i370 | i860 | i960 | ia64 \
+	| ip2k | iq2000 \
+	| m32r | m32rle | m68000 | m68k | m88k | mcore \
+	| mips | mipsbe | mipseb | mipsel | mipsle \
+	| mips16 \
+	| mips64 | mips64el \
+	| mips64vr | mips64vrel \
+	| mips64orion | mips64orionel \
+	| mips64vr4100 | mips64vr4100el \
+	| mips64vr4300 | mips64vr4300el \
+	| mips64vr5000 | mips64vr5000el \
+	| mipsisa32 | mipsisa32el \
+	| mipsisa32r2 | mipsisa32r2el \
+	| mipsisa64 | mipsisa64el \
+	| mipsisa64r2 | mipsisa64r2el \
+	| mipsisa64sb1 | mipsisa64sb1el \
+	| mipsisa64sr71k | mipsisa64sr71kel \
+	| mipstx39 | mipstx39el \
+	| mn10200 | mn10300 \
+	| msp430 \
+	| ns16k | ns32k \
+	| openrisc | or32 \
+	| pdp10 | pdp11 | pj | pjl \
+	| powerpc | powerpc64 | powerpc64le | powerpcle | ppcbe \
+	| pyramid \
+	| sh | sh[1234] | sh[23]e | sh[34]eb | shbe | shle | sh[1234]le | sh3ele \
+	| sh64 | sh64le \
+	| sparc | sparc64 | sparc86x | sparclet | sparclite | sparcv8 | sparcv9 | sparcv9b \
+	| strongarm \
+	| tahoe | thumb | tic4x | tic80 | tron \
+	| v850 | v850e \
+	| we32k \
+	| x86 | xscale | xstormy16 | xtensa \
+	| z8k)
+		basic_machine=$basic_machine-unknown
+		;;
+	m6811 | m68hc11 | m6812 | m68hc12)
+		# Motorola 68HC11/12.
+		basic_machine=$basic_machine-unknown
+		os=-none
+		;;
+	m88110 | m680[12346]0 | m683?2 | m68360 | m5200 | v70 | w65 | z8k)
+		;;
+
+	# We use `pc' rather than `unknown'
+	# because (1) that's what they normally are, and
+	# (2) the word "unknown" tends to confuse beginning users.
+	i*86 | x86_64)
+	  basic_machine=$basic_machine-pc
+	  ;;
+	# Object if more than one company name word.
+	*-*-*)
+		echo Invalid configuration \`$1\': machine \`$basic_machine\' not recognized 1>&2
+		exit 1
+		;;
+	# Recognize the basic CPU types with company name.
+	580-* \
+	| a29k-* \
+	| alpha-* | alphaev[4-8]-* | alphaev56-* | alphaev6[78]-* \
+	| alpha64-* | alpha64ev[4-8]-* | alpha64ev56-* | alpha64ev6[78]-* \
+	| alphapca5[67]-* | alpha64pca5[67]-* | arc-* \
+	| arm-*  | armbe-* | armle-* | armeb-* | armv*-* \
+	| avr-* \
+	| bs2000-* \
+	| c[123]* | c30-* | [cjt]90-* | c4x-* | c54x-* | c55x-* | c6x-* \
+	| clipper-* | cydra-* \
+	| d10v-* | d30v-* | dlx-* \
+	| elxsi-* \
+	| f30[01]-* | f700-* | fr30-* | frv-* | fx80-* \
+	| h8300-* | h8500-* \
+	| hppa-* | hppa1.[01]-* | hppa2.0-* | hppa2.0[nw]-* | hppa64-* \
+	| i*86-* | i860-* | i960-* | ia64-* \
+	| ip2k-* | iq2000-* \
+	| m32r-* | m32rle-* \
+	| m68000-* | m680[012346]0-* | m68360-* | m683?2-* | m68k-* \
+	| m88110-* | m88k-* | mcore-* \
+	| mips-* | mipsbe-* | mipseb-* | mipsel-* | mipsle-* \
+	| mips16-* \
+	| mips64-* | mips64el-* \
+	| mips64vr-* | mips64vrel-* \
+	| mips64orion-* | mips64orionel-* \
+	| mips64vr4100-* | mips64vr4100el-* \
+	| mips64vr4300-* | mips64vr4300el-* \
+	| mips64vr5000-* | mips64vr5000el-* \
+	| mipsisa32-* | mipsisa32el-* \
+	| mipsisa32r2-* | mipsisa32r2el-* \
+	| mipsisa64-* | mipsisa64el-* \
+	| mipsisa64r2-* | mipsisa64r2el-* \
+	| mipsisa64sb1-* | mipsisa64sb1el-* \
+	| mipsisa64sr71k-* | mipsisa64sr71kel-* \
+	| mipstx39-* | mipstx39el-* \
+	| msp430-* \
+	| none-* | np1-* | nv1-* | ns16k-* | ns32k-* \
+	| orion-* \
+	| pdp10-* | pdp11-* | pj-* | pjl-* | pn-* | power-* \
+	| powerpc-* | powerpc64-* | powerpc64le-* | powerpcle-* | ppcbe-* \
+	| pyramid-* \
+	| romp-* | rs6000-* \
+	| sh-* | sh[1234]-* | sh[23]e-* | sh[34]eb-* | shbe-* \
+	| shle-* | sh[1234]le-* | sh3ele-* | sh64-* | sh64le-* \
+	| sparc-* | sparc64-* | sparc86x-* | sparclet-* | sparclite-* \
+	| sparcv8-* | sparcv9-* | sparcv9b-* | strongarm-* | sv1-* | sx?-* \
+	| tahoe-* | thumb-* \
+	| tic30-* | tic4x-* | tic54x-* | tic55x-* | tic6x-* | tic80-* \
+	| tron-* \
+	| v850-* | v850e-* | vax-* \
+	| we32k-* \
+	| x86-* | x86_64-* | xps100-* | xscale-* | xstormy16-* \
+	| xtensa-* \
+	| ymp-* \
+	| z8k-*)
+		;;
+	# Recognize the various machine names and aliases which stand
+	# for a CPU type and a company and sometimes even an OS.
+	386bsd)
+		basic_machine=i386-unknown
+		os=-bsd
+		;;
+	3b1 | 7300 | 7300-att | att-7300 | pc7300 | safari | unixpc)
+		basic_machine=m68000-att
+		;;
+	3b*)
+		basic_machine=we32k-att
+		;;
+	a29khif)
+		basic_machine=a29k-amd
+		os=-udi
+		;;
+    	abacus)
+		basic_machine=abacus-unknown
+		;;
+	adobe68k)
+		basic_machine=m68010-adobe
+		os=-scout
+		;;
+	alliant | fx80)
+		basic_machine=fx80-alliant
+		;;
+	altos | altos3068)
+		basic_machine=m68k-altos
+		;;
+	am29k)
+		basic_machine=a29k-none
+		os=-bsd
+		;;
+	amd64)
+		basic_machine=x86_64-pc
+		;;
+	amd64-*)
+		basic_machine=x86_64-`echo $basic_machine | sed 's/^[^-]*-//'`
+		;;
+	amdahl)
+		basic_machine=580-amdahl
+		os=-sysv
+		;;
+	amiga | amiga-*)
+		basic_machine=m68k-unknown
+		;;
+	amigaos | amigados)
+		basic_machine=m68k-unknown
+		os=-amigaos
+		;;
+	amigaunix | amix)
+		basic_machine=m68k-unknown
+		os=-sysv4
+		;;
+	apollo68)
+		basic_machine=m68k-apollo
+		os=-sysv
+		;;
+	apollo68bsd)
+		basic_machine=m68k-apollo
+		os=-bsd
+		;;
+	aux)
+		basic_machine=m68k-apple
+		os=-aux
+		;;
+	balance)
+		basic_machine=ns32k-sequent
+		os=-dynix
+		;;
+	c90)
+		basic_machine=c90-cray
+		os=-unicos
+		;;
+	convex-c1)
+		basic_machine=c1-convex
+		os=-bsd
+		;;
+	convex-c2)
+		basic_machine=c2-convex
+		os=-bsd
+		;;
+	convex-c32)
+		basic_machine=c32-convex
+		os=-bsd
+		;;
+	convex-c34)
+		basic_machine=c34-convex
+		os=-bsd
+		;;
+	convex-c38)
+		basic_machine=c38-convex
+		os=-bsd
+		;;
+	cray | j90)
+		basic_machine=j90-cray
+		os=-unicos
+		;;
+	cr16c)
+		basic_machine=cr16c-unknown
+		os=-elf
+		;;
+	crds | unos)
+		basic_machine=m68k-crds
+		;;
+	cris | cris-* | etrax*)
+		basic_machine=cris-axis
+		;;
+	crx)
+		basic_machine=crx-unknown
+		os=-elf
+		;;
+	da30 | da30-*)
+		basic_machine=m68k-da30
+		;;
+	decstation | decstation-3100 | pmax | pmax-* | pmin | dec3100 | decstatn)
+		basic_machine=mips-dec
+		;;
+	decsystem10* | dec10*)
+		basic_machine=pdp10-dec
+		os=-tops10
+		;;
+	decsystem20* | dec20*)
+		basic_machine=pdp10-dec
+		os=-tops20
+		;;
+	delta | 3300 | motorola-3300 | motorola-delta \
+	      | 3300-motorola | delta-motorola)
+		basic_machine=m68k-motorola
+		;;
+	delta88)
+		basic_machine=m88k-motorola
+		os=-sysv3
+		;;
+	dpx20 | dpx20-*)
+		basic_machine=rs6000-bull
+		os=-bosx
+		;;
+	dpx2* | dpx2*-bull)
+		basic_machine=m68k-bull
+		os=-sysv3
+		;;
+	ebmon29k)
+		basic_machine=a29k-amd
+		os=-ebmon
+		;;
+	elxsi)
+		basic_machine=elxsi-elxsi
+		os=-bsd
+		;;
+	encore | umax | mmax)
+		basic_machine=ns32k-encore
+		;;
+	es1800 | OSE68k | ose68k | ose | OSE)
+		basic_machine=m68k-ericsson
+		os=-ose
+		;;
+	fx2800)
+		basic_machine=i860-alliant
+		;;
+	genix)
+		basic_machine=ns32k-ns
+		;;
+	gmicro)
+		basic_machine=tron-gmicro
+		os=-sysv
+		;;
+	go32)
+		basic_machine=i386-pc
+		os=-go32
+		;;
+	h3050r* | hiux*)
+		basic_machine=hppa1.1-hitachi
+		os=-hiuxwe2
+		;;
+	h8300hms)
+		basic_machine=h8300-hitachi
+		os=-hms
+		;;
+	h8300xray)
+		basic_machine=h8300-hitachi
+		os=-xray
+		;;
+	h8500hms)
+		basic_machine=h8500-hitachi
+		os=-hms
+		;;
+	harris)
+		basic_machine=m88k-harris
+		os=-sysv3
+		;;
+	hp300-*)
+		basic_machine=m68k-hp
+		;;
+	hp300bsd)
+		basic_machine=m68k-hp
+		os=-bsd
+		;;
+	hp300hpux)
+		basic_machine=m68k-hp
+		os=-hpux
+		;;
+	hp3k9[0-9][0-9] | hp9[0-9][0-9])
+		basic_machine=hppa1.0-hp
+		;;
+	hp9k2[0-9][0-9] | hp9k31[0-9])
+		basic_machine=m68000-hp
+		;;
+	hp9k3[2-9][0-9])
+		basic_machine=m68k-hp
+		;;
+	hp9k6[0-9][0-9] | hp6[0-9][0-9])
+		basic_machine=hppa1.0-hp
+		;;
+	hp9k7[0-79][0-9] | hp7[0-79][0-9])
+		basic_machine=hppa1.1-hp
+		;;
+	hp9k78[0-9] | hp78[0-9])
+		# FIXME: really hppa2.0-hp
+		basic_machine=hppa1.1-hp
+		;;
+	hp9k8[67]1 | hp8[67]1 | hp9k80[24] | hp80[24] | hp9k8[78]9 | hp8[78]9 | hp9k893 | hp893)
+		# FIXME: really hppa2.0-hp
+		basic_machine=hppa1.1-hp
+		;;
+	hp9k8[0-9][13679] | hp8[0-9][13679])
+		basic_machine=hppa1.1-hp
+		;;
+	hp9k8[0-9][0-9] | hp8[0-9][0-9])
+		basic_machine=hppa1.0-hp
+		;;
+	hppa-next)
+		os=-nextstep3
+		;;
+	hppaosf)
+		basic_machine=hppa1.1-hp
+		os=-osf
+		;;
+	hppro)
+		basic_machine=hppa1.1-hp
+		os=-proelf
+		;;
+	i370-ibm* | ibm*)
+		basic_machine=i370-ibm
+		;;
+# I'm not sure what "Sysv32" means.  Should this be sysv3.2?
+	i*86v32)
+		basic_machine=`echo $1 | sed -e 's/86.*/86-pc/'`
+		os=-sysv32
+		;;
+	i*86v4*)
+		basic_machine=`echo $1 | sed -e 's/86.*/86-pc/'`
+		os=-sysv4
+		;;
+	i*86v)
+		basic_machine=`echo $1 | sed -e 's/86.*/86-pc/'`
+		os=-sysv
+		;;
+	i*86sol2)
+		basic_machine=`echo $1 | sed -e 's/86.*/86-pc/'`
+		os=-solaris2
+		;;
+	i386mach)
+		basic_machine=i386-mach
+		os=-mach
+		;;
+	i386-vsta | vsta)
+		basic_machine=i386-unknown
+		os=-vsta
+		;;
+	iris | iris4d)
+		basic_machine=mips-sgi
+		case $os in
+		    -irix*)
+			;;
+		    *)
+			os=-irix4
+			;;
+		esac
+		;;
+	isi68 | isi)
+		basic_machine=m68k-isi
+		os=-sysv
+		;;
+	m88k-omron*)
+		basic_machine=m88k-omron
+		;;
+	magnum | m3230)
+		basic_machine=mips-mips
+		os=-sysv
+		;;
+	merlin)
+		basic_machine=ns32k-utek
+		os=-sysv
+		;;
+	mingw32)
+		basic_machine=i386-pc
+		os=-mingw32
+		;;
+	miniframe)
+		basic_machine=m68000-convergent
+		;;
+	*mint | -mint[0-9]* | *MiNT | *MiNT[0-9]*)
+		basic_machine=m68k-atari
+		os=-mint
+		;;
+	mips3*-*)
+		basic_machine=`echo $basic_machine | sed -e 's/mips3/mips64/'`
+		;;
+	mips3*)
+		basic_machine=`echo $basic_machine | sed -e 's/mips3/mips64/'`-unknown
+		;;
+	mmix*)
+		basic_machine=mmix-knuth
+		os=-mmixware
+		;;
+	monitor)
+		basic_machine=m68k-rom68k
+		os=-coff
+		;;
+	morphos)
+		basic_machine=powerpc-unknown
+		os=-morphos
+		;;
+	msdos)
+		basic_machine=i386-pc
+		os=-msdos
+		;;
+	mvs)
+		basic_machine=i370-ibm
+		os=-mvs
+		;;
+	ncr3000)
+		basic_machine=i486-ncr
+		os=-sysv4
+		;;
+	netbsd386)
+		basic_machine=i386-unknown
+		os=-netbsd
+		;;
+	netwinder)
+		basic_machine=armv4l-rebel
+		os=-linux
+		;;
+	news | news700 | news800 | news900)
+		basic_machine=m68k-sony
+		os=-newsos
+		;;
+	news1000)
+		basic_machine=m68030-sony
+		os=-newsos
+		;;
+	news-3600 | risc-news)
+		basic_machine=mips-sony
+		os=-newsos
+		;;
+	necv70)
+		basic_machine=v70-nec
+		os=-sysv
+		;;
+	next | m*-next )
+		basic_machine=m68k-next
+		case $os in
+		    -nextstep* )
+			;;
+		    -ns2*)
+		      os=-nextstep2
+			;;
+		    *)
+		      os=-nextstep3
+			;;
+		esac
+		;;
+	nh3000)
+		basic_machine=m68k-harris
+		os=-cxux
+		;;
+	nh[45]000)
+		basic_machine=m88k-harris
+		os=-cxux
+		;;
+	nindy960)
+		basic_machine=i960-intel
+		os=-nindy
+		;;
+	mon960)
+		basic_machine=i960-intel
+		os=-mon960
+		;;
+	nonstopux)
+		basic_machine=mips-compaq
+		os=-nonstopux
+		;;
+	np1)
+		basic_machine=np1-gould
+		;;
+	nv1)
+		basic_machine=nv1-cray
+		os=-unicosmp
+		;;
+	nsr-tandem)
+		basic_machine=nsr-tandem
+		;;
+	op50n-* | op60c-*)
+		basic_machine=hppa1.1-oki
+		os=-proelf
+		;;
+	or32 | or32-*)
+		basic_machine=or32-unknown
+		os=-coff
+		;;
+	os400)
+		basic_machine=powerpc-ibm
+		os=-os400
+		;;
+	OSE68000 | ose68000)
+		basic_machine=m68000-ericsson
+		os=-ose
+		;;
+	os68k)
+		basic_machine=m68k-none
+		os=-os68k
+		;;
+	pa-hitachi)
+		basic_machine=hppa1.1-hitachi
+		os=-hiuxwe2
+		;;
+	paragon)
+		basic_machine=i860-intel
+		os=-osf
+		;;
+	pbd)
+		basic_machine=sparc-tti
+		;;
+	pbb)
+		basic_machine=m68k-tti
+		;;
+	pc532 | pc532-*)
+		basic_machine=ns32k-pc532
+		;;
+	pentium | p5 | k5 | k6 | nexgen | viac3)
+		basic_machine=i586-pc
+		;;
+	pentiumpro | p6 | 6x86 | athlon | athlon_*)
+		basic_machine=i686-pc
+		;;
+	pentiumii | pentium2 | pentiumiii | pentium3)
+		basic_machine=i686-pc
+		;;
+	pentium4)
+		basic_machine=i786-pc
+		;;
+	pentium-* | p5-* | k5-* | k6-* | nexgen-* | viac3-*)
+		basic_machine=i586-`echo $basic_machine | sed 's/^[^-]*-//'`
+		;;
+	pentiumpro-* | p6-* | 6x86-* | athlon-*)
+		basic_machine=i686-`echo $basic_machine | sed 's/^[^-]*-//'`
+		;;
+	pentiumii-* | pentium2-* | pentiumiii-* | pentium3-*)
+		basic_machine=i686-`echo $basic_machine | sed 's/^[^-]*-//'`
+		;;
+	pentium4-*)
+		basic_machine=i786-`echo $basic_machine | sed 's/^[^-]*-//'`
+		;;
+	pn)
+		basic_machine=pn-gould
+		;;
+	power)	basic_machine=power-ibm
+		;;
+	ppc)	basic_machine=powerpc-unknown
+		;;
+	ppc-*)	basic_machine=powerpc-`echo $basic_machine | sed 's/^[^-]*-//'`
+		;;
+	ppcle | powerpclittle | ppc-le | powerpc-little)
+		basic_machine=powerpcle-unknown
+		;;
+	ppcle-* | powerpclittle-*)
+		basic_machine=powerpcle-`echo $basic_machine | sed 's/^[^-]*-//'`
+		;;
+	ppc64)	basic_machine=powerpc64-unknown
+		;;
+	ppc64-*) basic_machine=powerpc64-`echo $basic_machine | sed 's/^[^-]*-//'`
+		;;
+	ppc64le | powerpc64little | ppc64-le | powerpc64-little)
+		basic_machine=powerpc64le-unknown
+		;;
+	ppc64le-* | powerpc64little-*)
+		basic_machine=powerpc64le-`echo $basic_machine | sed 's/^[^-]*-//'`
+		;;
+	ps2)
+		basic_machine=i386-ibm
+		;;
+	pw32)
+		basic_machine=i586-unknown
+		os=-pw32
+		;;
+	rom68k)
+		basic_machine=m68k-rom68k
+		os=-coff
+		;;
+	rm[46]00)
+		basic_machine=mips-siemens
+		;;
+	rtpc | rtpc-*)
+		basic_machine=romp-ibm
+		;;
+	s390 | s390-*)
+		basic_machine=s390-ibm
+		;;
+	s390x | s390x-*)
+		basic_machine=s390x-ibm
+		;;
+	sa29200)
+		basic_machine=a29k-amd
+		os=-udi
+		;;
+	sb1)
+		basic_machine=mipsisa64sb1-unknown
+		;;
+	sb1el)
+		basic_machine=mipsisa64sb1el-unknown
+		;;
+	sei)
+		basic_machine=mips-sei
+		os=-seiux
+		;;
+	sequent)
+		basic_machine=i386-sequent
+		;;
+	sh)
+		basic_machine=sh-hitachi
+		os=-hms
+		;;
+	sh64)
+		basic_machine=sh64-unknown
+		;;
+	sparclite-wrs | simso-wrs)
+		basic_machine=sparclite-wrs
+		os=-vxworks
+		;;
+	sps7)
+		basic_machine=m68k-bull
+		os=-sysv2
+		;;
+	spur)
+		basic_machine=spur-unknown
+		;;
+	st2000)
+		basic_machine=m68k-tandem
+		;;
+	stratus)
+		basic_machine=i860-stratus
+		os=-sysv4
+		;;
+	sun2)
+		basic_machine=m68000-sun
+		;;
+	sun2os3)
+		basic_machine=m68000-sun
+		os=-sunos3
+		;;
+	sun2os4)
+		basic_machine=m68000-sun
+		os=-sunos4
+		;;
+	sun3os3)
+		basic_machine=m68k-sun
+		os=-sunos3
+		;;
+	sun3os4)
+		basic_machine=m68k-sun
+		os=-sunos4
+		;;
+	sun4os3)
+		basic_machine=sparc-sun
+		os=-sunos3
+		;;
+	sun4os4)
+		basic_machine=sparc-sun
+		os=-sunos4
+		;;
+	sun4sol2)
+		basic_machine=sparc-sun
+		os=-solaris2
+		;;
+	sun3 | sun3-*)
+		basic_machine=m68k-sun
+		;;
+	sun4)
+		basic_machine=sparc-sun
+		;;
+	sun386 | sun386i | roadrunner)
+		basic_machine=i386-sun
+		;;
+	sv1)
+		basic_machine=sv1-cray
+		os=-unicos
+		;;
+	symmetry)
+		basic_machine=i386-sequent
+		os=-dynix
+		;;
+	t3e)
+		basic_machine=alphaev5-cray
+		os=-unicos
+		;;
+	t90)
+		basic_machine=t90-cray
+		os=-unicos
+		;;
+	tic54x | c54x*)
+		basic_machine=tic54x-unknown
+		os=-coff
+		;;
+	tic55x | c55x*)
+		basic_machine=tic55x-unknown
+		os=-coff
+		;;
+	tic6x | c6x*)
+		basic_machine=tic6x-unknown
+		os=-coff
+		;;
+	tx39)
+		basic_machine=mipstx39-unknown
+		;;
+	tx39el)
+		basic_machine=mipstx39el-unknown
+		;;
+	toad1)
+		basic_machine=pdp10-xkl
+		os=-tops20
+		;;
+	tower | tower-32)
+		basic_machine=m68k-ncr
+		;;
+	tpf)
+		basic_machine=s390x-ibm
+		os=-tpf
+		;;
+	udi29k)
+		basic_machine=a29k-amd
+		os=-udi
+		;;
+	ultra3)
+		basic_machine=a29k-nyu
+		os=-sym1
+		;;
+	v810 | necv810)
+		basic_machine=v810-nec
+		os=-none
+		;;
+	vaxv)
+		basic_machine=vax-dec
+		os=-sysv
+		;;
+	vms)
+		basic_machine=vax-dec
+		os=-vms
+		;;
+	vpp*|vx|vx-*)
+		basic_machine=f301-fujitsu
+		;;
+	vxworks960)
+		basic_machine=i960-wrs
+		os=-vxworks
+		;;
+	vxworks68)
+		basic_machine=m68k-wrs
+		os=-vxworks
+		;;
+	vxworks29k)
+		basic_machine=a29k-wrs
+		os=-vxworks
+		;;
+	w65*)
+		basic_machine=w65-wdc
+		os=-none
+		;;
+	w89k-*)
+		basic_machine=hppa1.1-winbond
+		os=-proelf
+		;;
+	xps | xps100)
+		basic_machine=xps100-honeywell
+		;;
+	ymp)
+		basic_machine=ymp-cray
+		os=-unicos
+		;;
+	z8k-*-coff)
+		basic_machine=z8k-unknown
+		os=-sim
+		;;
+	none)
+		basic_machine=none-none
+		os=-none
+		;;
+
+# Here we handle the default manufacturer of certain CPU types.  It is in
+# some cases the only manufacturer, in others, it is the most popular.
+	w89k)
+		basic_machine=hppa1.1-winbond
+		;;
+	op50n)
+		basic_machine=hppa1.1-oki
+		;;
+	op60c)
+		basic_machine=hppa1.1-oki
+		;;
+	romp)
+		basic_machine=romp-ibm
+		;;
+	rs6000)
+		basic_machine=rs6000-ibm
+		;;
+	vax)
+		basic_machine=vax-dec
+		;;
+	pdp10)
+		# there are many clones, so DEC is not a safe bet
+		basic_machine=pdp10-unknown
+		;;
+	pdp11)
+		basic_machine=pdp11-dec
+		;;
+	we32k)
+		basic_machine=we32k-att
+		;;
+	sh3 | sh4 | sh[34]eb | sh[1234]le | sh[23]ele)
+		basic_machine=sh-unknown
+		;;
+	sh64)
+		basic_machine=sh64-unknown
+		;;
+	sparc | sparcv8 | sparcv9 | sparcv9b)
+		basic_machine=sparc-sun
+		;;
+	cydra)
+		basic_machine=cydra-cydrome
+		;;
+	orion)
+		basic_machine=orion-highlevel
+		;;
+	orion105)
+		basic_machine=clipper-highlevel
+		;;
+	mac | mpw | mac-mpw)
+		basic_machine=m68k-apple
+		;;
+	pmac | pmac-mpw)
+		basic_machine=powerpc-apple
+		;;
+	*-unknown)
+		# Make sure to match an already-canonicalized machine name.
+		;;
+	*)
+		echo Invalid configuration \`$1\': machine \`$basic_machine\' not recognized 1>&2
+		exit 1
+		;;
+esac
+
+# Here we canonicalize certain aliases for manufacturers.
+case $basic_machine in
+	*-digital*)
+		basic_machine=`echo $basic_machine | sed 's/digital.*/dec/'`
+		;;
+	*-commodore*)
+		basic_machine=`echo $basic_machine | sed 's/commodore.*/cbm/'`
+		;;
+	*)
+		;;
+esac
+
+# Decode manufacturer-specific aliases for certain operating systems.
+
+if [ x"$os" != x"" ]
+then
+case $os in
+        # First match some system type aliases
+        # that might get confused with valid system types.
+	# -solaris* is a basic system type, with this one exception.
+	-solaris1 | -solaris1.*)
+		os=`echo $os | sed -e 's|solaris1|sunos4|'`
+		;;
+	-solaris)
+		os=-solaris2
+		;;
+	-svr4*)
+		os=-sysv4
+		;;
+	-unixware*)
+		os=-sysv4.2uw
+		;;
+	-gnu/linux*)
+		os=`echo $os | sed -e 's|gnu/linux|linux-gnu|'`
+		;;
+	# First accept the basic system types.
+	# The portable systems comes first.
+	# Each alternative MUST END IN A *, to match a version number.
+	# -sysv* is not here because it comes later, after sysvr4.
+	-gnu* | -bsd* | -mach* | -minix* | -genix* | -ultrix* | -irix* \
+	      | -*vms* | -sco* | -esix* | -isc* | -aix* | -sunos | -sunos[34]*\
+	      | -hpux* | -unos* | -osf* | -luna* | -dgux* | -solaris* | -sym* \
+	      | -amigaos* | -amigados* | -msdos* | -newsos* | -unicos* | -aof* \
+	      | -aos* \
+	      | -nindy* | -vxsim* | -vxworks* | -ebmon* | -hms* | -mvs* \
+	      | -clix* | -riscos* | -uniplus* | -iris* | -rtu* | -xenix* \
+	      | -hiux* | -386bsd* | -knetbsd* | -mirbsd* | -netbsd* | -openbsd* \
+	      | -ekkobsd* | -kfreebsd* | -freebsd* | -riscix* | -lynxos* \
+	      | -bosx* | -nextstep* | -cxux* | -aout* | -elf* | -oabi* \
+	      | -ptx* | -coff* | -ecoff* | -winnt* | -domain* | -vsta* \
+	      | -udi* | -eabi* | -lites* | -ieee* | -go32* | -aux* \
+	      | -chorusos* | -chorusrdb* \
+	      | -cygwin* | -pe* | -psos* | -moss* | -proelf* | -rtems* \
+	      | -mingw32* | -linux-gnu* | -linux-uclibc* | -uxpv* | -beos* | -mpeix* | -udk* \
+	      | -interix* | -uwin* | -mks* | -rhapsody* | -darwin* | -opened* \
+	      | -openstep* | -oskit* | -conix* | -pw32* | -nonstopux* \
+	      | -storm-chaos* | -tops10* | -tenex* | -tops20* | -its* \
+	      | -os2* | -vos* | -palmos* | -uclinux* | -nucleus* \
+	      | -morphos* | -superux* | -rtmk* | -rtmk-nova* | -windiss* \
+	      | -powermax* | -dnix* | -nx6 | -nx7 | -sei* | -dragonfly*)
+	# Remember, each alternative MUST END IN *, to match a version number.
+		;;
+	-qnx*)
+		case $basic_machine in
+		    x86-* | i*86-*)
+			;;
+		    *)
+			os=-nto$os
+			;;
+		esac
+		;;
+	-nto-qnx*)
+		;;
+	-nto*)
+		os=`echo $os | sed -e 's|nto|nto-qnx|'`
+		;;
+	-sim | -es1800* | -hms* | -xray | -os68k* | -none* | -v88r* \
+	      | -windows* | -osx | -abug | -netware* | -os9* | -beos* \
+	      | -macos* | -mpw* | -magic* | -mmixware* | -mon960* | -lnews*)
+		;;
+	-mac*)
+		os=`echo $os | sed -e 's|mac|macos|'`
+		;;
+	-linux-dietlibc)
+		os=-linux-dietlibc
+		;;
+	-linux*)
+		os=`echo $os | sed -e 's|linux|linux-gnu|'`
+		;;
+	-sunos5*)
+		os=`echo $os | sed -e 's|sunos5|solaris2|'`
+		;;
+	-sunos6*)
+		os=`echo $os | sed -e 's|sunos6|solaris3|'`
+		;;
+	-opened*)
+		os=-openedition
+		;;
+        -os400*)
+		os=-os400
+		;;
+	-wince*)
+		os=-wince
+		;;
+	-osfrose*)
+		os=-osfrose
+		;;
+	-osf*)
+		os=-osf
+		;;
+	-utek*)
+		os=-bsd
+		;;
+	-dynix*)
+		os=-bsd
+		;;
+	-acis*)
+		os=-aos
+		;;
+	-atheos*)
+		os=-atheos
+		;;
+	-syllable*)
+		os=-syllable
+		;;
+	-386bsd)
+		os=-bsd
+		;;
+	-ctix* | -uts*)
+		os=-sysv
+		;;
+	-nova*)
+		os=-rtmk-nova
+		;;
+	-ns2 )
+		os=-nextstep2
+		;;
+	-nsk*)
+		os=-nsk
+		;;
+	# Preserve the version number of sinix5.
+	-sinix5.*)
+		os=`echo $os | sed -e 's|sinix|sysv|'`
+		;;
+	-sinix*)
+		os=-sysv4
+		;;
+        -tpf*)
+		os=-tpf
+		;;
+	-triton*)
+		os=-sysv3
+		;;
+	-oss*)
+		os=-sysv3
+		;;
+	-svr4)
+		os=-sysv4
+		;;
+	-svr3)
+		os=-sysv3
+		;;
+	-sysvr4)
+		os=-sysv4
+		;;
+	# This must come after -sysvr4.
+	-sysv*)
+		;;
+	-ose*)
+		os=-ose
+		;;
+	-es1800*)
+		os=-ose
+		;;
+	-xenix)
+		os=-xenix
+		;;
+	-*mint | -mint[0-9]* | -*MiNT | -MiNT[0-9]*)
+		os=-mint
+		;;
+	-aros*)
+		os=-aros
+		;;
+	-kaos*)
+		os=-kaos
+		;;
+	-none)
+		;;
+	*)
+		# Get rid of the `-' at the beginning of $os.
+		os=`echo $os | sed 's/[^-]*-//'`
+		echo Invalid configuration \`$1\': system \`$os\' not recognized 1>&2
+		exit 1
+		;;
+esac
+else
+
+# Here we handle the default operating systems that come with various machines.
+# The value should be what the vendor currently ships out the door with their
+# machine or put another way, the most popular os provided with the machine.
+
+# Note that if you're going to try to match "-MANUFACTURER" here (say,
+# "-sun"), then you have to tell the case statement up towards the top
+# that MANUFACTURER isn't an operating system.  Otherwise, code above
+# will signal an error saying that MANUFACTURER isn't an operating
+# system, and we'll never get to this point.
+
+case $basic_machine in
+	*-acorn)
+		os=-riscix1.2
+		;;
+	arm*-rebel)
+		os=-linux
+		;;
+	arm*-semi)
+		os=-aout
+		;;
+    c4x-* | tic4x-*)
+        os=-coff
+        ;;
+	# This must come before the *-dec entry.
+	pdp10-*)
+		os=-tops20
+		;;
+	pdp11-*)
+		os=-none
+		;;
+	*-dec | vax-*)
+		os=-ultrix4.2
+		;;
+	m68*-apollo)
+		os=-domain
+		;;
+	i386-sun)
+		os=-sunos4.0.2
+		;;
+	m68000-sun)
+		os=-sunos3
+		# This also exists in the configure program, but was not the
+		# default.
+		# os=-sunos4
+		;;
+	m68*-cisco)
+		os=-aout
+		;;
+	mips*-cisco)
+		os=-elf
+		;;
+	mips*-*)
+		os=-elf
+		;;
+	or32-*)
+		os=-coff
+		;;
+	*-tti)	# must be before sparc entry or we get the wrong os.
+		os=-sysv3
+		;;
+	sparc-* | *-sun)
+		os=-sunos4.1.1
+		;;
+	*-be)
+		os=-beos
+		;;
+	*-ibm)
+		os=-aix
+		;;
+	*-wec)
+		os=-proelf
+		;;
+	*-winbond)
+		os=-proelf
+		;;
+	*-oki)
+		os=-proelf
+		;;
+	*-hp)
+		os=-hpux
+		;;
+	*-hitachi)
+		os=-hiux
+		;;
+	i860-* | *-att | *-ncr | *-altos | *-motorola | *-convergent)
+		os=-sysv
+		;;
+	*-cbm)
+		os=-amigaos
+		;;
+	*-dg)
+		os=-dgux
+		;;
+	*-dolphin)
+		os=-sysv3
+		;;
+	m68k-ccur)
+		os=-rtu
+		;;
+	m88k-omron*)
+		os=-luna
+		;;
+	*-next )
+		os=-nextstep
+		;;
+	*-sequent)
+		os=-ptx
+		;;
+	*-crds)
+		os=-unos
+		;;
+	*-ns)
+		os=-genix
+		;;
+	i370-*)
+		os=-mvs
+		;;
+	*-next)
+		os=-nextstep3
+		;;
+	*-gould)
+		os=-sysv
+		;;
+	*-highlevel)
+		os=-bsd
+		;;
+	*-encore)
+		os=-bsd
+		;;
+	*-sgi)
+		os=-irix
+		;;
+	*-siemens)
+		os=-sysv4
+		;;
+	*-masscomp)
+		os=-rtu
+		;;
+	f30[01]-fujitsu | f700-fujitsu)
+		os=-uxpv
+		;;
+	*-rom68k)
+		os=-coff
+		;;
+	*-*bug)
+		os=-coff
+		;;
+	*-apple)
+		os=-macos
+		;;
+	*-atari*)
+		os=-mint
+		;;
+	*)
+		os=-none
+		;;
+esac
+fi
+
+# Here we handle the case where we know the os, and the CPU type, but not the
+# manufacturer.  We pick the logical manufacturer.
+vendor=unknown
+case $basic_machine in
+	*-unknown)
+		case $os in
+			-riscix*)
+				vendor=acorn
+				;;
+			-sunos*)
+				vendor=sun
+				;;
+			-aix*)
+				vendor=ibm
+				;;
+			-beos*)
+				vendor=be
+				;;
+			-hpux*)
+				vendor=hp
+				;;
+			-mpeix*)
+				vendor=hp
+				;;
+			-hiux*)
+				vendor=hitachi
+				;;
+			-unos*)
+				vendor=crds
+				;;
+			-dgux*)
+				vendor=dg
+				;;
+			-luna*)
+				vendor=omron
+				;;
+			-genix*)
+				vendor=ns
+				;;
+			-mvs* | -opened*)
+				vendor=ibm
+				;;
+			-os400*)
+				vendor=ibm
+				;;
+			-ptx*)
+				vendor=sequent
+				;;
+			-tpf*)
+				vendor=ibm
+				;;
+			-vxsim* | -vxworks* | -windiss*)
+				vendor=wrs
+				;;
+			-aux*)
+				vendor=apple
+				;;
+			-hms*)
+				vendor=hitachi
+				;;
+			-mpw* | -macos*)
+				vendor=apple
+				;;
+			-*mint | -mint[0-9]* | -*MiNT | -MiNT[0-9]*)
+				vendor=atari
+				;;
+			-vos*)
+				vendor=stratus
+				;;
+		esac
+		basic_machine=`echo $basic_machine | sed "s/unknown/$vendor/"`
+		;;
+esac
+
+echo $basic_machine$os
+exit 0
+
+# Local variables:
+# eval: (add-hook 'write-file-hooks 'time-stamp)
+# time-stamp-start: "timestamp='"
+# time-stamp-format: "%:y-%02m-%02d"
+# time-stamp-end: "'"
+# End:
diff -ruN povray-3.6.1/libraries/tiff/libtiff/configure.ac povray-3.6.1-config-0.2.0/libraries/tiff/libtiff/configure.ac
--- povray-3.6.1/libraries/tiff/libtiff/configure.ac	1970-01-01 01:00:00.000000000 +0100
+++ povray-3.6.1-config-0.2.0/libraries/tiff/libtiff/configure.ac	2005-08-04 00:39:35.000000000 +0200
@@ -0,0 +1,120 @@
+##############################################################################
+#               configure.ac
+#
+# Process this file with autoconf to produce configure
+#
+# from Persistence of Vision(tm) Ray Tracer version 3.6.
+# Copyright 1991-2003 Persistence of Vision Team
+# Copyright 2003-2004 Persistence of Vision Raytracer Pty. Ltd.
+#---------------------------------------------------------------------------
+# NOTICE: This source code file is provided so that users may experiment
+# with enhancements to POV-Ray and to port the software to platforms other
+# than those supported by the POV-Ray developers. There are strict rules
+# regarding how you are permitted to use this file. These rules are contained
+# in the distribution and derivative versions licenses which should have been
+# provided with this file.
+#
+# These licences may be found online, linked from the end-user license
+# agreement that is located at http://www.povray.org/povlegal.html
+#---------------------------------------------------------------------------
+# This program is based on the popular DKB raytracer version 2.12.
+# DKBTrace was originally written by David K. Buck.
+# DKBTrace Ver 2.0-2.12 were written by David K. Buck & Aaron A. Collins.
+##############################################################################
+
+# configure.ac for the source distribution of POV-Ray 3.6 for UNIX
+# Written by Nicolas Calimet <pov4grasp@free.fr>
+
+AC_PREREQ(2.59)
+AC_INIT(libtiff, 3.6.1)
+AC_CONFIG_SRCDIR([tif_aux.c])
+AC_CONFIG_HEADER([config.h])
+
+AC_CANONICAL_BUILD
+AC_CANONICAL_HOST
+AM_INIT_AUTOMAKE([1.9 no-dependencies])
+AM_MAINTAINER_MODE
+
+# Checks for programs.
+# Inits compiler flags with -O if none given.
+CFLAGS=${CFLAGS:--O}
+AC_PROG_CC
+AC_PROG_INSTALL
+AC_PROG_RANLIB
+
+# Checks for libraries.
+AC_CHECK_LIB([m], [floor])
+
+# Checks for header files.
+AC_HEADER_STDC
+AC_CHECK_HEADERS([fcntl.h malloc.h memory.h stdlib.h string.h unistd.h sys/types.h])
+
+# Checks for typedefs, structures, and compiler characteristics.
+AC_C_CONST
+AC_TYPE_OFF_T
+AC_TYPE_SIZE_T
+AC_C_BIGENDIAN
+AC_C_INLINE
+AC_DEFINE_UNQUOTED([INLINE],
+  [$ac_cv_c_inline],
+  [What keyword the C compiler supports for inlining.]
+)
+
+# Checks for library functions.
+AC_FUNC_MALLOC
+AC_FUNC_MEMCMP
+AC_FUNC_MMAP
+AC_FUNC_REALLOC
+AC_FUNC_VPRINTF
+AC_CHECK_FUNCS([floor memmove memset munmap pow sqrt strchr strstr])
+AC_CHECK_FUNCS([getopt], [], [we_have_getopt=no])
+AM_CONDITIONAL([NEEDGETOPT], [test x"$we_have_getopt" = x"no"])
+
+# Create port.h
+# Adapted from BuildPortDotH() in the legacy ../configure script
+case "$host" in
+  mips-dec-*) FILLORDER=LSB2MSB;;
+  i[345]86-*) FILLORDER=LSB2MSB;;
+  *)          FILLORDER=MSB2LSB;;
+esac
+
+cat << EOF > port.h
+/* generated by configure */
+
+#ifndef _PORT_
+#define _PORT_ 1
+
+#ifdef __cplusplus
+extern "C" {
+#endif
+
+#include "config.h"
+
+#include <fcntl.h>
+#include <string.h>
+#include <stdio.h>
+#include <stdlib.h>
+#include <sys/types.h>
+#include <unistd.h>
+
+#define HOST_FILLORDER FILLORDER_${FILLORDER}
+#ifdef WORDS_BIGENDIAN
+ #define HOST_BIGENDIAN 1
+#else
+ #define HOST_BIGENDIAN 0
+#endif
+#define GLOBALDATA(TYPE,NAME) extern TYPE NAME
+/* INLINE is defined in config.h */
+
+typedef double dblparam_t;
+
+#ifdef __cplusplus
+}
+#endif
+
+#endif
+EOF
+
+
+AC_CONFIG_FILES([Makefile])
+AC_OUTPUT
diff -ruN povray-3.6.1/libraries/tiff/libtiff/configure.gnu povray-3.6.1-config-0.2.0/libraries/tiff/libtiff/configure.gnu
--- povray-3.6.1/libraries/tiff/libtiff/configure.gnu	1970-01-01 01:00:00.000000000 +0100
+++ povray-3.6.1-config-0.2.0/libraries/tiff/libtiff/configure.gnu	2005-08-04 00:39:35.000000000 +0200
@@ -0,0 +1,87 @@
+#!/bin/sh
+##############################################################################
+#               configure.gnu
+#
+# Wrapper to configure
+#
+# from Persistence of Vision(tm) Ray Tracer version 3.6.
+# Copyright 1991-2003 Persistence of Vision Team
+# Copyright 2003-2004 Persistence of Vision Raytracer Pty. Ltd.
+#---------------------------------------------------------------------------
+# NOTICE: This source code file is provided so that users may experiment
+# with enhancements to POV-Ray and to port the software to platforms other
+# than those supported by the POV-Ray developers. There are strict rules
+# regarding how you are permitted to use this file. These rules are contained
+# in the distribution and derivative versions licenses which should have been
+# provided with this file.
+#
+# These licences may be found online, linked from the end-user license
+# agreement that is located at http://www.povray.org/povlegal.html
+#---------------------------------------------------------------------------
+# This program is based on the popular DKB raytracer version 2.12.
+# DKBTrace was originally written by David K. Buck.
+# DKBTrace Ver 2.0-2.12 were written by David K. Buck & Aaron A. Collins.
+##############################################################################
+
+# configure.gnu for the source distribution of POV-Ray 3.6 for UNIX
+# Written by Nicolas Calimet <pov4grasp@free.fr>
+
+# get srcdir
+srcdir=`echo $* | grep srcdir | sed 's,.*srcdir=\([^[:space:]]*\).*,\1,g'`
+if test -z "$srcdir"; then
+  srcdir="."
+fi
+
+# get cache-file
+cachefile=`echo $* | grep cache-file | sed 's,.*cache-file=\([^[:space:]]*\).*,\1,g'`
+
+# Setting MISSING can prevent configure error with cygwin and
+# directories containing special caracters (such as spaces or quotes).
+MISSING="\${SHELL} $srcdir/missing"
+export MISSING
+
+# Process arguments (remove VAR=VALUE args, which are exported).
+# cache-file and srcdir were the last arguments, so remove all what follows
+# the first VAR argument.
+args=
+for arg in $*; do
+  arg=`echo $arg | sed s,^[^-].*,,`
+  if test -z "$arg"; then break; fi
+  args="$args $arg"
+done
+if test -z "`echo $args | grep cache-file`"; then
+  args="--cache-file=$cachefile $args"
+fi
+if test -z "`echo $args | grep srcdir`"; then
+  args="--srcdir=$srcdir $args"
+fi
+
+# zlib directory relative to tiff/libtiff/
+if test "$INCZ"; then
+  CPPFLAGS="-I$srcdir/../../zlib $CPPFLAGS"
+fi
+
+# jpeg directory relative to tiff/libtiff/
+if test "$INCJPEG"; then
+  CPPFLAGS="-I$srcdir/../../jpeg $CPPFLAGS"
+fi
+
+# run configure
+case "$args" in
+  *help*)
+  echo "Configuration of libtiff 3.6.1:"
+  echo ""
+  ;;
+
+  *)
+  echo "configure.gnu: configuring libtiff 3.6.1"
+  echo "configure.gnu: running $srcdir/configure $args"
+esac
+echo "@@@@@@ start of libtiff configuration @@@@@@" >> ../../../config.log
+$srcdir/configure $args || exit 1
+cat config.log >> ../../../config.log
+echo "@@@@@@ end of libtiff configuration @@@@@@" >> ../../../config.log
+echo ""
+
+# ensure all files are read-writeable
+chmod -R u+rw *
diff -ruN povray-3.6.1/libraries/tiff/libtiff/install-sh povray-3.6.1-config-0.2.0/libraries/tiff/libtiff/install-sh
--- povray-3.6.1/libraries/tiff/libtiff/install-sh	1970-01-01 01:00:00.000000000 +0100
+++ povray-3.6.1-config-0.2.0/libraries/tiff/libtiff/install-sh	2005-08-03 20:25:48.000000000 +0200
@@ -0,0 +1,323 @@
+#!/bin/sh
+# install - install a program, script, or datafile
+
+scriptversion=2004-10-22.00
+
+# This originates from X11R5 (mit/util/scripts/install.sh), which was
+# later released in X11R6 (xc/config/util/install.sh) with the
+# following copyright and license.
+#
+# Copyright (C) 1994 X Consortium
+#
+# Permission is hereby granted, free of charge, to any person obtaining a copy
+# of this software and associated documentation files (the "Software"), to
+# deal in the Software without restriction, including without limitation the
+# rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
+# sell copies of the Software, and to permit persons to whom the Software is
+# furnished to do so, subject to the following conditions:
+#
+# The above copyright notice and this permission notice shall be included in
+# all copies or substantial portions of the Software.
+#
+# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
+# X CONSORTIUM BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN
+# AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNEC-
+# TION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+#
+# Except as contained in this notice, the name of the X Consortium shall not
+# be used in advertising or otherwise to promote the sale, use or other deal-
+# ings in this Software without prior written authorization from the X Consor-
+# tium.
+#
+#
+# FSF changes to this file are in the public domain.
+#
+# Calling this script install-sh is preferred over install.sh, to prevent
+# `make' implicit rules from creating a file called install from it
+# when there is no Makefile.
+#
+# This script is compatible with the BSD install script, but was written
+# from scratch.  It can only install one file at a time, a restriction
+# shared with many OS's install programs.
+
+# set DOITPROG to echo to test this script
+
+# Don't use :- since 4.3BSD and earlier shells don't like it.
+doit="${DOITPROG-}"
+
+# put in absolute paths if you don't have them in your path; or use env. vars.
+
+mvprog="${MVPROG-mv}"
+cpprog="${CPPROG-cp}"
+chmodprog="${CHMODPROG-chmod}"
+chownprog="${CHOWNPROG-chown}"
+chgrpprog="${CHGRPPROG-chgrp}"
+stripprog="${STRIPPROG-strip}"
+rmprog="${RMPROG-rm}"
+mkdirprog="${MKDIRPROG-mkdir}"
+
+chmodcmd="$chmodprog 0755"
+chowncmd=
+chgrpcmd=
+stripcmd=
+rmcmd="$rmprog -f"
+mvcmd="$mvprog"
+src=
+dst=
+dir_arg=
+dstarg=
+no_target_directory=
+
+usage="Usage: $0 [OPTION]... [-T] SRCFILE DSTFILE
+   or: $0 [OPTION]... SRCFILES... DIRECTORY
+   or: $0 [OPTION]... -t DIRECTORY SRCFILES...
+   or: $0 [OPTION]... -d DIRECTORIES...
+
+In the 1st form, copy SRCFILE to DSTFILE.
+In the 2nd and 3rd, copy all SRCFILES to DIRECTORY.
+In the 4th, create DIRECTORIES.
+
+Options:
+-c         (ignored)
+-d         create directories instead of installing files.
+-g GROUP   $chgrpprog installed files to GROUP.
+-m MODE    $chmodprog installed files to MODE.
+-o USER    $chownprog installed files to USER.
+-s         $stripprog installed files.
+-t DIRECTORY  install into DIRECTORY.
+-T         report an error if DSTFILE is a directory.
+--help     display this help and exit.
+--version  display version info and exit.
+
+Environment variables override the default commands:
+  CHGRPPROG CHMODPROG CHOWNPROG CPPROG MKDIRPROG MVPROG RMPROG STRIPPROG
+"
+
+while test -n "$1"; do
+  case $1 in
+    -c) shift
+        continue;;
+
+    -d) dir_arg=true
+        shift
+        continue;;
+
+    -g) chgrpcmd="$chgrpprog $2"
+        shift
+        shift
+        continue;;
+
+    --help) echo "$usage"; exit 0;;
+
+    -m) chmodcmd="$chmodprog $2"
+        shift
+        shift
+        continue;;
+
+    -o) chowncmd="$chownprog $2"
+        shift
+        shift
+        continue;;
+
+    -s) stripcmd=$stripprog
+        shift
+        continue;;
+
+    -t) dstarg=$2
+	shift
+	shift
+	continue;;
+
+    -T) no_target_directory=true
+	shift
+	continue;;
+
+    --version) echo "$0 $scriptversion"; exit 0;;
+
+    *)  # When -d is used, all remaining arguments are directories to create.
+	# When -t is used, the destination is already specified.
+	test -n "$dir_arg$dstarg" && break
+        # Otherwise, the last argument is the destination.  Remove it from $@.
+	for arg
+	do
+          if test -n "$dstarg"; then
+	    # $@ is not empty: it contains at least $arg.
+	    set fnord "$@" "$dstarg"
+	    shift # fnord
+	  fi
+	  shift # arg
+	  dstarg=$arg
+	done
+	break;;
+  esac
+done
+
+if test -z "$1"; then
+  if test -z "$dir_arg"; then
+    echo "$0: no input file specified." >&2
+    exit 1
+  fi
+  # It's OK to call `install-sh -d' without argument.
+  # This can happen when creating conditional directories.
+  exit 0
+fi
+
+for src
+do
+  # Protect names starting with `-'.
+  case $src in
+    -*) src=./$src ;;
+  esac
+
+  if test -n "$dir_arg"; then
+    dst=$src
+    src=
+
+    if test -d "$dst"; then
+      mkdircmd=:
+      chmodcmd=
+    else
+      mkdircmd=$mkdirprog
+    fi
+  else
+    # Waiting for this to be detected by the "$cpprog $src $dsttmp" command
+    # might cause directories to be created, which would be especially bad
+    # if $src (and thus $dsttmp) contains '*'.
+    if test ! -f "$src" && test ! -d "$src"; then
+      echo "$0: $src does not exist." >&2
+      exit 1
+    fi
+
+    if test -z "$dstarg"; then
+      echo "$0: no destination specified." >&2
+      exit 1
+    fi
+
+    dst=$dstarg
+    # Protect names starting with `-'.
+    case $dst in
+      -*) dst=./$dst ;;
+    esac
+
+    # If destination is a directory, append the input filename; won't work
+    # if double slashes aren't ignored.
+    if test -d "$dst"; then
+      if test -n "$no_target_directory"; then
+	echo "$0: $dstarg: Is a directory" >&2
+	exit 1
+      fi
+      dst=$dst/`basename "$src"`
+    fi
+  fi
+
+  # This sed command emulates the dirname command.
+  dstdir=`echo "$dst" | sed -e 's,/*$,,;s,[^/]*$,,;s,/*$,,;s,^$,.,'`
+
+  # Make sure that the destination directory exists.
+
+  # Skip lots of stat calls in the usual case.
+  if test ! -d "$dstdir"; then
+    defaultIFS='
+	 '
+    IFS="${IFS-$defaultIFS}"
+
+    oIFS=$IFS
+    # Some sh's can't handle IFS=/ for some reason.
+    IFS='%'
+    set x `echo "$dstdir" | sed -e 's@/@%@g' -e 's@^%@/@'`
+    shift
+    IFS=$oIFS
+
+    pathcomp=
+
+    while test $# -ne 0 ; do
+      pathcomp=$pathcomp$1
+      shift
+      if test ! -d "$pathcomp"; then
+        $mkdirprog "$pathcomp"
+	# mkdir can fail with a `File exist' error in case several
+	# install-sh are creating the directory concurrently.  This
+	# is OK.
+	test -d "$pathcomp" || exit
+      fi
+      pathcomp=$pathcomp/
+    done
+  fi
+
+  if test -n "$dir_arg"; then
+    $doit $mkdircmd "$dst" \
+      && { test -z "$chowncmd" || $doit $chowncmd "$dst"; } \
+      && { test -z "$chgrpcmd" || $doit $chgrpcmd "$dst"; } \
+      && { test -z "$stripcmd" || $doit $stripcmd "$dst"; } \
+      && { test -z "$chmodcmd" || $doit $chmodcmd "$dst"; }
+
+  else
+    dstfile=`basename "$dst"`
+
+    # Make a couple of temp file names in the proper directory.
+    dsttmp=$dstdir/_inst.$$_
+    rmtmp=$dstdir/_rm.$$_
+
+    # Trap to clean up those temp files at exit.
+    trap 'ret=$?; rm -f "$dsttmp" "$rmtmp" && exit $ret' 0
+    trap '(exit $?); exit' 1 2 13 15
+
+    # Copy the file name to the temp name.
+    $doit $cpprog "$src" "$dsttmp" &&
+
+    # and set any options; do chmod last to preserve setuid bits.
+    #
+    # If any of these fail, we abort the whole thing.  If we want to
+    # ignore errors from any of these, just make sure not to ignore
+    # errors from the above "$doit $cpprog $src $dsttmp" command.
+    #
+    { test -z "$chowncmd" || $doit $chowncmd "$dsttmp"; } \
+      && { test -z "$chgrpcmd" || $doit $chgrpcmd "$dsttmp"; } \
+      && { test -z "$stripcmd" || $doit $stripcmd "$dsttmp"; } \
+      && { test -z "$chmodcmd" || $doit $chmodcmd "$dsttmp"; } &&
+
+    # Now rename the file to the real destination.
+    { $doit $mvcmd -f "$dsttmp" "$dstdir/$dstfile" 2>/dev/null \
+      || {
+	   # The rename failed, perhaps because mv can't rename something else
+	   # to itself, or perhaps because mv is so ancient that it does not
+	   # support -f.
+
+	   # Now remove or move aside any old file at destination location.
+	   # We try this two ways since rm can't unlink itself on some
+	   # systems and the destination file might be busy for other
+	   # reasons.  In this case, the final cleanup might fail but the new
+	   # file should still install successfully.
+	   {
+	     if test -f "$dstdir/$dstfile"; then
+	       $doit $rmcmd -f "$dstdir/$dstfile" 2>/dev/null \
+	       || $doit $mvcmd -f "$dstdir/$dstfile" "$rmtmp" 2>/dev/null \
+	       || {
+		 echo "$0: cannot unlink or rename $dstdir/$dstfile" >&2
+		 (exit 1); exit
+	       }
+	     else
+	       :
+	     fi
+	   } &&
+
+	   # Now rename the file to the real destination.
+	   $doit $mvcmd "$dsttmp" "$dstdir/$dstfile"
+	 }
+    }
+  fi || { (exit 1); exit; }
+done
+
+# The final little trick to "correctly" pass the exit status to the exit trap.
+{
+  (exit 0); exit
+}
+
+# Local variables:
+# eval: (add-hook 'write-file-hooks 'time-stamp)
+# time-stamp-start: "scriptversion="
+# time-stamp-format: "%:y-%02m-%02d.%02H"
+# time-stamp-end: "$"
+# End:
diff -ruN povray-3.6.1/libraries/tiff/libtiff/missing povray-3.6.1-config-0.2.0/libraries/tiff/libtiff/missing
--- povray-3.6.1/libraries/tiff/libtiff/missing	1970-01-01 01:00:00.000000000 +0100
+++ povray-3.6.1-config-0.2.0/libraries/tiff/libtiff/missing	2005-08-03 20:25:48.000000000 +0200
@@ -0,0 +1,353 @@
+#! /bin/sh
+# Common stub for a few missing GNU programs while installing.
+
+scriptversion=2004-09-07.08
+
+# Copyright (C) 1996, 1997, 1999, 2000, 2002, 2003, 2004
+#   Free Software Foundation, Inc.
+# Originally by Fran,cois Pinard <pinard@iro.umontreal.ca>, 1996.
+
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2, or (at your option)
+# any later version.
+
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+# 02111-1307, USA.
+
+# As a special exception to the GNU General Public License, if you
+# distribute this file as part of a program that contains a
+# configuration script generated by Autoconf, you may include it under
+# the same distribution terms that you use for the rest of that program.
+
+if test $# -eq 0; then
+  echo 1>&2 "Try \`$0 --help' for more information"
+  exit 1
+fi
+
+run=:
+
+# In the cases where this matters, `missing' is being run in the
+# srcdir already.
+if test -f configure.ac; then
+  configure_ac=configure.ac
+else
+  configure_ac=configure.in
+fi
+
+msg="missing on your system"
+
+case "$1" in
+--run)
+  # Try to run requested program, and just exit if it succeeds.
+  run=
+  shift
+  "$@" && exit 0
+  # Exit code 63 means version mismatch.  This often happens
+  # when the user try to use an ancient version of a tool on
+  # a file that requires a minimum version.  In this case we
+  # we should proceed has if the program had been absent, or
+  # if --run hadn't been passed.
+  if test $? = 63; then
+    run=:
+    msg="probably too old"
+  fi
+  ;;
+
+  -h|--h|--he|--hel|--help)
+    echo "\
+$0 [OPTION]... PROGRAM [ARGUMENT]...
+
+Handle \`PROGRAM [ARGUMENT]...' for when PROGRAM is missing, or return an
+error status if there is no known handling for PROGRAM.
+
+Options:
+  -h, --help      display this help and exit
+  -v, --version   output version information and exit
+  --run           try to run the given command, and emulate it if it fails
+
+Supported PROGRAM values:
+  aclocal      touch file \`aclocal.m4'
+  autoconf     touch file \`configure'
+  autoheader   touch file \`config.h.in'
+  automake     touch all \`Makefile.in' files
+  bison        create \`y.tab.[ch]', if possible, from existing .[ch]
+  flex         create \`lex.yy.c', if possible, from existing .c
+  help2man     touch the output file
+  lex          create \`lex.yy.c', if possible, from existing .c
+  makeinfo     touch the output file
+  tar          try tar, gnutar, gtar, then tar without non-portable flags
+  yacc         create \`y.tab.[ch]', if possible, from existing .[ch]
+
+Send bug reports to <bug-automake@gnu.org>."
+    exit 0
+    ;;
+
+  -v|--v|--ve|--ver|--vers|--versi|--versio|--version)
+    echo "missing $scriptversion (GNU Automake)"
+    exit 0
+    ;;
+
+  -*)
+    echo 1>&2 "$0: Unknown \`$1' option"
+    echo 1>&2 "Try \`$0 --help' for more information"
+    exit 1
+    ;;
+
+esac
+
+# Now exit if we have it, but it failed.  Also exit now if we
+# don't have it and --version was passed (most likely to detect
+# the program).
+case "$1" in
+  lex|yacc)
+    # Not GNU programs, they don't have --version.
+    ;;
+
+  tar)
+    if test -n "$run"; then
+       echo 1>&2 "ERROR: \`tar' requires --run"
+       exit 1
+    elif test "x$2" = "x--version" || test "x$2" = "x--help"; then
+       exit 1
+    fi
+    ;;
+
+  *)
+    if test -z "$run" && ($1 --version) > /dev/null 2>&1; then
+       # We have it, but it failed.
+       exit 1
+    elif test "x$2" = "x--version" || test "x$2" = "x--help"; then
+       # Could not run --version or --help.  This is probably someone
+       # running `$TOOL --version' or `$TOOL --help' to check whether
+       # $TOOL exists and not knowing $TOOL uses missing.
+       exit 1
+    fi
+    ;;
+esac
+
+# If it does not exist, or fails to run (possibly an outdated version),
+# try to emulate it.
+case "$1" in
+  aclocal*)
+    echo 1>&2 "\
+WARNING: \`$1' is $msg.  You should only need it if
+         you modified \`acinclude.m4' or \`${configure_ac}'.  You might want
+         to install the \`Automake' and \`Perl' packages.  Grab them from
+         any GNU archive site."
+    touch aclocal.m4
+    ;;
+
+  autoconf)
+    echo 1>&2 "\
+WARNING: \`$1' is $msg.  You should only need it if
+         you modified \`${configure_ac}'.  You might want to install the
+         \`Autoconf' and \`GNU m4' packages.  Grab them from any GNU
+         archive site."
+    touch configure
+    ;;
+
+  autoheader)
+    echo 1>&2 "\
+WARNING: \`$1' is $msg.  You should only need it if
+         you modified \`acconfig.h' or \`${configure_ac}'.  You might want
+         to install the \`Autoconf' and \`GNU m4' packages.  Grab them
+         from any GNU archive site."
+    files=`sed -n 's/^[ ]*A[CM]_CONFIG_HEADER(\([^)]*\)).*/\1/p' ${configure_ac}`
+    test -z "$files" && files="config.h"
+    touch_files=
+    for f in $files; do
+      case "$f" in
+      *:*) touch_files="$touch_files "`echo "$f" |
+				       sed -e 's/^[^:]*://' -e 's/:.*//'`;;
+      *) touch_files="$touch_files $f.in";;
+      esac
+    done
+    touch $touch_files
+    ;;
+
+  automake*)
+    echo 1>&2 "\
+WARNING: \`$1' is $msg.  You should only need it if
+         you modified \`Makefile.am', \`acinclude.m4' or \`${configure_ac}'.
+         You might want to install the \`Automake' and \`Perl' packages.
+         Grab them from any GNU archive site."
+    find . -type f -name Makefile.am -print |
+	   sed 's/\.am$/.in/' |
+	   while read f; do touch "$f"; done
+    ;;
+
+  autom4te)
+    echo 1>&2 "\
+WARNING: \`$1' is needed, but is $msg.
+         You might have modified some files without having the
+         proper tools for further handling them.
+         You can get \`$1' as part of \`Autoconf' from any GNU
+         archive site."
+
+    file=`echo "$*" | sed -n 's/.*--output[ =]*\([^ ]*\).*/\1/p'`
+    test -z "$file" && file=`echo "$*" | sed -n 's/.*-o[ ]*\([^ ]*\).*/\1/p'`
+    if test -f "$file"; then
+	touch $file
+    else
+	test -z "$file" || exec >$file
+	echo "#! /bin/sh"
+	echo "# Created by GNU Automake missing as a replacement of"
+	echo "#  $ $@"
+	echo "exit 0"
+	chmod +x $file
+	exit 1
+    fi
+    ;;
+
+  bison|yacc)
+    echo 1>&2 "\
+WARNING: \`$1' $msg.  You should only need it if
+         you modified a \`.y' file.  You may need the \`Bison' package
+         in order for those modifications to take effect.  You can get
+         \`Bison' from any GNU archive site."
+    rm -f y.tab.c y.tab.h
+    if [ $# -ne 1 ]; then
+        eval LASTARG="\${$#}"
+	case "$LASTARG" in
+	*.y)
+	    SRCFILE=`echo "$LASTARG" | sed 's/y$/c/'`
+	    if [ -f "$SRCFILE" ]; then
+	         cp "$SRCFILE" y.tab.c
+	    fi
+	    SRCFILE=`echo "$LASTARG" | sed 's/y$/h/'`
+	    if [ -f "$SRCFILE" ]; then
+	         cp "$SRCFILE" y.tab.h
+	    fi
+	  ;;
+	esac
+    fi
+    if [ ! -f y.tab.h ]; then
+	echo >y.tab.h
+    fi
+    if [ ! -f y.tab.c ]; then
+	echo 'main() { return 0; }' >y.tab.c
+    fi
+    ;;
+
+  lex|flex)
+    echo 1>&2 "\
+WARNING: \`$1' is $msg.  You should only need it if
+         you modified a \`.l' file.  You may need the \`Flex' package
+         in order for those modifications to take effect.  You can get
+         \`Flex' from any GNU archive site."
+    rm -f lex.yy.c
+    if [ $# -ne 1 ]; then
+        eval LASTARG="\${$#}"
+	case "$LASTARG" in
+	*.l)
+	    SRCFILE=`echo "$LASTARG" | sed 's/l$/c/'`
+	    if [ -f "$SRCFILE" ]; then
+	         cp "$SRCFILE" lex.yy.c
+	    fi
+	  ;;
+	esac
+    fi
+    if [ ! -f lex.yy.c ]; then
+	echo 'main() { return 0; }' >lex.yy.c
+    fi
+    ;;
+
+  help2man)
+    echo 1>&2 "\
+WARNING: \`$1' is $msg.  You should only need it if
+	 you modified a dependency of a manual page.  You may need the
+	 \`Help2man' package in order for those modifications to take
+	 effect.  You can get \`Help2man' from any GNU archive site."
+
+    file=`echo "$*" | sed -n 's/.*-o \([^ ]*\).*/\1/p'`
+    if test -z "$file"; then
+	file=`echo "$*" | sed -n 's/.*--output=\([^ ]*\).*/\1/p'`
+    fi
+    if [ -f "$file" ]; then
+	touch $file
+    else
+	test -z "$file" || exec >$file
+	echo ".ab help2man is required to generate this page"
+	exit 1
+    fi
+    ;;
+
+  makeinfo)
+    echo 1>&2 "\
+WARNING: \`$1' is $msg.  You should only need it if
+         you modified a \`.texi' or \`.texinfo' file, or any other file
+         indirectly affecting the aspect of the manual.  The spurious
+         call might also be the consequence of using a buggy \`make' (AIX,
+         DU, IRIX).  You might want to install the \`Texinfo' package or
+         the \`GNU make' package.  Grab either from any GNU archive site."
+    file=`echo "$*" | sed -n 's/.*-o \([^ ]*\).*/\1/p'`
+    if test -z "$file"; then
+      file=`echo "$*" | sed 's/.* \([^ ]*\) *$/\1/'`
+      file=`sed -n '/^@setfilename/ { s/.* \([^ ]*\) *$/\1/; p; q; }' $file`
+    fi
+    touch $file
+    ;;
+
+  tar)
+    shift
+
+    # We have already tried tar in the generic part.
+    # Look for gnutar/gtar before invocation to avoid ugly error
+    # messages.
+    if (gnutar --version > /dev/null 2>&1); then
+       gnutar "$@" && exit 0
+    fi
+    if (gtar --version > /dev/null 2>&1); then
+       gtar "$@" && exit 0
+    fi
+    firstarg="$1"
+    if shift; then
+	case "$firstarg" in
+	*o*)
+	    firstarg=`echo "$firstarg" | sed s/o//`
+	    tar "$firstarg" "$@" && exit 0
+	    ;;
+	esac
+	case "$firstarg" in
+	*h*)
+	    firstarg=`echo "$firstarg" | sed s/h//`
+	    tar "$firstarg" "$@" && exit 0
+	    ;;
+	esac
+    fi
+
+    echo 1>&2 "\
+WARNING: I can't seem to be able to run \`tar' with the given arguments.
+         You may want to install GNU tar or Free paxutils, or check the
+         command line arguments."
+    exit 1
+    ;;
+
+  *)
+    echo 1>&2 "\
+WARNING: \`$1' is needed, and is $msg.
+         You might have modified some files without having the
+         proper tools for further handling them.  Check the \`README' file,
+         it often tells you about the needed prerequisites for installing
+         this package.  You may also peek at any GNU archive site, in case
+         some other package would contain this missing \`$1' program."
+    exit 1
+    ;;
+esac
+
+exit 0
+
+# Local variables:
+# eval: (add-hook 'write-file-hooks 'time-stamp)
+# time-stamp-start: "scriptversion="
+# time-stamp-format: "%:y-%02m-%02d.%02H"
+# time-stamp-end: "$"
+# End:
